<?xml version="1.0" encoding="UTF-8" standalone="no"?><con:soapui-project xmlns:con="http://eviware.com/soapui/config" abortOnError="false" name="Fanout_Test" resourceRoot="" runType="SEQUENTIAL" soapui-version="3.6"><con:settings/><con:interface xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" anonymous="optional" bindingName="{urn:gov:hhs:fha:nhinc:entitypatientdiscovery}EntityPatientDiscoveryBindingSoap" definition="WSDL path not set.  #EntityPatientDiscovery.wsdl" name="EntityPatientDiscoveryBindingSoap" soapVersion="1_2" type="wsdl" wsaVersion="NONE" xsi:type="con:WsdlInterface">
    <con:settings/>
    
    <con:endpoints>
      <con:endpoint>http://localhost:8080/CONNECTGateway/EntityPatientDiscovery</con:endpoint>
    <con:endpoint>https://localhost:${HttpsDefaultPort}/NhinConnect/EntityPatientDiscovery</con:endpoint></con:endpoints>
    <con:operation action="urn:RespondingGateway_PRPA_IN201305UV02" anonymous="optional" bindingOperationName="RespondingGateway_PRPA_IN201305UV02" inputName="RespondingGateway_PRPA_IN201305UV02Request" isOneWay="false" name="RespondingGateway_PRPA_IN201305UV02" outputName="RespondingGateway_PRPA_IN201306UV02Response" receivesAttachments="false" sendsAttachments="false" type="Request-Response">
      <con:settings/>
    </con:operation>
  </con:interface><con:interface xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" anonymous="optional" bindingName="{urn:gov:hhs:fha:nhinc:nhincproxypatientdiscovery}NhincProxyPatientDiscoveryBinding" definition="WSDL path not set.  #NhincProxyPatientDiscovery.wsdl" name="NhincProxyPatientDiscoveryBinding" soapVersion="1_2" type="wsdl" wsaVersion="NONE" xsi:type="con:WsdlInterface"><con:settings/><con:endpoints><con:endpoint>http://localhost:${HttpDefaultPort}/NhinConnect/NhincProxyPatientDiscovery</con:endpoint></con:endpoints><con:operation action="urn:Proxy_PRPA_IN201305UV" anonymous="optional" bindingOperationName="Proxy_PRPA_IN201305UV" inputName="Proxy_PRPA_IN201305UVProxyRequest" isOneWay="false" name="Proxy_PRPA_IN201305UV" outputName="Proxy_PRPA_IN201306UVProxyResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response"><con:settings/></con:operation></con:interface><con:interface xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" anonymous="optional" bindingName="{urn:ihe:iti:xcpd:2009}RespondingGateway_Binding_Soap" definition="WSDL path not set.  #NhinPatientDiscovery.wsdl" name="RespondingGateway_Binding_Soap" soapVersion="1_2" type="wsdl" wsaVersion="NONE" xsi:type="con:WsdlInterface"><con:settings/><con:endpoints><con:endpoint>https://PHX-ONC-WTST21:7781/mockPDResp</con:endpoint><con:endpoint>https://localhost:${HttpsDefaultPort}/NhinConnect/PatientDiscovery</con:endpoint></con:endpoints><con:operation action="urn:hl7-org:v3:PRPA_IN201305UV02:CrossGatewayPatientDiscovery" anonymous="optional" bindingOperationName="RespondingGateway_PRPA_IN201305UV02" inputName="" isOneWay="false" name="RespondingGateway_PRPA_IN201305UV02" receivesAttachments="false" sendsAttachments="false" type="Request-Response"><con:settings/></con:operation></con:interface><con:interface xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" anonymous="optional" bindingName="{urn:gov:hhs:fha:nhinc:adapterpolicyengine}AdapterPolicyEngineBindingSoap" definition="WSDL path not set.  #AdapterPolicyEngine.wsdl" name="AdapterPolicyEngineBindingSoap" soapVersion="1_2" type="wsdl" wsaVersion="NONE" xsi:type="con:WsdlInterface"><con:settings/><con:endpoints><con:endpoint>http://localhost:${HttpDefaultPort}/NhinConnect/AdapterPolicyEngine</con:endpoint><con:endpoint>https://PHX-ONC-WTST21:8088/mockAdapterPolicyEngineBindingSoap</con:endpoint></con:endpoints><con:operation action="urn:CheckPolicy" anonymous="optional" bindingOperationName="CheckPolicy" inputName="CheckPolicyRequest" isOneWay="false" name="CheckPolicy" outputName="CheckPolicyResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response"><con:settings/></con:operation></con:interface><con:interface xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" anonymous="optional" bindingName="{urn:gov:hhs:fha:nhinc:entitydocquery}EntityDocQueryBindingSoap" definition="WSDL path not set.  #EntityDocQuery.wsdl" name="EntityDocQueryBindingSoap" soapVersion="1_2" type="wsdl" wsaVersion="NONE" xsi:type="con:WsdlInterface">
    <con:settings/>
    
    <con:endpoints>
      <con:endpoint>http://localhost:${HttpDefaultPort}/NhinConnect/EntityDocQuery</con:endpoint>
      <con:endpoint>http://ATHC-GFAS:9080/NhinConnect/EntityDocQuery</con:endpoint>
      <con:endpoint>http://172.16.50.54:9080/NhinConnect/EntityDocQuery</con:endpoint>
      <con:endpoint>http://172.16.50.82:9080/NhinConnect/EntityDocQuery</con:endpoint>
      <con:endpoint>http://DVANHIE3.fedsconnect.org:9080/NhinConnect/EntityDocQuery</con:endpoint>
    </con:endpoints>
    <con:operation action="urn:RespondingGateway_CrossGatewayQuery" anonymous="optional" bindingOperationName="RespondingGateway_CrossGatewayQuery" inputName="RespondingGateway_CrossGatewayQueryRequest" isOneWay="false" name="RespondingGateway_CrossGatewayQuery" outputName="RespondingGateway_CrossGatewayQueryResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response">
      <con:settings/>
    </con:operation>
  </con:interface><con:interface xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" anonymous="optional" bindingName="{urn:gov:hhs:fha:nhinc:adaptercomponentmpi}AdapterComponentMpiPortTypeBinding" definition="WSDL path not set.  #AdapterComponentMpi.wsdl" name="AdapterComponentMpiPortTypeBinding" soapVersion="1_2" type="wsdl" wsaVersion="NONE" xsi:type="con:WsdlInterface"><con:settings/><con:endpoints><con:endpoint>http://localhost:${NhincHttpPort}/NhinConnect/AdapterComponentMpiService</con:endpoint></con:endpoints><con:operation action="FindCandidates" anonymous="optional" bindingOperationName="FindCandidates" inputName="FindCandidatesRequest" isOneWay="false" name="FindCandidates" outputName="FindCandidatesResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response"><con:settings/></con:operation></con:interface><con:interface xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" anonymous="optional" bindingName="{urn:gov:hhs:fha:nhinc:adaptermpi}AdapterMpiPortTypeBinding" definition="WSDL path not set.  #AdapterMpi.wsdl" name="AdapterMpiPortTypeBinding" soapVersion="1_2" type="wsdl" wsaVersion="NONE" xsi:type="con:WsdlInterface"><con:settings/><con:endpoints><con:endpoint>http://localhost:${NhincHttpPort}/NhinConnect/AdapterMpiService</con:endpoint></con:endpoints><con:operation action="FindCandidates" anonymous="optional" bindingOperationName="FindCandidates" inputName="FindCandidatesRequest" isOneWay="false" name="FindCandidates" outputName="FindCandidatesResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response"><con:settings/></con:operation></con:interface><con:interface xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" anonymous="optional" bindingName="{urn:ihe:iti:xds-b:2007}DocumentRegistry_Binding_Soap" definition="WSDL path not set.  #AdapterComponentDocRegistry.wsdl" name="DocumentRegistry_Binding_Soap" soapVersion="1_2" type="wsdl" wsaVersion="NONE" xsi:type="con:WsdlInterface"><con:settings/><con:endpoints><con:endpoint>http://localhost:${NhincHttpPort}/DocumentRegistry_Service</con:endpoint></con:endpoints><con:operation action="urn:hl7-org:v3:PRPA_IN201301UV02" anonymous="optional" bindingOperationName="DocumentRegistry_PRPA_IN201301UV02" inputName="" isOneWay="false" name="DocumentRegistry_PRPA_IN201301UV02" receivesAttachments="false" sendsAttachments="false" type="Request-Response"><con:settings/></con:operation><con:operation action="urn:hl7-org:v3:PRPA_IN201302UV02" anonymous="optional" bindingOperationName="DocumentRegistry_PRPA_IN201302UV02" inputName="" isOneWay="false" name="DocumentRegistry_PRPA_IN201302UV02" receivesAttachments="false" sendsAttachments="false" type="Request-Response"><con:settings/></con:operation><con:operation action="urn:hl7-org:v3:PRPA_IN201304UV02" anonymous="optional" bindingOperationName="DocumentRegistry_PRPA_IN201304UV02" inputName="" isOneWay="false" name="DocumentRegistry_PRPA_IN201304UV02" receivesAttachments="false" sendsAttachments="false" type="Request-Response"><con:settings/></con:operation><con:operation action="urn:ihe:iti:2007:RegisterDocumentSet-b" anonymous="optional" bindingOperationName="DocumentRegistry_RegisterDocumentSet-b" inputName="" isOneWay="false" name="DocumentRegistry_RegisterDocumentSet-b" receivesAttachments="false" sendsAttachments="false" type="Request-Response"><con:settings/></con:operation><con:operation action="urn:ihe:iti:2007:RegistryStoredQuery" anonymous="optional" bindingOperationName="DocumentRegistry_RegistryStoredQuery" inputName="" isOneWay="false" name="DocumentRegistry_RegistryStoredQuery" receivesAttachments="false" sendsAttachments="false" type="Request-Response"><con:settings/></con:operation></con:interface><con:interface xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" anonymous="optional" bindingName="{urn:gov:hhs:fha:nhinc:adapterdocquery}AdapterDocQueryBindingSoap" definition="WSDL path not set.  #AdapterDocQuery.wsdl" name="AdapterDocQueryBindingSoap" soapVersion="1_2" type="wsdl" wsaVersion="NONE" xsi:type="con:WsdlInterface"><con:settings/><con:endpoints><con:endpoint>http://localhost:${HttpDefaultPort}/NhinConnect/AdapterDocQuery</con:endpoint></con:endpoints><con:operation action="urn:RespondingGateway_CrossGatewayQuery" anonymous="optional" bindingOperationName="RespondingGateway_CrossGatewayQuery" inputName="RespondingGateway_CrossGatewayQueryRequest" isOneWay="false" name="RespondingGateway_CrossGatewayQuery" outputName="RespondingGateway_CrossGatewayQueryResponse" receivesAttachments="false" sendsAttachments="false" type="Request-Response"><con:settings/></con:operation></con:interface><con:interface xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" anonymous="optional" bindingName="{urn:gov:hhs:fha:nhinc:adapterpatientdiscovery}AdapterPatientDiscoveryBindingSoap" definition="WSDL path not set.  #AdapterPatientDiscovery.wsdl" name="AdapterPatientDiscoveryBindingSoap" soapVersion="1_1" type="wsdl" wsaVersion="NONE" xsi:type="con:WsdlInterface"><con:settings/><con:endpoints><con:endpoint>https://localhost:${HttpsDefaultPort}/NhinConnect/AdapterPatientDiscovery</con:endpoint><con:endpoint>https://PHX-ONC-WTST21:7785/mockAdapterPD</con:endpoint></con:endpoints><con:operation action="urn:RespondingGateway_PRPA_IN201305UV02" anonymous="optional" bindingOperationName="RespondingGateway_PRPA_IN201305UV02" inputName="RespondingGateway_PRPA_IN201305UV02Request" isOneWay="false" name="RespondingGateway_PRPA_IN201305UV02" outputName="RespondingGateway_PRPA_IN201306UV02Response" receivesAttachments="false" sendsAttachments="false" type="Request-Response"><con:settings/></con:operation></con:interface><con:testSuite name="Fanout_Test"><con:settings/><con:runType>SEQUENTIAL</con:runType><con:testCase failOnError="true" failTestCaseOnErrors="true" id="2360032f-7112-4f06-bb4f-f7c5f979bb94" keepSession="false" maxResults="0" name="PD warmup" searchProperties="true">
      <con:settings/>
      
      
      <con:testStep name="Clear correlations and AA mapping tables" type="groovy">
        <con:settings/>
        <con:config><script>context.withSql('PatientCorrelationDB') { sql -&gt; 
  sql.execute('delete from ' + context.findProperty('PatientCorrelationTable'))
}

context.withSql('AAMappingDB') { sql -&gt; 
  sql.execute('delete from ' + context.findProperty('AAMappingTable'))
}</script></con:config>
      </con:testStep>
      <con:testStep name="Patient Discovery" type="request">
        <con:settings/>
        <con:config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:RequestStep">
          <con:interface>EntityPatientDiscoveryBindingSoap</con:interface>
          <con:operation>RespondingGateway_PRPA_IN201305UV02</con:operation>
          <con:request name="Patient Discovery">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/&gt;</con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>${#Project#Endpoint-PatientDiscovery}</con:endpoint>
            <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:hl7-org:v3" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:add="http://schemas.xmlsoap.org/ws/2004/08/addressing">
   <soapenv:Header/>
   <soapenv:Body projectName="EndToEndSelfTest" testCase="Patient Discovery">
      <urn:RespondingGateway_PRPA_IN201305UV02Request>
         <urn:PRPA_IN201305UV02 ITSVersion="XML_1.0">
            <urn:id root="1.1" extension="-5a3e95b1:11d1fa33d45:-7f9b"/>
            <urn:creationTime value="20091116084800"/>
            <urn:interactionId root="2.16.840.1.113883.1.6" extension="PRPA_IN201305UV02"/>
            <urn:processingCode code="T"/>
            <urn:processingModeCode code="T"/>
            <urn:acceptAckCode code="AL"/>
            <urn:receiver typeCode="RCV">
               <urn:device classCode="DEV" determinerCode="INSTANCE">
                  <urn:id root="1.2.345.678.999"/>
                  <urn:asAgent classCode="AGNT">
                     <urn:representedOrganization classCode="ORG" determinerCode="INSTANCE">
                        <urn:id root="${#Project#RemoteHCID}"/>
                     </urn:representedOrganization>
                  </urn:asAgent>
               </urn:device>
            </urn:receiver>
            <urn:sender typeCode="SND">
               <urn:device classCode="DEV" determinerCode="INSTANCE">
                  <urn:id root="1.2.345.678.999"/>
                  <urn:asAgent classCode="AGNT">
                     <urn:representedOrganization classCode="ORG" determinerCode="INSTANCE">
                        <urn:id root="${#Project#LocalHCID}"/>
                     </urn:representedOrganization>
                  </urn:asAgent>
               </urn:device>
            </urn:sender>
            <urn:controlActProcess classCode="CACT" moodCode="EVN">
               <code code="PRPA_TE201305UV02" codeSystem="2.16.840.1.113883.1.6"/>
               <urn:authorOrPerformer typeCode="AUT">
                  <urn:assignedDevice>
                     <urn:id root="${#Project#LocalAA}"/>
                  </urn:assignedDevice>
               </urn:authorOrPerformer>
               <urn:queryByParameter>
                  <urn:queryId root="${#Project#LocalHCID}" extension="-abd3453dcd24wkkks545"/>
                  <urn:statusCode code="new"/>
                  <urn:responseModalityCode code="R"/>
                  <urn:responsePriorityCode code="I"/>
                  <urn:parameterList>
                     <urn:livingSubjectAdministrativeGender>
                        <urn:value code="${#Project#Gender}"/>
                        <urn:semanticsText representation="TXT">LivingSubject.administrativeGender</urn:semanticsText>
                     </urn:livingSubjectAdministrativeGender>
                     <urn:livingSubjectBirthTime>
                        <urn:value value="${#Project#BirthTime}"/>
                        <urn:semanticsText representation="TXT">LivingSubject.birthTime</urn:semanticsText>
                     </urn:livingSubjectBirthTime>
                     <urn:livingSubjectName>
                        <urn:value>
                           <urn:family partType="FAM">${#Project#FamilyName}</urn:family>
                           <urn:given partType="GIV">${#Project#GivenName}</urn:given>
                        </urn:value>
                        <urn:semanticsText representation="TXT">LivingSubject.name</urn:semanticsText>
                     </urn:livingSubjectName>
                     <urn:livingSubjectId>
                        <urn:value root="${#Project#LocalAA}" extension="${#Project#SubjectID}"/>
                        <urn:semanticsText representation="TXT"/>
                     </urn:livingSubjectId>
                  </urn:parameterList>
               </urn:queryByParameter>
            </urn:controlActProcess>
         </urn:PRPA_IN201305UV02>
         <urn:assertion>
            <urn1:address>
               <urn1:addressType>
                  <urn1:code>W</urn1:code>
               </urn1:addressType>
               <urn1:city>${#Project#City}</urn1:city>
               <urn1:country>${#Project#Country}</urn1:country>
               <urn1:state>${#Project#State}</urn1:state>
               <urn1:streetAddress>${#Project#StreetAddress}</urn1:streetAddress>
               <urn1:zipCode>${#Project#ZipCode}</urn1:zipCode>
            </urn1:address>
            <urn1:dateOfBirth>${#Project#DOB}</urn1:dateOfBirth>
            <urn1:dateOfSignature>${#Project#DateOfSignature}</urn1:dateOfSignature>
            <urn1:expirationDate>${#Project#ExpirationDate}</urn1:expirationDate>
            <urn1:explanationNonClaimantSignature>NEEDED</urn1:explanationNonClaimantSignature>
            <urn1:haveSecondWitnessSignature>true</urn1:haveSecondWitnessSignature>
            <urn1:haveSignature>true</urn1:haveSignature>
            <urn1:haveWitnessSignature>true</urn1:haveWitnessSignature>
            <urn1:homeCommunity>
               <urn1:description>${#Project#LocalHCDescription}</urn1:description>
               <urn1:homeCommunityId>${#Project#LocalHCID}</urn1:homeCommunityId>
               <urn1:name>${#Project#LocalHCDescription}</urn1:name>
            </urn1:homeCommunity>
            <urn1:personName>
               <urn1:familyName>${#Project#FamilyName}</urn1:familyName>
               <urn1:givenName>${#Project#GivenName}</urn1:givenName>
               <urn1:nameType>
                  <urn1:code>G</urn1:code>
               </urn1:nameType>
               <urn1:secondNameOrInitials>FJ</urn1:secondNameOrInitials>
               <urn1:fullName>Joe Smith</urn1:fullName>
               <urn1:prefix>Mr</urn1:prefix>
            </urn1:personName>
            <urn1:phoneNumber>
               <urn1:areaCode>123</urn1:areaCode>
               <urn1:countryCode>1</urn1:countryCode>
               <urn1:extension>1234</urn1:extension>
               <urn1:localNumber>3456789</urn1:localNumber>
               <urn1:phoneNumberType>
                  <urn1:code>W</urn1:code>
               </urn1:phoneNumberType>
            </urn1:phoneNumber>
            <urn1:purposeOfDisclosure>${#Project#PurposeOfDisclosure}</urn1:purposeOfDisclosure>
            <urn1:secondWitnessAddress>
               <urn1:addressType>
                  <urn1:code>W</urn1:code>
               </urn1:addressType>
               <urn1:city>Melbourne</urn1:city>
               <urn1:country>US</urn1:country>
               <urn1:state>FL</urn1:state>
               <urn1:streetAddress>123 Johnson Rd</urn1:streetAddress>
               <urn1:zipCode>12345</urn1:zipCode>
            </urn1:secondWitnessAddress>
            <urn1:secondWitnessName>
               <urn1:familyName>Hughes</urn1:familyName>
               <urn1:givenName>Howie</urn1:givenName>
               <urn1:nameType>
                  <urn1:code>G</urn1:code>
               </urn1:nameType>
               <urn1:secondNameOrInitials>HH</urn1:secondNameOrInitials>
               <urn1:fullName>Howie Hughes</urn1:fullName>
               <urn1:prefix>Dr</urn1:prefix>
            </urn1:secondWitnessName>
            <urn1:secondWitnessPhone>
               <urn1:areaCode>123</urn1:areaCode>
               <urn1:countryCode>1</urn1:countryCode>
               <urn1:extension>1546</urn1:extension>
               <urn1:localNumber>4567892</urn1:localNumber>
               <urn1:phoneNumberType>
                  <urn1:code>W</urn1:code>
               </urn1:phoneNumberType>
            </urn1:secondWitnessPhone>
            <urn1:SSN>${#Project#SSN}</urn1:SSN>
            <urn1:uniquePatientId>${#Project#UniquePatientId}</urn1:uniquePatientId>
            <urn1:witnessAddress>
               <urn1:addressType>
                  <urn1:code>W</urn1:code>
               </urn1:addressType>
               <urn1:city>Frankfort</urn1:city>
               <urn1:country>US</urn1:country>
               <urn1:state>MN</urn1:state>
               <urn1:streetAddress>432 Jackson St</urn1:streetAddress>
               <urn1:zipCode>65498</urn1:zipCode>
            </urn1:witnessAddress>
            <urn1:witnessName>
               <urn1:familyName>Ugble</urn1:familyName>
               <urn1:givenName>Gary</urn1:givenName>
               <urn1:nameType>
                  <urn1:code>G</urn1:code>
               </urn1:nameType>
               <urn1:secondNameOrInitials>GU</urn1:secondNameOrInitials>
               <urn1:fullName>Gary Ugble</urn1:fullName>
               <urn1:prefix>Mr</urn1:prefix>
            </urn1:witnessName>
            <urn1:witnessPhone>
               <urn1:areaCode>987</urn1:areaCode>
               <urn1:countryCode>1</urn1:countryCode>
               <urn1:extension>6549</urn1:extension>
               <urn1:localNumber>2222222</urn1:localNumber>
               <urn1:phoneNumberType>
                  <urn1:code>H</urn1:code>
               </urn1:phoneNumberType>
            </urn1:witnessPhone>
            <urn1:userInfo>
               <urn1:personName>
                  <urn1:familyName>Anderson</urn1:familyName>
                  <urn1:givenName>Wilma</urn1:givenName>
                  <urn1:nameType>
                     <urn1:code>G</urn1:code>
                  </urn1:nameType>
                  <urn1:secondNameOrInitials>WA</urn1:secondNameOrInitials>
                  <urn1:fullName>Wilma Anderson</urn1:fullName>
                  <urn1:prefix>Mrs</urn1:prefix>
               </urn1:personName>
               <urn1:userName>wanderson</urn1:userName>
               <urn1:role>nurse</urn1:role>
               <urn1:org>
                  <urn1:description>${#Project#LocalHCDescription}</urn1:description>
                  <urn1:homeCommunityId>${#Project#LocalHCID}</urn1:homeCommunityId>
                  <urn1:name>${#Project#LocalHCDescription}</urn1:name>
               </urn1:org>
               <urn1:roleCoded>
                  <urn1:code>307969004</urn1:code>
                  <urn1:codeSystem>2.16.840.1.113883.6.96</urn1:codeSystem>
                  <urn1:codeSystemName>SNOMED_CT</urn1:codeSystemName>
                  <urn1:codeSystemVersion>1.0</urn1:codeSystemVersion>
                  <urn1:displayName>Public Health</urn1:displayName>
                  <urn1:originalText>Public Health</urn1:originalText>
               </urn1:roleCoded>
            </urn1:userInfo>
            <urn1:authorized>true</urn1:authorized>
            <urn1:purposeOfDisclosureCoded>
               <urn1:code>PUBLICHEALTH</urn1:code>
               <urn1:codeSystem>2.16.840.1.113883.3.18.7.1</urn1:codeSystem>
               <urn1:codeSystemName>nhin-purpose</urn1:codeSystemName>
               <urn1:codeSystemVersion>1.0</urn1:codeSystemVersion>
               <urn1:displayName>Use or disclosure of Psychotherapy Notes</urn1:displayName>
               <urn1:originalText>Use or disclosure of Psychotherapy Notes</urn1:originalText>
            </urn1:purposeOfDisclosureCoded>
            <urn1:samlAuthnStatement>
               <urn1:authInstant>2009-04-16T13:15:39Z</urn1:authInstant>
               <urn1:sessionIndex>987</urn1:sessionIndex>
               <urn1:authContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:X509</urn1:authContextClassRef>
               <urn1:subjectLocalityAddress>158.147.185.168</urn1:subjectLocalityAddress>
               <urn1:subjectLocalityDNSName>cs.myharris.net</urn1:subjectLocalityDNSName>
            </urn1:samlAuthnStatement>
            <urn1:samlAuthzDecisionStatement>
               <urn1:decision>Permit</urn1:decision>
               <urn1:resource>https://158.147.185.168:8181/SamlReceiveService/SamlProcessWS</urn1:resource>
               <urn1:action>TestSaml</urn1:action>
               <urn1:evidence>
                  <urn1:assertion>
                     <urn1:id>40df7c0a-ff3e-4b26-baeb-f2910f6d05a9</urn1:id>
                     <urn1:issueInstant>2009-04-16T13:10:39.093Z</urn1:issueInstant>
                     <urn1:version>2.0</urn1:version>
                     <urn1:issuerFormat>urn:oasis:names:tc:SAML:1.1:nameid-format:X509SubjectName</urn1:issuerFormat>
                     <urn1:issuer>CN=SAML User,OU=Harris,O=HITS,L=Melbourne,ST=FL,C=US</urn1:issuer>
                     <urn1:conditions>
                        <urn1:notBefore>2009-04-16T13:10:39.093Z</urn1:notBefore>
                        <urn1:notOnOrAfter>2009-12-31T12:00:00.000Z</urn1:notOnOrAfter>
                     </urn1:conditions>
                     <urn1:accessConsentPolicy>Claim-Ref-1234</urn1:accessConsentPolicy>
                     <urn1:instanceAccessConsentPolicy>Claim-Instance-1</urn1:instanceAccessConsentPolicy>
                  </urn1:assertion>
               </urn1:evidence>
            </urn1:samlAuthzDecisionStatement>
         </urn:assertion>
        <urn:NhinTargetCommunities>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
               <urn1:description>${#Project#RemoteHCDescription}</urn1:description>
               <urn1:homeCommunityId>${#Project#RemoteHCID}</urn1:homeCommunityId>
               <urn1:name>${#Project#RemoteHCDescription}</urn1:name>
               </urn1:homeCommunity>
            </urn1:nhinTargetCommunity> 
         </urn:NhinTargetCommunities>
      </urn:RespondingGateway_PRPA_IN201305UV02Request>
      <urn:PIXConsumer_PRPA_IN201305UVRequest/>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
            <con:assertion type="SOAP Response"/>
            <con:assertion disabled="true" type="Schema Compliance">
              <con:configuration/>
            </con:assertion>
            <con:assertion type="SOAP Fault Assertion"/>
            <con:assertion name="Check for existance of [ns3:controlActProcess]" type="XPath Match">
              <con:configuration>
                <path>declare namespace ns3='urn:hl7-org:v3';
exists( //ns3:PRPA_IN201306UV02/ns3:controlActProcess)</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
              </con:configuration>
            </con:assertion>
            <con:assertion name="Given Name XPath Match" type="XPath Match">
              <con:configuration>
                <path>declare namespace ns1='urn:hl7-org:v3';
//ns1:PRPA_IN201306UV02[1]/ns1:controlActProcess[1]/ns1:subject[1]/ns1:registrationEvent[1]/ns1:subject1[1]/ns1:patient[1]/ns1:patientPerson[1]/ns1:name[1]/ns1:given[1]</path>
                <content>${#Project#GivenName}</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
              </con:configuration>
            </con:assertion>
            <con:assertion name="Family Name XPath Match" type="XPath Match">
              <con:configuration>
                <path>declare namespace ns1='urn:hl7-org:v3';
//ns1:PRPA_IN201306UV02[1]/ns1:controlActProcess[1]/ns1:subject[1]/ns1:registrationEvent[1]/ns1:subject1[1]/ns1:patient[1]/ns1:patientPerson[1]/ns1:name[1]/ns1:family[1]</path>
                <content>${#Project#FamilyName}</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
              </con:configuration>
            </con:assertion>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep><con:testStep name="Count correlations (1)" type="groovy">
        <con:settings/>
        <con:config><script>context.withSql('PatientCorrelationDB') { sql -&gt; 
  assert 1 == sql.firstRow('select count(*) from ' + context.findProperty('PatientCorrelationTable'))[0]
}</script></con:config>
      </con:testStep><con:setupScript/><con:tearDownScript>import nhinc.FileUtils;
FileUtils.restoreToMasterConfiguration(context, log);</con:tearDownScript><con:properties>
        <con:property>
          <con:name>startDate</con:name>
          <con:value>2012-08-25T00:56:03Z</con:value>
        </con:property>
        <con:property>
          <con:name>endDate</con:name>
          <con:value>2012-08-25T01:06:03Z</con:value>
        </con:property>
        <con:property>
          <con:name>sigDate</con:name>
          <con:value>08/25/2012 00:56:03</con:value>
        </con:property>
        <con:property>
          <con:name>expireDate</con:name>
          <con:value>2012-09-24T00:00:00Z</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
    </con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" id="cf974f56-db97-4ff9-9d77-392e6d0b589c" keepSession="false" maxResults="0" name="PD no mock" searchProperties="true">
      <con:settings/>
      
      
      
      <con:testStep name="Clear correlations and AA mapping tables" type="groovy">
        <con:settings/>
        <con:config><script>context.withSql('PatientCorrelationDB') { sql -&gt; 
  sql.execute('delete from ' + context.findProperty('PatientCorrelationTable'))
}

context.withSql('AAMappingDB') { sql -&gt; 
  sql.execute('delete from ' + context.findProperty('AAMappingTable'))
}</script></con:config>
      </con:testStep><con:testStep name="copy uddiConnectionInfo" type="groovy">
				<con:settings/>
				<con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
def projectPropPath = groovyUtils.projectPath

def sourceDir = projectPropPath;
def sourceFile = "uddiConnectionInfo_FANOUT.xml";
def destDir = System.env['NHINC_PROPERTIES_DIR'];
def destFile = "uddiConnectionInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.MoveFile(sourceDir, sourceFile, destDir, destFile, context, log);






					</script></con:config>
			</con:testStep><con:testStep name="modify uddiConnectionInfo" type="groovy"><con:settings/><con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context );

def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];
def NHINGatewayHost = context.findProperty("NHINGatewayHost");
def mockHost = context.findProperty("MockHost");
def PDURL = "https://" + mockHost + ":8181/Gateway/PatientDiscovery/1_0/NhinService/NhinPatientDiscovery";

FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "1.1", "PatientDiscovery", PDURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "2.2", "PatientDiscovery", PDURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "3.3", "PatientDiscovery", PDURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "4.4", "PatientDiscovery", PDURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "5.5", "PatientDiscovery", PDURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "6.6", "PatientDiscovery", PDURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "7.7", "PatientDiscovery", PDURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "8.8", "PatientDiscovery", PDURL, "2.0", context, log)</script></con:config></con:testStep><con:testStep name="Patient Discovery" type="request">
        <con:settings/>
        <con:config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:RequestStep">
          <con:interface>EntityPatientDiscoveryBindingSoap</con:interface>
          <con:operation>RespondingGateway_PRPA_IN201305UV02</con:operation>
          <con:request name="Patient Discovery">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/&gt;</con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>${#Project#Endpoint-PatientDiscovery}</con:endpoint>
            <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:hl7-org:v3" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:add="http://schemas.xmlsoap.org/ws/2004/08/addressing">
   <soapenv:Header/>
   <soapenv:Body projectName="EndToEndSelfTest" testCase="Patient Discovery">
      <urn:RespondingGateway_PRPA_IN201305UV02Request>
         <urn:PRPA_IN201305UV02 ITSVersion="XML_1.0">
            <urn:id root="1.1" extension="-5a3e95b1:11d1fa33d45:-7f9b"/>
            <urn:creationTime value="20091116084800"/>
            <urn:interactionId root="2.16.840.1.113883.1.6" extension="PRPA_IN201305UV02"/>
            <urn:processingCode code="T"/>
            <urn:processingModeCode code="T"/>
            <urn:acceptAckCode code="AL"/>
            <urn:receiver typeCode="RCV">
               <urn:device classCode="DEV" determinerCode="INSTANCE">
                  <urn:id root="1.2.345.678.999"/>
                  <urn:asAgent classCode="AGNT">
                     <urn:representedOrganization classCode="ORG" determinerCode="INSTANCE">
                        <urn:id root="${#Project#RemoteHCID}"/>
                     </urn:representedOrganization>
                  </urn:asAgent>
               </urn:device>
            </urn:receiver>
            <urn:sender typeCode="SND">
               <urn:device classCode="DEV" determinerCode="INSTANCE">
                  <urn:id root="1.2.345.678.999"/>
                  <urn:asAgent classCode="AGNT">
                     <urn:representedOrganization classCode="ORG" determinerCode="INSTANCE">
                        <urn:id root="${#Project#LocalHCID}"/>
                     </urn:representedOrganization>
                  </urn:asAgent>
               </urn:device>
            </urn:sender>
            <urn:controlActProcess classCode="CACT" moodCode="EVN">
               <code code="PRPA_TE201305UV02" codeSystem="2.16.840.1.113883.1.6"/>
               <urn:authorOrPerformer typeCode="AUT">
                  <urn:assignedDevice>
                     <urn:id root="${#Project#LocalAA}"/>
                  </urn:assignedDevice>
               </urn:authorOrPerformer>
               <urn:queryByParameter>
                  <urn:queryId root="${#Project#LocalHCID}" extension="-abd3453dcd24wkkks545"/>
                  <urn:statusCode code="new"/>
                  <urn:responseModalityCode code="R"/>
                  <urn:responsePriorityCode code="I"/>
                  <urn:parameterList>
                     <urn:livingSubjectAdministrativeGender>
                        <urn:value code="${#Project#Gender}"/>
                        <urn:semanticsText representation="TXT">LivingSubject.administrativeGender</urn:semanticsText>
                     </urn:livingSubjectAdministrativeGender>
                     <urn:livingSubjectBirthTime>
                        <urn:value value="${#Project#BirthTime}"/>
                        <urn:semanticsText representation="TXT">LivingSubject.birthTime</urn:semanticsText>
                     </urn:livingSubjectBirthTime>
                     <urn:livingSubjectName>
                        <urn:value>
                           <urn:family partType="FAM">${#Project#FamilyName}</urn:family>
                           <urn:given partType="GIV">${#Project#GivenName}</urn:given>
                        </urn:value>
                        <urn:semanticsText representation="TXT">LivingSubject.name</urn:semanticsText>
                     </urn:livingSubjectName>
                     <urn:livingSubjectId>
                        <urn:value root="${#Project#LocalAA}" extension="${#Project#SubjectID}"/>
                        <urn:semanticsText representation="TXT"/>
                     </urn:livingSubjectId>
                  </urn:parameterList>
               </urn:queryByParameter>
            </urn:controlActProcess>
         </urn:PRPA_IN201305UV02>
         <urn:assertion>
            <urn1:address>
               <urn1:addressType>
                  <urn1:code>W</urn1:code>
               </urn1:addressType>
               <urn1:city>${#Project#City}</urn1:city>
               <urn1:country>${#Project#Country}</urn1:country>
               <urn1:state>${#Project#State}</urn1:state>
               <urn1:streetAddress>${#Project#StreetAddress}</urn1:streetAddress>
               <urn1:zipCode>${#Project#ZipCode}</urn1:zipCode>
            </urn1:address>
            <urn1:dateOfBirth>${#Project#DOB}</urn1:dateOfBirth>
            <urn1:dateOfSignature>${#Project#DateOfSignature}</urn1:dateOfSignature>
            <urn1:expirationDate>${#Project#ExpirationDate}</urn1:expirationDate>
            <urn1:explanationNonClaimantSignature>NEEDED</urn1:explanationNonClaimantSignature>
            <urn1:haveSecondWitnessSignature>true</urn1:haveSecondWitnessSignature>
            <urn1:haveSignature>true</urn1:haveSignature>
            <urn1:haveWitnessSignature>true</urn1:haveWitnessSignature>
            <urn1:homeCommunity>
               <urn1:description>${#Project#LocalHCDescription}</urn1:description>
               <urn1:homeCommunityId>${#Project#LocalHCID}</urn1:homeCommunityId>
               <urn1:name>${#Project#LocalHCDescription}</urn1:name>
            </urn1:homeCommunity>
            <urn1:personName>
               <urn1:familyName>${#Project#FamilyName}</urn1:familyName>
               <urn1:givenName>${#Project#GivenName}</urn1:givenName>
               <urn1:nameType>
                  <urn1:code>G</urn1:code>
               </urn1:nameType>
               <urn1:secondNameOrInitials>FJ</urn1:secondNameOrInitials>
               <urn1:fullName>Joe Smith</urn1:fullName>
               <urn1:prefix>Mr</urn1:prefix>
            </urn1:personName>
            <urn1:phoneNumber>
               <urn1:areaCode>123</urn1:areaCode>
               <urn1:countryCode>1</urn1:countryCode>
               <urn1:extension>1234</urn1:extension>
               <urn1:localNumber>3456789</urn1:localNumber>
               <urn1:phoneNumberType>
                  <urn1:code>W</urn1:code>
               </urn1:phoneNumberType>
            </urn1:phoneNumber>
            <urn1:purposeOfDisclosure>${#Project#PurposeOfDisclosure}</urn1:purposeOfDisclosure>
            <urn1:secondWitnessAddress>
               <urn1:addressType>
                  <urn1:code>W</urn1:code>
               </urn1:addressType>
               <urn1:city>Melbourne</urn1:city>
               <urn1:country>US</urn1:country>
               <urn1:state>FL</urn1:state>
               <urn1:streetAddress>123 Johnson Rd</urn1:streetAddress>
               <urn1:zipCode>12345</urn1:zipCode>
            </urn1:secondWitnessAddress>
            <urn1:secondWitnessName>
               <urn1:familyName>Hughes</urn1:familyName>
               <urn1:givenName>Howie</urn1:givenName>
               <urn1:nameType>
                  <urn1:code>G</urn1:code>
               </urn1:nameType>
               <urn1:secondNameOrInitials>HH</urn1:secondNameOrInitials>
               <urn1:fullName>Howie Hughes</urn1:fullName>
               <urn1:prefix>Dr</urn1:prefix>
            </urn1:secondWitnessName>
            <urn1:secondWitnessPhone>
               <urn1:areaCode>123</urn1:areaCode>
               <urn1:countryCode>1</urn1:countryCode>
               <urn1:extension>1546</urn1:extension>
               <urn1:localNumber>4567892</urn1:localNumber>
               <urn1:phoneNumberType>
                  <urn1:code>W</urn1:code>
               </urn1:phoneNumberType>
            </urn1:secondWitnessPhone>
            <urn1:SSN>${#Project#SSN}</urn1:SSN>
            <urn1:uniquePatientId>${#Project#UniquePatientId}</urn1:uniquePatientId>
            <urn1:witnessAddress>
               <urn1:addressType>
                  <urn1:code>W</urn1:code>
               </urn1:addressType>
               <urn1:city>Frankfort</urn1:city>
               <urn1:country>US</urn1:country>
               <urn1:state>MN</urn1:state>
               <urn1:streetAddress>432 Jackson St</urn1:streetAddress>
               <urn1:zipCode>65498</urn1:zipCode>
            </urn1:witnessAddress>
            <urn1:witnessName>
               <urn1:familyName>Ugble</urn1:familyName>
               <urn1:givenName>Gary</urn1:givenName>
               <urn1:nameType>
                  <urn1:code>G</urn1:code>
               </urn1:nameType>
               <urn1:secondNameOrInitials>GU</urn1:secondNameOrInitials>
               <urn1:fullName>Gary Ugble</urn1:fullName>
               <urn1:prefix>Mr</urn1:prefix>
            </urn1:witnessName>
            <urn1:witnessPhone>
               <urn1:areaCode>987</urn1:areaCode>
               <urn1:countryCode>1</urn1:countryCode>
               <urn1:extension>6549</urn1:extension>
               <urn1:localNumber>2222222</urn1:localNumber>
               <urn1:phoneNumberType>
                  <urn1:code>H</urn1:code>
               </urn1:phoneNumberType>
            </urn1:witnessPhone>
            <urn1:userInfo>
               <urn1:personName>
                  <urn1:familyName>Anderson</urn1:familyName>
                  <urn1:givenName>Wilma</urn1:givenName>
                  <urn1:nameType>
                     <urn1:code>G</urn1:code>
                  </urn1:nameType>
                  <urn1:secondNameOrInitials>WA</urn1:secondNameOrInitials>
                  <urn1:fullName>Wilma Anderson</urn1:fullName>
                  <urn1:prefix>Mrs</urn1:prefix>
               </urn1:personName>
               <urn1:userName>wanderson</urn1:userName>
               <urn1:role>nurse</urn1:role>
               <urn1:org>
                  <urn1:description>${#Project#LocalHCDescription}</urn1:description>
                  <urn1:homeCommunityId>${#Project#LocalHCID}</urn1:homeCommunityId>
                  <urn1:name>${#Project#LocalHCDescription}</urn1:name>
               </urn1:org>
               <urn1:roleCoded>
                  <urn1:code>307969004</urn1:code>
                  <urn1:codeSystem>2.16.840.1.113883.6.96</urn1:codeSystem>
                  <urn1:codeSystemName>SNOMED_CT</urn1:codeSystemName>
                  <urn1:codeSystemVersion>1.0</urn1:codeSystemVersion>
                  <urn1:displayName>Public Health</urn1:displayName>
                  <urn1:originalText>Public Health</urn1:originalText>
               </urn1:roleCoded>
            </urn1:userInfo>
            <urn1:authorized>true</urn1:authorized>
            <urn1:purposeOfDisclosureCoded>
               <urn1:code>PUBLICHEALTH</urn1:code>
               <urn1:codeSystem>2.16.840.1.113883.3.18.7.1</urn1:codeSystem>
               <urn1:codeSystemName>nhin-purpose</urn1:codeSystemName>
               <urn1:codeSystemVersion>1.0</urn1:codeSystemVersion>
               <urn1:displayName>Use or disclosure of Psychotherapy Notes</urn1:displayName>
               <urn1:originalText>Use or disclosure of Psychotherapy Notes</urn1:originalText>
            </urn1:purposeOfDisclosureCoded>
            <urn1:samlAuthnStatement>
               <urn1:authInstant>2009-04-16T13:15:39Z</urn1:authInstant>
               <urn1:sessionIndex>987</urn1:sessionIndex>
               <urn1:authContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:X509</urn1:authContextClassRef>
               <urn1:subjectLocalityAddress>158.147.185.168</urn1:subjectLocalityAddress>
               <urn1:subjectLocalityDNSName>cs.myharris.net</urn1:subjectLocalityDNSName>
            </urn1:samlAuthnStatement>
            <urn1:samlAuthzDecisionStatement>
               <urn1:decision>Permit</urn1:decision>
               <urn1:resource>https://158.147.185.168:8181/SamlReceiveService/SamlProcessWS</urn1:resource>
               <urn1:action>TestSaml</urn1:action>
               <urn1:evidence>
                  <urn1:assertion>
                     <urn1:id>40df7c0a-ff3e-4b26-baeb-f2910f6d05a9</urn1:id>
                     <urn1:issueInstant>2009-04-16T13:10:39.093Z</urn1:issueInstant>
                     <urn1:version>2.0</urn1:version>
                     <urn1:issuerFormat>urn:oasis:names:tc:SAML:1.1:nameid-format:X509SubjectName</urn1:issuerFormat>
                     <urn1:issuer>CN=SAML User,OU=Harris,O=HITS,L=Melbourne,ST=FL,C=US</urn1:issuer>
                     <urn1:conditions>
                        <urn1:notBefore>2009-04-16T13:10:39.093Z</urn1:notBefore>
                        <urn1:notOnOrAfter>2009-12-31T12:00:00.000Z</urn1:notOnOrAfter>
                     </urn1:conditions>
                     <urn1:accessConsentPolicy>Claim-Ref-1234</urn1:accessConsentPolicy>
                     <urn1:instanceAccessConsentPolicy>Claim-Instance-1</urn1:instanceAccessConsentPolicy>
                  </urn1:assertion>
               </urn1:evidence>
            </urn1:samlAuthzDecisionStatement>
         </urn:assertion>
<!--        <urn:NhinTargetCommunities>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
               <urn1:description>${#Project#RemoteHCDescription}</urn1:description>
               <urn1:homeCommunityId>${#Project#RemoteHCID}</urn1:homeCommunityId>
               <urn1:name>${#Project#RemoteHCDescription}</urn1:name>
               </urn1:homeCommunity>
            </urn1:nhinTargetCommunity> 
         </urn:NhinTargetCommunities> -->
      </urn:RespondingGateway_PRPA_IN201305UV02Request>
      <urn:PIXConsumer_PRPA_IN201305UVRequest/>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
            <con:assertion type="SOAP Response"/>
            <con:assertion disabled="true" type="Schema Compliance">
              <con:configuration/>
            </con:assertion>
            <con:assertion type="SOAP Fault Assertion"/>
            <con:assertion name="Check for existance of [ns3:controlActProcess]" type="XPath Match">
              <con:configuration>
                <path>declare namespace ns3='urn:hl7-org:v3';
exists( //ns3:PRPA_IN201306UV02/ns3:controlActProcess)</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
              </con:configuration>
            </con:assertion>
            <con:assertion name="Given Name XPath Match" type="XPath Match">
              <con:configuration>
                <path>declare namespace ns1='urn:hl7-org:v3';
//ns1:PRPA_IN201306UV02[1]/ns1:controlActProcess[1]/ns1:subject[1]/ns1:registrationEvent[1]/ns1:subject1[1]/ns1:patient[1]/ns1:patientPerson[1]/ns1:name[1]/ns1:given[1]</path>
                <content>${#Project#GivenName}</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
              </con:configuration>
            </con:assertion>
            <con:assertion name="Family Name XPath Match" type="XPath Match">
              <con:configuration>
                <path>declare namespace ns1='urn:hl7-org:v3';
//ns1:PRPA_IN201306UV02[1]/ns1:controlActProcess[1]/ns1:subject[1]/ns1:registrationEvent[1]/ns1:subject1[1]/ns1:patient[1]/ns1:patientPerson[1]/ns1:name[1]/ns1:family[1]</path>
                <content>${#Project#FamilyName}</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
              </con:configuration>
            </con:assertion>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep><con:testStep name="count correlations" type="groovy">
        <con:settings/>
        <con:config><script>context.withSql('PatientCorrelationDB') { sql -&gt; 
  assert 0 &lt; sql.firstRow('select count(*) from ' + context.findProperty('PatientCorrelationTable'))[0]
}</script></con:config>
      </con:testStep><con:setupScript>def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];

File sourceInternalFile = new File(destConfigFileLocation, "internalConnectionInfo.xml");
File backupInternalFile = new File(destConfigFileLocation, "internalConnectionInfo_BACKUP.xml");

File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(sourceInternalFile, backupInternalFile, log);
MoveFile(sourceUddiFile, backupUddiFile, log);</con:setupScript><con:tearDownScript>FileUtils.restoreToMasterConfiguration(context, log);

File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");


MoveFile(backupInternalFile, sourceInternalFile, log);
MoveFile(backupUddiFile, sourceUddiFile, log);

DeleteFile(backupInternalFile, log);
DeleteFile(backupUddiFile, log);</con:tearDownScript><con:properties>
        <con:property>
          <con:name>startDate</con:name>
          <con:value>2012-08-25T00:56:05Z</con:value>
        </con:property>
        <con:property>
          <con:name>endDate</con:name>
          <con:value>2012-08-25T01:06:05Z</con:value>
        </con:property>
        <con:property>
          <con:name>sigDate</con:name>
          <con:value>08/25/2012 00:56:05</con:value>
        </con:property>
        <con:property>
          <con:name>expireDate</con:name>
          <con:value>2012-09-24T00:00:00Z</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
    </con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" id="b4c0e8cc-3d14-4c26-b2ae-a2c7d6372d60" keepSession="false" maxResults="0" name="PD happy path" searchProperties="true">
      <con:description/><con:settings/>
      
      
      <con:testStep name="Clear correlations and AA mapping tables" type="groovy">
        <con:settings/>
        <con:config><script>import nhinc.FileUtils;
context.withSql('PatientCorrelationDB') { sql -&gt; 
  sql.execute('delete from ' + context.findProperty('PatientCorrelationTable'))
}

context.withSql('AAMappingDB') { sql -&gt; 
  sql.execute('delete from ' + context.findProperty('AAMappingTable'))
}</script></con:config>
      </con:testStep>
      <con:testStep name="copy uddiConnectionInfo" type="groovy">
				<con:settings/>
				<con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
def projectPropPath = groovyUtils.projectPath

def sourceDir = projectPropPath;
def sourceFile = "uddiConnectionInfo_FANOUT.xml";
def destDir = System.env['NHINC_PROPERTIES_DIR'];
def destFile = "uddiConnectionInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.MoveFile(sourceDir, sourceFile, destDir, destFile, context, log);






					</script></con:config>
			</con:testStep><con:testStep name="modify internalConnectionInfo" type="groovy"><con:settings/><con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context );
def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];
def NHINGatewayHost = context.findProperty("NHINGatewayHost");
def mockHost = context.findProperty("mockHost");
def localHCID = context.findProperty("LocalHCID");

def MPIURL = "http://" + mockHost + ":7783/MockMPIResp";

FileUtils.CreateOrUpdateConnection("internalConnectionInfo.xml", destConfigFileLocation, localHCID, "adaptercomponentmpiservice", MPIURL, "LEVEL_a0", context, log)</script></con:config></con:testStep><con:testStep name="modify uddiConnectionInfo" type="groovy"><con:settings/><con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context );

def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];
def NHINGatewayHost = context.findProperty("NHINGatewayHost");
def mockHost = context.findProperty("MockHost");
def PDURL = "https://" + mockHost + ":8181/Gateway/PatientDiscovery/1_0/NhinService/NhinPatientDiscovery";

FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "1.1", "PatientDiscovery", PDURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "2.2", "PatientDiscovery", PDURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "3.3", "PatientDiscovery", PDURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "4.4", "PatientDiscovery", PDURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "5.5", "PatientDiscovery", PDURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "6.6", "PatientDiscovery", PDURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "7.7", "PatientDiscovery", PDURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "8.8", "PatientDiscovery", PDURL, "2.0", context, log)</script></con:config></con:testStep><con:testStep name="Patient Discovery" type="request">
        <con:settings/>
        <con:config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:RequestStep">
          <con:interface>EntityPatientDiscoveryBindingSoap</con:interface>
          <con:operation>RespondingGateway_PRPA_IN201305UV02</con:operation>
          <con:request name="Patient Discovery">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/&gt;</con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>${#Project#Endpoint-PatientDiscovery}</con:endpoint>
            <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:hl7-org:v3" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:add="http://schemas.xmlsoap.org/ws/2004/08/addressing">
   <soapenv:Header/>
   <soapenv:Body projectName="EndToEndSelfTest" testCase="Patient Discovery">
      <urn:RespondingGateway_PRPA_IN201305UV02Request>
         <urn:PRPA_IN201305UV02 ITSVersion="XML_1.0">
            <urn:id root="1.1" extension="-5a3e95b1:11d1fa33d45:-7f9b"/>
            <urn:creationTime value="20091116084800"/>
            <urn:interactionId root="2.16.840.1.113883.1.6" extension="PRPA_IN201305UV02"/>
            <urn:processingCode code="T"/>
            <urn:processingModeCode code="T"/>
            <urn:acceptAckCode code="AL"/>
            <urn:receiver typeCode="RCV">
               <urn:device classCode="DEV" determinerCode="INSTANCE">
                  <urn:id root="1.2.345.678.999"/>
                  <urn:asAgent classCode="AGNT">
                     <urn:representedOrganization classCode="ORG" determinerCode="INSTANCE">
                        <urn:id root="${#Project#RemoteHCID}"/>
                     </urn:representedOrganization>
                  </urn:asAgent>
               </urn:device>
            </urn:receiver>
            <urn:sender typeCode="SND">
               <urn:device classCode="DEV" determinerCode="INSTANCE">
                  <urn:id root="1.2.345.678.999"/>
                  <urn:asAgent classCode="AGNT">
                     <urn:representedOrganization classCode="ORG" determinerCode="INSTANCE">
                        <urn:id root="${#Project#LocalHCID}"/>
                     </urn:representedOrganization>
                  </urn:asAgent>
               </urn:device>
            </urn:sender>
            <urn:controlActProcess classCode="CACT" moodCode="EVN">
               <code code="PRPA_TE201305UV02" codeSystem="2.16.840.1.113883.1.6"/>
               <urn:authorOrPerformer typeCode="AUT">
                  <urn:assignedDevice>
                     <urn:id root="${#Project#LocalAA}"/>
                  </urn:assignedDevice>
               </urn:authorOrPerformer>
               <urn:queryByParameter>
                  <urn:queryId root="${#Project#LocalHCID}" extension="-abd3453dcd24wkkks545"/>
                  <urn:statusCode code="new"/>
                  <urn:responseModalityCode code="R"/>
                  <urn:responsePriorityCode code="I"/>
                  <urn:parameterList>
                     <urn:livingSubjectAdministrativeGender>
                        <urn:value code="${#Project#Gender}"/>
                        <urn:semanticsText representation="TXT">LivingSubject.administrativeGender</urn:semanticsText>
                     </urn:livingSubjectAdministrativeGender>
                     <urn:livingSubjectBirthTime>
                        <urn:value value="${#Project#BirthTime}"/>
                        <urn:semanticsText representation="TXT">LivingSubject.birthTime</urn:semanticsText>
                     </urn:livingSubjectBirthTime>
                     <urn:livingSubjectName>
                        <urn:value>
                           <urn:family partType="FAM">${#Project#FamilyName}</urn:family>
                           <urn:given partType="GIV">${#Project#GivenName}</urn:given>
                        </urn:value>
                        <urn:semanticsText representation="TXT">LivingSubject.name</urn:semanticsText>
                     </urn:livingSubjectName>
                     <urn:livingSubjectId>
                        <urn:value root="${#Project#LocalAA}" extension="${#Project#SubjectID}"/>
                        <urn:semanticsText representation="TXT"/>
                     </urn:livingSubjectId>
                  </urn:parameterList>
               </urn:queryByParameter>
            </urn:controlActProcess>
         </urn:PRPA_IN201305UV02>
         <urn:assertion>
            <urn1:address>
               <urn1:addressType>
                  <urn1:code>W</urn1:code>
               </urn1:addressType>
               <urn1:city>${#Project#City}</urn1:city>
               <urn1:country>${#Project#Country}</urn1:country>
               <urn1:state>${#Project#State}</urn1:state>
               <urn1:streetAddress>${#Project#StreetAddress}</urn1:streetAddress>
               <urn1:zipCode>${#Project#ZipCode}</urn1:zipCode>
            </urn1:address>
            <urn1:dateOfBirth>${#Project#DOB}</urn1:dateOfBirth>
            <urn1:dateOfSignature>${#Project#DateOfSignature}</urn1:dateOfSignature>
            <urn1:expirationDate>${#Project#ExpirationDate}</urn1:expirationDate>
            <urn1:explanationNonClaimantSignature>NEEDED</urn1:explanationNonClaimantSignature>
            <urn1:haveSecondWitnessSignature>true</urn1:haveSecondWitnessSignature>
            <urn1:haveSignature>true</urn1:haveSignature>
            <urn1:haveWitnessSignature>true</urn1:haveWitnessSignature>
            <urn1:homeCommunity>
               <urn1:description>${#Project#LocalHCDescription}</urn1:description>
               <urn1:homeCommunityId>${#Project#LocalHCID}</urn1:homeCommunityId>
               <urn1:name>${#Project#LocalHCDescription}</urn1:name>
            </urn1:homeCommunity>
            <urn1:personName>
               <urn1:familyName>${#Project#FamilyName}</urn1:familyName>
               <urn1:givenName>${#Project#GivenName}</urn1:givenName>
               <urn1:nameType>
                  <urn1:code>G</urn1:code>
               </urn1:nameType>
               <urn1:secondNameOrInitials>FJ</urn1:secondNameOrInitials>
               <urn1:fullName>Joe Smith</urn1:fullName>
               <urn1:prefix>Mr</urn1:prefix>
            </urn1:personName>
            <urn1:phoneNumber>
               <urn1:areaCode>123</urn1:areaCode>
               <urn1:countryCode>1</urn1:countryCode>
               <urn1:extension>1234</urn1:extension>
               <urn1:localNumber>3456789</urn1:localNumber>
               <urn1:phoneNumberType>
                  <urn1:code>W</urn1:code>
               </urn1:phoneNumberType>
            </urn1:phoneNumber>
            <urn1:purposeOfDisclosure>${#Project#PurposeOfDisclosure}</urn1:purposeOfDisclosure>
            <urn1:secondWitnessAddress>
               <urn1:addressType>
                  <urn1:code>W</urn1:code>
               </urn1:addressType>
               <urn1:city>Melbourne</urn1:city>
               <urn1:country>US</urn1:country>
               <urn1:state>FL</urn1:state>
               <urn1:streetAddress>123 Johnson Rd</urn1:streetAddress>
               <urn1:zipCode>12345</urn1:zipCode>
            </urn1:secondWitnessAddress>
            <urn1:secondWitnessName>
               <urn1:familyName>Hughes</urn1:familyName>
               <urn1:givenName>Howie</urn1:givenName>
               <urn1:nameType>
                  <urn1:code>G</urn1:code>
               </urn1:nameType>
               <urn1:secondNameOrInitials>HH</urn1:secondNameOrInitials>
               <urn1:fullName>Howie Hughes</urn1:fullName>
               <urn1:prefix>Dr</urn1:prefix>
            </urn1:secondWitnessName>
            <urn1:secondWitnessPhone>
               <urn1:areaCode>123</urn1:areaCode>
               <urn1:countryCode>1</urn1:countryCode>
               <urn1:extension>1546</urn1:extension>
               <urn1:localNumber>4567892</urn1:localNumber>
               <urn1:phoneNumberType>
                  <urn1:code>W</urn1:code>
               </urn1:phoneNumberType>
            </urn1:secondWitnessPhone>
            <urn1:SSN>${#Project#SSN}</urn1:SSN>
            <urn1:uniquePatientId>${#Project#UniquePatientId}</urn1:uniquePatientId>
            <urn1:witnessAddress>
               <urn1:addressType>
                  <urn1:code>W</urn1:code>
               </urn1:addressType>
               <urn1:city>Frankfort</urn1:city>
               <urn1:country>US</urn1:country>
               <urn1:state>MN</urn1:state>
               <urn1:streetAddress>432 Jackson St</urn1:streetAddress>
               <urn1:zipCode>65498</urn1:zipCode>
            </urn1:witnessAddress>
            <urn1:witnessName>
               <urn1:familyName>Ugble</urn1:familyName>
               <urn1:givenName>Gary</urn1:givenName>
               <urn1:nameType>
                  <urn1:code>G</urn1:code>
               </urn1:nameType>
               <urn1:secondNameOrInitials>GU</urn1:secondNameOrInitials>
               <urn1:fullName>Gary Ugble</urn1:fullName>
               <urn1:prefix>Mr</urn1:prefix>
            </urn1:witnessName>
            <urn1:witnessPhone>
               <urn1:areaCode>987</urn1:areaCode>
               <urn1:countryCode>1</urn1:countryCode>
               <urn1:extension>6549</urn1:extension>
               <urn1:localNumber>2222222</urn1:localNumber>
               <urn1:phoneNumberType>
                  <urn1:code>H</urn1:code>
               </urn1:phoneNumberType>
            </urn1:witnessPhone>
            <urn1:userInfo>
               <urn1:personName>
                  <urn1:familyName>Anderson</urn1:familyName>
                  <urn1:givenName>Wilma</urn1:givenName>
                  <urn1:nameType>
                     <urn1:code>G</urn1:code>
                  </urn1:nameType>
                  <urn1:secondNameOrInitials>WA</urn1:secondNameOrInitials>
                  <urn1:fullName>Wilma Anderson</urn1:fullName>
                  <urn1:prefix>Mrs</urn1:prefix>
               </urn1:personName>
               <urn1:userName>wanderson</urn1:userName>
               <urn1:role>nurse</urn1:role>
               <urn1:org>
                  <urn1:description>${#Project#LocalHCDescription}</urn1:description>
                  <urn1:homeCommunityId>${#Project#LocalHCID}</urn1:homeCommunityId>
                  <urn1:name>${#Project#LocalHCDescription}</urn1:name>
               </urn1:org>
               <urn1:roleCoded>
                  <urn1:code>307969004</urn1:code>
                  <urn1:codeSystem>2.16.840.1.113883.6.96</urn1:codeSystem>
                  <urn1:codeSystemName>SNOMED_CT</urn1:codeSystemName>
                  <urn1:codeSystemVersion>1.0</urn1:codeSystemVersion>
                  <urn1:displayName>Public Health</urn1:displayName>
                  <urn1:originalText>Public Health</urn1:originalText>
               </urn1:roleCoded>
            </urn1:userInfo>
            <urn1:authorized>true</urn1:authorized>
            <urn1:purposeOfDisclosureCoded>
               <urn1:code>PUBLICHEALTH</urn1:code>
               <urn1:codeSystem>2.16.840.1.113883.3.18.7.1</urn1:codeSystem>
               <urn1:codeSystemName>nhin-purpose</urn1:codeSystemName>
               <urn1:codeSystemVersion>1.0</urn1:codeSystemVersion>
               <urn1:displayName>Use or disclosure of Psychotherapy Notes</urn1:displayName>
               <urn1:originalText>Use or disclosure of Psychotherapy Notes</urn1:originalText>
            </urn1:purposeOfDisclosureCoded>
            <urn1:samlAuthnStatement>
               <urn1:authInstant>2009-04-16T13:15:39Z</urn1:authInstant>
               <urn1:sessionIndex>987</urn1:sessionIndex>
               <urn1:authContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:X509</urn1:authContextClassRef>
               <urn1:subjectLocalityAddress>158.147.185.168</urn1:subjectLocalityAddress>
               <urn1:subjectLocalityDNSName>cs.myharris.net</urn1:subjectLocalityDNSName>
            </urn1:samlAuthnStatement>
            <urn1:samlAuthzDecisionStatement>
               <urn1:decision>Permit</urn1:decision>
               <urn1:resource>https://158.147.185.168:8181/SamlReceiveService/SamlProcessWS</urn1:resource>
               <urn1:action>TestSaml</urn1:action>
               <urn1:evidence>
                  <urn1:assertion>
                     <urn1:id>40df7c0a-ff3e-4b26-baeb-f2910f6d05a9</urn1:id>
                     <urn1:issueInstant>2009-04-16T13:10:39.093Z</urn1:issueInstant>
                     <urn1:version>2.0</urn1:version>
                     <urn1:issuerFormat>urn:oasis:names:tc:SAML:1.1:nameid-format:X509SubjectName</urn1:issuerFormat>
                     <urn1:issuer>CN=SAML User,OU=Harris,O=HITS,L=Melbourne,ST=FL,C=US</urn1:issuer>
                     <urn1:conditions>
                        <urn1:notBefore>2009-04-16T13:10:39.093Z</urn1:notBefore>
                        <urn1:notOnOrAfter>2009-12-31T12:00:00.000Z</urn1:notOnOrAfter>
                     </urn1:conditions>
                     <urn1:accessConsentPolicy>Claim-Ref-1234</urn1:accessConsentPolicy>
                     <urn1:instanceAccessConsentPolicy>Claim-Instance-1</urn1:instanceAccessConsentPolicy>
                  </urn1:assertion>
               </urn1:evidence>
            </urn1:samlAuthzDecisionStatement>
         </urn:assertion>
<!--        <urn:NhinTargetCommunities>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
               <urn1:description>${#Project#RemoteHCDescription}</urn1:description>
               <urn1:homeCommunityId>${#Project#RemoteHCID}</urn1:homeCommunityId>
               <urn1:name>${#Project#RemoteHCDescription}</urn1:name>
               </urn1:homeCommunity>
            </urn1:nhinTargetCommunity> 
         </urn:NhinTargetCommunities> -->
      </urn:RespondingGateway_PRPA_IN201305UV02Request>
      <urn:PIXConsumer_PRPA_IN201305UVRequest/>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
            <con:assertion type="SOAP Response"/>
            <con:assertion disabled="true" type="Schema Compliance">
              <con:configuration/>
            </con:assertion>
            <con:assertion type="SOAP Fault Assertion"/>
            <con:assertion name="Check for existance of [ns3:controlActProcess]" type="XPath Match">
              <con:configuration>
                <path>declare namespace ns3='urn:hl7-org:v3';
exists( //ns3:PRPA_IN201306UV02/ns3:controlActProcess)</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
              </con:configuration>
            </con:assertion>
            <con:assertion name="Given Name XPath Match" type="XPath Match">
              <con:configuration>
                <path>declare namespace ns1='urn:hl7-org:v3';
//ns1:PRPA_IN201306UV02[1]/ns1:controlActProcess[1]/ns1:subject[1]/ns1:registrationEvent[1]/ns1:subject1[1]/ns1:patient[1]/ns1:patientPerson[1]/ns1:name[1]/ns1:given[1]</path>
                <content>${#Project#GivenName}</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
              </con:configuration>
            </con:assertion>
            <con:assertion name="Family Name XPath Match" type="XPath Match">
              <con:configuration>
                <path>declare namespace ns1='urn:hl7-org:v3';
//ns1:PRPA_IN201306UV02[1]/ns1:controlActProcess[1]/ns1:subject[1]/ns1:registrationEvent[1]/ns1:subject1[1]/ns1:patient[1]/ns1:patientPerson[1]/ns1:name[1]/ns1:family[1]</path>
                <content>${#Project#FamilyName}</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
              </con:configuration>
            </con:assertion>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep><con:testStep name="count correlations" type="groovy">
        <con:settings/>
        <con:config><script>context.withSql('PatientCorrelationDB') { sql -&gt; 
  assert 0 &lt; sql.firstRow('select count(*) from ' + context.findProperty('PatientCorrelationTable'))[0]
}</script></con:config>
      </con:testStep><con:setupScript>import nhinc.FileUtils;
testCase.getTestSuite().getProject().getMockServiceByName("mockMPI_happy_path").start();

def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];

FileUtils.changeSpringConfig("AdapterMpiProxyConfig.xml", "wsunsecured", log);
FileUtils.changeSpringConfig("AdapterComponentMpiProxyConfig.xml", "wsunsecured", log);

File sourceInternalFile = new File(destConfigFileLocation, "internalConnectionInfo.xml");
File backupInternalFile = new File(destConfigFileLocation, "internalConnectionInfo_BACKUP.xml");

File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(sourceInternalFile, backupInternalFile, log);
MoveFile(sourceUddiFile, backupUddiFile, log);</con:setupScript><con:tearDownScript>import nhinc.FileUtils;
FileUtils.restoreToMasterConfiguration(context, log);

testCase.getTestSuite().getProject().getMockServicFileUtils.changeSpringConfigByName("mockMPI_happy_path").getMockRunner().stop();

FileUtils.changeSpringConfig("AdapterMpiProxyConfig.xml", "default", log);
FileUtils.changeSpringConfig("AdapterComponentMpiProxyConfig.xml", "default", log);

File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(backupInternalFile, sourceInternalFile, log);
MoveFile(backupUddiFile, sourceUddiFile, log);

void DeleteFile(File file, log) {  
   if(file.exists()) {    
      log.info("deleting file " + file);
      file.delete(); 
   } else {
      log.info("file not found, skipping delete for " + file);
   }
}

DeleteFile(backupInternalFile, log);
DeleteFile(backupUddiFile, log);</con:tearDownScript><con:properties>
        <con:property>
          <con:name>startDate</con:name>
          <con:value>2012-08-25T00:56:12Z</con:value>
        </con:property>
        <con:property>
          <con:name>endDate</con:name>
          <con:value>2012-08-25T01:06:12Z</con:value>
        </con:property>
        <con:property>
          <con:name>sigDate</con:name>
          <con:value>08/25/2012 00:56:12</con:value>
        </con:property>
        <con:property>
          <con:name>expireDate</con:name>
          <con:value>2012-09-24T00:00:00Z</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
    </con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" id="78fe48f8-26da-4ea7-a912-93458c56fe57" keepSession="false" maxResults="0" name="PD happy path passthrough" searchProperties="true">
      <con:description/><con:settings/>
      <con:testStep name="Modify gateway.properties" type="groovy">
        <con:settings/>
        <con:config><script>import nhinc.FileUtils;
def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR']

void UpdateProperty(String directory, String filename, String propertyKey, String propertyValue,context,log) {
			  
   log.info("begin UpdateProperty; directory='" + directory + "';filename='" + filename + "';key='" + propertyKey + "';value='" + propertyValue + "';");
   File file = new File(directory,filename)	;
   Properties properties = new Properties();
   FileInputStream frPropFile = new FileInputStream(file);
   properties.load(frPropFile);
   properties.setProperty(propertyKey, propertyValue);
   FileOutputStream fwPropFile = new FileOutputStream(file);
   properties.store(fwPropFile, "**DO NOT CHECK IN** - written by groovy script FileUtils.groovy-&gt;UpdateProperty");
   properties = null;
}

UpdateProperty(destConfigFileLocation,"gateway.properties","patientDiscoveryPassthrough","true",context,log);</script></con:config>
      </con:testStep>
      <con:testStep name="Clear correlations and AA mapping tables" type="groovy">
        <con:settings/>
        <con:config><script>context.withSql('PatientCorrelationDB') { sql -&gt; 
  sql.execute('delete from ' + context.findProperty('PatientCorrelationTable'))
}

context.withSql('AAMappingDB') { sql -&gt; 
  sql.execute('delete from ' + context.findProperty('AAMappingTable'))
}</script></con:config>
      </con:testStep>
      <con:testStep name="copy uddiConnectionInfo" type="groovy">
				<con:settings/>
				<con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
def projectPropPath = groovyUtils.projectPath

def sourceDir = projectPropPath;
def sourceFile = "uddiConnectionInfo_FANOUT.xml";
def destDir = System.env['NHINC_PROPERTIES_DIR'];
def destFile = "uddiConnectionInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.MoveFile(sourceDir, sourceFile, destDir, destFile, context, log);






					</script></con:config>
			</con:testStep>
      <con:testStep name="modify internalConnectionInfo" type="groovy"><con:settings/><con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context );
def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];
def NHINGatewayHost = context.findProperty("NHINGatewayHost");
def mockHost = context.findProperty("mockHost");
def localHCID = context.findProperty("LocalHCID");

def adapPDURL = "http://" + mockHost + ":7785/mockPDAdapter";

FileUtils.CreateOrUpdateConnection("internalConnectionInfo.xml", destConfigFileLocation, localHCID, "adapterpatientdiscovery", adapPDURL, "LEVEL_a0", context, log)
</script></con:config></con:testStep><con:testStep name="modify uddiConnectionInfo" type="groovy"><con:settings/><con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context );

def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];
def NHINGatewayHost = context.findProperty("NHINGatewayHost");
def mockHost = context.findProperty("MockHost");

def PDURL = "https://" + mockHost + ":8181/Gateway/PatientDiscovery/1_0/NhinService/NhinPatientDiscovery";

FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "1.1", "PatientDiscovery", PDURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "2.2", "PatientDiscovery", PDURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "3.3", "PatientDiscovery", PDURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "4.4", "PatientDiscovery", PDURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "5.5", "PatientDiscovery", PDURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "6.6", "PatientDiscovery", PDURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "7.7", "PatientDiscovery", PDURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "8.8", "PatientDiscovery", PDURL, "2.0", context, log)</script></con:config></con:testStep><con:testStep name="Patient Discovery" type="request">
        <con:settings/>
        <con:config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:RequestStep">
          <con:interface>EntityPatientDiscoveryBindingSoap</con:interface>
          <con:operation>RespondingGateway_PRPA_IN201305UV02</con:operation>
          <con:request name="Patient Discovery">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/&gt;</con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>${#Project#Endpoint-PatientDiscovery}</con:endpoint>
            <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:hl7-org:v3" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:add="http://schemas.xmlsoap.org/ws/2004/08/addressing">
   <soapenv:Header/>
   <soapenv:Body projectName="EndToEndSelfTest" testCase="Patient Discovery">
      <urn:RespondingGateway_PRPA_IN201305UV02Request>
         <urn:PRPA_IN201305UV02 ITSVersion="XML_1.0">
            <urn:id root="1.1" extension="-5a3e95b1:11d1fa33d45:-7f9b"/>
            <urn:creationTime value="20091116084800"/>
            <urn:interactionId root="2.16.840.1.113883.1.6" extension="PRPA_IN201305UV02"/>
            <urn:processingCode code="T"/>
            <urn:processingModeCode code="T"/>
            <urn:acceptAckCode code="AL"/>
            <urn:receiver typeCode="RCV">
               <urn:device classCode="DEV" determinerCode="INSTANCE">
                  <urn:id root="1.2.345.678.999"/>
                  <urn:asAgent classCode="AGNT">
                     <urn:representedOrganization classCode="ORG" determinerCode="INSTANCE">
                        <urn:id root="${#Project#RemoteHCID}"/>
                     </urn:representedOrganization>
                  </urn:asAgent>
               </urn:device>
            </urn:receiver>
            <urn:sender typeCode="SND">
               <urn:device classCode="DEV" determinerCode="INSTANCE">
                  <urn:id root="1.2.345.678.999"/>
                  <urn:asAgent classCode="AGNT">
                     <urn:representedOrganization classCode="ORG" determinerCode="INSTANCE">
                        <urn:id root="${#Project#LocalHCID}"/>
                     </urn:representedOrganization>
                  </urn:asAgent>
               </urn:device>
            </urn:sender>
            <urn:controlActProcess classCode="CACT" moodCode="EVN">
               <code code="PRPA_TE201305UV02" codeSystem="2.16.840.1.113883.1.6"/>
               <urn:authorOrPerformer typeCode="AUT">
                  <urn:assignedDevice>
                     <urn:id root="${#Project#LocalAA}"/>
                  </urn:assignedDevice>
               </urn:authorOrPerformer>
               <urn:queryByParameter>
                  <urn:queryId root="${#Project#LocalHCID}" extension="-abd3453dcd24wkkks545"/>
                  <urn:statusCode code="new"/>
                  <urn:responseModalityCode code="R"/>
                  <urn:responsePriorityCode code="I"/>
                  <urn:parameterList>
                     <urn:livingSubjectAdministrativeGender>
                        <urn:value code="${#Project#Gender}"/>
                        <urn:semanticsText representation="TXT">LivingSubject.administrativeGender</urn:semanticsText>
                     </urn:livingSubjectAdministrativeGender>
                     <urn:livingSubjectBirthTime>
                        <urn:value value="${#Project#BirthTime}"/>
                        <urn:semanticsText representation="TXT">LivingSubject.birthTime</urn:semanticsText>
                     </urn:livingSubjectBirthTime>
                     <urn:livingSubjectName>
                        <urn:value>
                           <urn:family partType="FAM">${#Project#FamilyName}</urn:family>
                           <urn:given partType="GIV">${#Project#GivenName}</urn:given>
                        </urn:value>
                        <urn:semanticsText representation="TXT">LivingSubject.name</urn:semanticsText>
                     </urn:livingSubjectName>
                     <urn:livingSubjectId>
                        <urn:value root="${#Project#LocalAA}" extension="${#Project#SubjectID}"/>
                        <urn:semanticsText representation="TXT"/>
                     </urn:livingSubjectId>
                  </urn:parameterList>
               </urn:queryByParameter>
            </urn:controlActProcess>
         </urn:PRPA_IN201305UV02>
         <urn:assertion>
            <urn1:address>
               <urn1:addressType>
                  <urn1:code>W</urn1:code>
               </urn1:addressType>
               <urn1:city>${#Project#City}</urn1:city>
               <urn1:country>${#Project#Country}</urn1:country>
               <urn1:state>${#Project#State}</urn1:state>
               <urn1:streetAddress>${#Project#StreetAddress}</urn1:streetAddress>
               <urn1:zipCode>${#Project#ZipCode}</urn1:zipCode>
            </urn1:address>
            <urn1:dateOfBirth>${#Project#DOB}</urn1:dateOfBirth>
            <urn1:dateOfSignature>${#Project#DateOfSignature}</urn1:dateOfSignature>
            <urn1:expirationDate>${#Project#ExpirationDate}</urn1:expirationDate>
            <urn1:explanationNonClaimantSignature>NEEDED</urn1:explanationNonClaimantSignature>
            <urn1:haveSecondWitnessSignature>true</urn1:haveSecondWitnessSignature>
            <urn1:haveSignature>true</urn1:haveSignature>
            <urn1:haveWitnessSignature>true</urn1:haveWitnessSignature>
            <urn1:homeCommunity>
               <urn1:description>${#Project#LocalHCDescription}</urn1:description>
               <urn1:homeCommunityId>${#Project#LocalHCID}</urn1:homeCommunityId>
               <urn1:name>${#Project#LocalHCDescription}</urn1:name>
            </urn1:homeCommunity>
            <urn1:personName>
               <urn1:familyName>${#Project#FamilyName}</urn1:familyName>
               <urn1:givenName>${#Project#GivenName}</urn1:givenName>
               <urn1:nameType>
                  <urn1:code>G</urn1:code>
               </urn1:nameType>
               <urn1:secondNameOrInitials>FJ</urn1:secondNameOrInitials>
               <urn1:fullName>Joe Smith</urn1:fullName>
               <urn1:prefix>Mr</urn1:prefix>
            </urn1:personName>
            <urn1:phoneNumber>
               <urn1:areaCode>123</urn1:areaCode>
               <urn1:countryCode>1</urn1:countryCode>
               <urn1:extension>1234</urn1:extension>
               <urn1:localNumber>3456789</urn1:localNumber>
               <urn1:phoneNumberType>
                  <urn1:code>W</urn1:code>
               </urn1:phoneNumberType>
            </urn1:phoneNumber>
            <urn1:purposeOfDisclosure>${#Project#PurposeOfDisclosure}</urn1:purposeOfDisclosure>
            <urn1:secondWitnessAddress>
               <urn1:addressType>
                  <urn1:code>W</urn1:code>
               </urn1:addressType>
               <urn1:city>Melbourne</urn1:city>
               <urn1:country>US</urn1:country>
               <urn1:state>FL</urn1:state>
               <urn1:streetAddress>123 Johnson Rd</urn1:streetAddress>
               <urn1:zipCode>12345</urn1:zipCode>
            </urn1:secondWitnessAddress>
            <urn1:secondWitnessName>
               <urn1:familyName>Hughes</urn1:familyName>
               <urn1:givenName>Howie</urn1:givenName>
               <urn1:nameType>
                  <urn1:code>G</urn1:code>
               </urn1:nameType>
               <urn1:secondNameOrInitials>HH</urn1:secondNameOrInitials>
               <urn1:fullName>Howie Hughes</urn1:fullName>
               <urn1:prefix>Dr</urn1:prefix>
            </urn1:secondWitnessName>
            <urn1:secondWitnessPhone>
               <urn1:areaCode>123</urn1:areaCode>
               <urn1:countryCode>1</urn1:countryCode>
               <urn1:extension>1546</urn1:extension>
               <urn1:localNumber>4567892</urn1:localNumber>
               <urn1:phoneNumberType>
                  <urn1:code>W</urn1:code>
               </urn1:phoneNumberType>
            </urn1:secondWitnessPhone>
            <urn1:SSN>${#Project#SSN}</urn1:SSN>
            <urn1:uniquePatientId>${#Project#UniquePatientId}</urn1:uniquePatientId>
            <urn1:witnessAddress>
               <urn1:addressType>
                  <urn1:code>W</urn1:code>
               </urn1:addressType>
               <urn1:city>Frankfort</urn1:city>
               <urn1:country>US</urn1:country>
               <urn1:state>MN</urn1:state>
               <urn1:streetAddress>432 Jackson St</urn1:streetAddress>
               <urn1:zipCode>65498</urn1:zipCode>
            </urn1:witnessAddress>
            <urn1:witnessName>
               <urn1:familyName>Ugble</urn1:familyName>
               <urn1:givenName>Gary</urn1:givenName>
               <urn1:nameType>
                  <urn1:code>G</urn1:code>
               </urn1:nameType>
               <urn1:secondNameOrInitials>GU</urn1:secondNameOrInitials>
               <urn1:fullName>Gary Ugble</urn1:fullName>
               <urn1:prefix>Mr</urn1:prefix>
            </urn1:witnessName>
            <urn1:witnessPhone>
               <urn1:areaCode>987</urn1:areaCode>
               <urn1:countryCode>1</urn1:countryCode>
               <urn1:extension>6549</urn1:extension>
               <urn1:localNumber>2222222</urn1:localNumber>
               <urn1:phoneNumberType>
                  <urn1:code>H</urn1:code>
               </urn1:phoneNumberType>
            </urn1:witnessPhone>
            <urn1:userInfo>
               <urn1:personName>
                  <urn1:familyName>Anderson</urn1:familyName>
                  <urn1:givenName>Wilma</urn1:givenName>
                  <urn1:nameType>
                     <urn1:code>G</urn1:code>
                  </urn1:nameType>
                  <urn1:secondNameOrInitials>WA</urn1:secondNameOrInitials>
                  <urn1:fullName>Wilma Anderson</urn1:fullName>
                  <urn1:prefix>Mrs</urn1:prefix>
               </urn1:personName>
               <urn1:userName>wanderson</urn1:userName>
               <urn1:role>nurse</urn1:role>
               <urn1:org>
                  <urn1:description>${#Project#LocalHCDescription}</urn1:description>
                  <urn1:homeCommunityId>${#Project#LocalHCID}</urn1:homeCommunityId>
                  <urn1:name>${#Project#LocalHCDescription}</urn1:name>
               </urn1:org>
               <urn1:roleCoded>
                  <urn1:code>307969004</urn1:code>
                  <urn1:codeSystem>2.16.840.1.113883.6.96</urn1:codeSystem>
                  <urn1:codeSystemName>SNOMED_CT</urn1:codeSystemName>
                  <urn1:codeSystemVersion>1.0</urn1:codeSystemVersion>
                  <urn1:displayName>Public Health</urn1:displayName>
                  <urn1:originalText>Public Health</urn1:originalText>
               </urn1:roleCoded>
            </urn1:userInfo>
            <urn1:authorized>true</urn1:authorized>
            <urn1:purposeOfDisclosureCoded>
               <urn1:code>PUBLICHEALTH</urn1:code>
               <urn1:codeSystem>2.16.840.1.113883.3.18.7.1</urn1:codeSystem>
               <urn1:codeSystemName>nhin-purpose</urn1:codeSystemName>
               <urn1:codeSystemVersion>1.0</urn1:codeSystemVersion>
               <urn1:displayName>Use or disclosure of Psychotherapy Notes</urn1:displayName>
               <urn1:originalText>Use or disclosure of Psychotherapy Notes</urn1:originalText>
            </urn1:purposeOfDisclosureCoded>
            <urn1:samlAuthnStatement>
               <urn1:authInstant>2009-04-16T13:15:39Z</urn1:authInstant>
               <urn1:sessionIndex>987</urn1:sessionIndex>
               <urn1:authContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:X509</urn1:authContextClassRef>
               <urn1:subjectLocalityAddress>158.147.185.168</urn1:subjectLocalityAddress>
               <urn1:subjectLocalityDNSName>cs.myharris.net</urn1:subjectLocalityDNSName>
            </urn1:samlAuthnStatement>
            <urn1:samlAuthzDecisionStatement>
               <urn1:decision>Permit</urn1:decision>
               <urn1:resource>https://158.147.185.168:8181/SamlReceiveService/SamlProcessWS</urn1:resource>
               <urn1:action>TestSaml</urn1:action>
               <urn1:evidence>
                  <urn1:assertion>
                     <urn1:id>40df7c0a-ff3e-4b26-baeb-f2910f6d05a9</urn1:id>
                     <urn1:issueInstant>2009-04-16T13:10:39.093Z</urn1:issueInstant>
                     <urn1:version>2.0</urn1:version>
                     <urn1:issuerFormat>urn:oasis:names:tc:SAML:1.1:nameid-format:X509SubjectName</urn1:issuerFormat>
                     <urn1:issuer>CN=SAML User,OU=Harris,O=HITS,L=Melbourne,ST=FL,C=US</urn1:issuer>
                     <urn1:conditions>
                        <urn1:notBefore>2009-04-16T13:10:39.093Z</urn1:notBefore>
                        <urn1:notOnOrAfter>2009-12-31T12:00:00.000Z</urn1:notOnOrAfter>
                     </urn1:conditions>
                     <urn1:accessConsentPolicy>Claim-Ref-1234</urn1:accessConsentPolicy>
                     <urn1:instanceAccessConsentPolicy>Claim-Instance-1</urn1:instanceAccessConsentPolicy>
                  </urn1:assertion>
               </urn1:evidence>
            </urn1:samlAuthzDecisionStatement>
         </urn:assertion>
<!--       <urn:NhinTargetCommunities>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
               <urn1:description>${#Project#RemoteHCDescription}</urn1:description>
               <urn1:homeCommunityId>${#Project#RemoteHCID}</urn1:homeCommunityId>
               <urn1:name>${#Project#RemoteHCDescription}</urn1:name>
               </urn1:homeCommunity>
            </urn1:nhinTargetCommunity> 
         </urn:NhinTargetCommunities> -->
      </urn:RespondingGateway_PRPA_IN201305UV02Request>
      <urn:PIXConsumer_PRPA_IN201305UVRequest/>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
            <con:assertion type="SOAP Response"/>
            <con:assertion disabled="true" type="Schema Compliance">
              <con:configuration/>
            </con:assertion>
            <con:assertion type="SOAP Fault Assertion"/>
            <con:assertion name="Check for existance of [ns3:controlActProcess]" type="XPath Match">
              <con:configuration>
                <path>declare namespace ns3='urn:hl7-org:v3';
exists( //ns3:PRPA_IN201306UV02/ns3:controlActProcess)</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
              </con:configuration>
            </con:assertion>
            <con:assertion name="Given Name XPath Match" type="XPath Match">
              <con:configuration>
                <path>declare namespace ns1='urn:hl7-org:v3';
//ns1:PRPA_IN201306UV02[1]/ns1:controlActProcess[1]/ns1:subject[1]/ns1:registrationEvent[1]/ns1:subject1[1]/ns1:patient[1]/ns1:patientPerson[1]/ns1:name[1]/ns1:given[1]</path>
                <content>${#Project#GivenName}</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
              </con:configuration>
            </con:assertion>
            <con:assertion name="Family Name XPath Match" type="XPath Match">
              <con:configuration>
                <path>declare namespace ns1='urn:hl7-org:v3';
//ns1:PRPA_IN201306UV02[1]/ns1:controlActProcess[1]/ns1:subject[1]/ns1:registrationEvent[1]/ns1:subject1[1]/ns1:patient[1]/ns1:patientPerson[1]/ns1:name[1]/ns1:family[1]</path>
                <content>${#Project#FamilyName}</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
              </con:configuration>
            </con:assertion>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep><con:testStep name="count correlations" type="groovy">
        <con:settings/>
        <con:config><script>context.withSql('PatientCorrelationDB') { sql -&gt; 
  assert 8 == sql.firstRow('select count(*) from ' + context.findProperty('PatientCorrelationTable'))[0]
}</script></con:config>
      </con:testStep><con:setupScript>import nhinc.FileUtils;
testCase.getTestSuite().getProject().getMockServiceByName("mockPD_adapter").start();
FileUtils.changeSpringConfig("AdapterPatientDiscoveryProxyConfig.xml", "wsunsecured", log);

def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];

File sourceInternalFile = new File(destConfigFileLocation, "internalConnectionInfo.xml");
File backupInternalFile = new File(destConfigFileLocation, "internalConnectionInfo_BACKUP.xml");

File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(sourceInternalFile, backupInternalFile, log);
MoveFile(sourceUddiFile, backupUddiFile, log);</con:setupScript><con:tearDownScript>import nhinc.FileUtils;
FileUtils.restoreToMasterConfiguration(context, log);
testCase.getTestSuite().getProject().getMockServiceByName("mockPD_adapter").getMockRunner().stop();
//FileUtils.changeSpringConfig("AdapterPatientDiscoveryProxyConfig.xml", "default", log);


File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(backupInternalFile, sourceInternalFile, log);
MoveFile(backupUddiFile, sourceUddiFile, log);

void DeleteFile(File file, log) {  
   if(file.exists()) {    
      log.info("deleting file " + file);
      file.delete(); 
   } else {
      log.info("file not found, skipping delete for " + file);
   }
}

DeleteFile(backupInternalFile, log);
DeleteFile(backupUddiFile, log);</con:tearDownScript><con:properties>
        <con:property>
          <con:name>startDate</con:name>
          <con:value>2012-08-25T02:01:37Z</con:value>
        </con:property>
        <con:property>
          <con:name>endDate</con:name>
          <con:value>2012-08-25T02:11:37Z</con:value>
        </con:property>
        <con:property>
          <con:name>sigDate</con:name>
          <con:value>08/25/2012 02:01:37</con:value>
        </con:property>
        <con:property>
          <con:name>expireDate</con:name>
          <con:value>2012-09-24T00:00:00Z</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
    </con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" id="a7aa2352-3074-4eba-8a33-9cba17ebb7da" keepSession="false" maxResults="0" name="PD all" searchProperties="true">
      <con:description/><con:settings/>
      <con:testStep name="Clear correlations and AA mapping tables" type="groovy">
        <con:settings/>
        <con:config><script>context.withSql('PatientCorrelationDB') { sql -&gt; 
  sql.execute('delete from ' + context.findProperty('PatientCorrelationTable'))
}

context.withSql('AAMappingDB') { sql -&gt; 
  sql.execute('delete from ' + context.findProperty('AAMappingTable'))
}</script></con:config>
      </con:testStep>
      <con:testStep name="copy uddiConnectionInfo" type="groovy">
				<con:settings/>
				<con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
def projectPropPath = groovyUtils.projectPath

def sourceDir = projectPropPath;
def sourceFile = "uddiConnectionInfo_FANOUT.xml";
def destDir = System.env['NHINC_PROPERTIES_DIR'];
def destFile = "uddiConnectionInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.MoveFile(sourceDir, sourceFile, destDir, destFile, context, log);






					</script></con:config>
			</con:testStep>
      <con:testStep name="modify internalConnectionInfo" type="groovy"><con:settings/><con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context );
def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];
def NHINGatewayHost = context.findProperty("NHINGatewayHost");
def mockHost = context.findProperty("mockHost");
def localHCID = context.findProperty("LocalHCID");

def MPIURL = "http://" + mockHost + ":7781/MockMPIResp";

FileUtils.CreateOrUpdateConnection("internalConnectionInfo.xml", destConfigFileLocation, localHCID, "adaptercomponentmpiservice", MPIURL, "LEVEL_a0", context, log)</script></con:config></con:testStep>
      <con:testStep name="modify uddiConnectionInfo" type="groovy"><con:settings/><con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context );

def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];
def NHINGatewayHost = context.findProperty("NHINGatewayHost");
def mockHost = context.findProperty("MockHost");
def PDURL = "https://" + mockHost + ":8181/Gateway/PatientDiscovery/1_0/NhinService/NhinPatientDiscovery";
def badURL = "http://" + mockHost + ":8989/badURL";

FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "1.1", "PatientDiscovery", PDURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "2.2", "PatientDiscovery", PDURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "3.3", "PatientDiscovery", PDURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "4.4", "PatientDiscovery", PDURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "5.5", "PatientDiscovery", PDURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "6.6", "PatientDiscovery", PDURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "7.7", "PatientDiscovery", PDURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "7.7", "PatientDiscovery", badURL, "2.0", context, log)</script></con:config></con:testStep><con:testStep name="Patient Discovery" type="request">
        <con:settings/>
        <con:config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:RequestStep">
          <con:interface>EntityPatientDiscoveryBindingSoap</con:interface>
          <con:operation>RespondingGateway_PRPA_IN201305UV02</con:operation>
          <con:request name="Patient Discovery">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/&gt;</con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>${#Project#Endpoint-PatientDiscovery}</con:endpoint>
            <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:hl7-org:v3" xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:add="http://schemas.xmlsoap.org/ws/2004/08/addressing">
   <soapenv:Header/>
   <soapenv:Body projectName="EndToEndSelfTest" testCase="Patient Discovery">
      <urn:RespondingGateway_PRPA_IN201305UV02Request>
         <urn:PRPA_IN201305UV02 ITSVersion="XML_1.0">
            <urn:id root="1.1" extension="-5a3e95b1:11d1fa33d45:-7f9b"/>
            <urn:creationTime value="20091116084800"/>
            <urn:interactionId root="2.16.840.1.113883.1.6" extension="PRPA_IN201305UV02"/>
            <urn:processingCode code="T"/>
            <urn:processingModeCode code="T"/>
            <urn:acceptAckCode code="AL"/>
            <urn:receiver typeCode="RCV">
               <urn:device classCode="DEV" determinerCode="INSTANCE">
                  <urn:id root="1.2.345.678.999"/>
                  <urn:asAgent classCode="AGNT">
                     <urn:representedOrganization classCode="ORG" determinerCode="INSTANCE">
                        <urn:id root="${#Project#RemoteHCID}"/>
                     </urn:representedOrganization>
                  </urn:asAgent>
               </urn:device>
            </urn:receiver>
            <urn:sender typeCode="SND">
               <urn:device classCode="DEV" determinerCode="INSTANCE">
                  <urn:id root="1.2.345.678.999"/>
                  <urn:asAgent classCode="AGNT">
                     <urn:representedOrganization classCode="ORG" determinerCode="INSTANCE">
                        <urn:id root="${#Project#LocalHCID}"/>
                     </urn:representedOrganization>
                  </urn:asAgent>
               </urn:device>
            </urn:sender>
            <urn:controlActProcess classCode="CACT" moodCode="EVN">
               <code code="PRPA_TE201305UV02" codeSystem="2.16.840.1.113883.1.6"/>
               <urn:authorOrPerformer typeCode="AUT">
                  <urn:assignedDevice>
                     <urn:id root="${#Project#LocalAA}"/>
                  </urn:assignedDevice>
               </urn:authorOrPerformer>
               <urn:queryByParameter>
                  <urn:queryId root="${#Project#LocalHCID}" extension="-abd3453dcd24wkkks545"/>
                  <urn:statusCode code="new"/>
                  <urn:responseModalityCode code="R"/>
                  <urn:responsePriorityCode code="I"/>
                  <urn:parameterList>
                     <urn:livingSubjectAdministrativeGender>
                        <urn:value code="${#Project#Gender}"/>
                        <urn:semanticsText representation="TXT">LivingSubject.administrativeGender</urn:semanticsText>
                     </urn:livingSubjectAdministrativeGender>
                     <urn:livingSubjectBirthTime>
                        <urn:value value="${#Project#BirthTime}"/>
                        <urn:semanticsText representation="TXT">LivingSubject.birthTime</urn:semanticsText>
                     </urn:livingSubjectBirthTime>
                     <urn:livingSubjectName>
                        <urn:value>
                           <urn:family partType="FAM">${#Project#FamilyName}</urn:family>
                           <urn:given partType="GIV">${#Project#GivenName}</urn:given>
                        </urn:value>
                        <urn:semanticsText representation="TXT">LivingSubject.name</urn:semanticsText>
                     </urn:livingSubjectName>
                     <urn:livingSubjectId>
                        <urn:value root="${#Project#LocalAA}" extension="${#Project#SubjectID}"/>
                        <urn:semanticsText representation="TXT"/>
                     </urn:livingSubjectId>
                  </urn:parameterList>
               </urn:queryByParameter>
            </urn:controlActProcess>
         </urn:PRPA_IN201305UV02>
         <urn:assertion>
            <urn1:address>
               <urn1:addressType>
                  <urn1:code>W</urn1:code>
               </urn1:addressType>
               <urn1:city>${#Project#City}</urn1:city>
               <urn1:country>${#Project#Country}</urn1:country>
               <urn1:state>${#Project#State}</urn1:state>
               <urn1:streetAddress>${#Project#StreetAddress}</urn1:streetAddress>
               <urn1:zipCode>${#Project#ZipCode}</urn1:zipCode>
            </urn1:address>
            <urn1:dateOfBirth>${#Project#DOB}</urn1:dateOfBirth>
            <urn1:dateOfSignature>${#Project#DateOfSignature}</urn1:dateOfSignature>
            <urn1:expirationDate>${#Project#ExpirationDate}</urn1:expirationDate>
            <urn1:explanationNonClaimantSignature>NEEDED</urn1:explanationNonClaimantSignature>
            <urn1:haveSecondWitnessSignature>true</urn1:haveSecondWitnessSignature>
            <urn1:haveSignature>true</urn1:haveSignature>
            <urn1:haveWitnessSignature>true</urn1:haveWitnessSignature>
            <urn1:homeCommunity>
               <urn1:description>${#Project#LocalHCDescription}</urn1:description>
               <urn1:homeCommunityId>${#Project#LocalHCID}</urn1:homeCommunityId>
               <urn1:name>${#Project#LocalHCDescription}</urn1:name>
            </urn1:homeCommunity>
            <urn1:personName>
               <urn1:familyName>${#Project#FamilyName}</urn1:familyName>
               <urn1:givenName>${#Project#GivenName}</urn1:givenName>
               <urn1:nameType>
                  <urn1:code>G</urn1:code>
               </urn1:nameType>
               <urn1:secondNameOrInitials>FJ</urn1:secondNameOrInitials>
               <urn1:fullName>Joe Smith</urn1:fullName>
               <urn1:prefix>Mr</urn1:prefix>
            </urn1:personName>
            <urn1:phoneNumber>
               <urn1:areaCode>123</urn1:areaCode>
               <urn1:countryCode>1</urn1:countryCode>
               <urn1:extension>1234</urn1:extension>
               <urn1:localNumber>3456789</urn1:localNumber>
               <urn1:phoneNumberType>
                  <urn1:code>W</urn1:code>
               </urn1:phoneNumberType>
            </urn1:phoneNumber>
            <urn1:purposeOfDisclosure>${#Project#PurposeOfDisclosure}</urn1:purposeOfDisclosure>
            <urn1:secondWitnessAddress>
               <urn1:addressType>
                  <urn1:code>W</urn1:code>
               </urn1:addressType>
               <urn1:city>Melbourne</urn1:city>
               <urn1:country>US</urn1:country>
               <urn1:state>FL</urn1:state>
               <urn1:streetAddress>123 Johnson Rd</urn1:streetAddress>
               <urn1:zipCode>12345</urn1:zipCode>
            </urn1:secondWitnessAddress>
            <urn1:secondWitnessName>
               <urn1:familyName>Hughes</urn1:familyName>
               <urn1:givenName>Howie</urn1:givenName>
               <urn1:nameType>
                  <urn1:code>G</urn1:code>
               </urn1:nameType>
               <urn1:secondNameOrInitials>HH</urn1:secondNameOrInitials>
               <urn1:fullName>Howie Hughes</urn1:fullName>
               <urn1:prefix>Dr</urn1:prefix>
            </urn1:secondWitnessName>
            <urn1:secondWitnessPhone>
               <urn1:areaCode>123</urn1:areaCode>
               <urn1:countryCode>1</urn1:countryCode>
               <urn1:extension>1546</urn1:extension>
               <urn1:localNumber>4567892</urn1:localNumber>
               <urn1:phoneNumberType>
                  <urn1:code>W</urn1:code>
               </urn1:phoneNumberType>
            </urn1:secondWitnessPhone>
            <urn1:SSN>${#Project#SSN}</urn1:SSN>
            <urn1:uniquePatientId>${#Project#UniquePatientId}</urn1:uniquePatientId>
            <urn1:witnessAddress>
               <urn1:addressType>
                  <urn1:code>W</urn1:code>
               </urn1:addressType>
               <urn1:city>Frankfort</urn1:city>
               <urn1:country>US</urn1:country>
               <urn1:state>MN</urn1:state>
               <urn1:streetAddress>432 Jackson St</urn1:streetAddress>
               <urn1:zipCode>65498</urn1:zipCode>
            </urn1:witnessAddress>
            <urn1:witnessName>
               <urn1:familyName>Ugble</urn1:familyName>
               <urn1:givenName>Gary</urn1:givenName>
               <urn1:nameType>
                  <urn1:code>G</urn1:code>
               </urn1:nameType>
               <urn1:secondNameOrInitials>GU</urn1:secondNameOrInitials>
               <urn1:fullName>Gary Ugble</urn1:fullName>
               <urn1:prefix>Mr</urn1:prefix>
            </urn1:witnessName>
            <urn1:witnessPhone>
               <urn1:areaCode>987</urn1:areaCode>
               <urn1:countryCode>1</urn1:countryCode>
               <urn1:extension>6549</urn1:extension>
               <urn1:localNumber>2222222</urn1:localNumber>
               <urn1:phoneNumberType>
                  <urn1:code>H</urn1:code>
               </urn1:phoneNumberType>
            </urn1:witnessPhone>
            <urn1:userInfo>
               <urn1:personName>
                  <urn1:familyName>Anderson</urn1:familyName>
                  <urn1:givenName>Wilma</urn1:givenName>
                  <urn1:nameType>
                     <urn1:code>G</urn1:code>
                  </urn1:nameType>
                  <urn1:secondNameOrInitials>WA</urn1:secondNameOrInitials>
                  <urn1:fullName>Wilma Anderson</urn1:fullName>
                  <urn1:prefix>Mrs</urn1:prefix>
               </urn1:personName>
               <urn1:userName>wanderson</urn1:userName>
               <urn1:role>nurse</urn1:role>
               <urn1:org>
                  <urn1:description>${#Project#LocalHCDescription}</urn1:description>
                  <urn1:homeCommunityId>${#Project#LocalHCID}</urn1:homeCommunityId>
                  <urn1:name>${#Project#LocalHCDescription}</urn1:name>
               </urn1:org>
               <urn1:roleCoded>
                  <urn1:code>307969004</urn1:code>
                  <urn1:codeSystem>2.16.840.1.113883.6.96</urn1:codeSystem>
                  <urn1:codeSystemName>SNOMED_CT</urn1:codeSystemName>
                  <urn1:codeSystemVersion>1.0</urn1:codeSystemVersion>
                  <urn1:displayName>Public Health</urn1:displayName>
                  <urn1:originalText>Public Health</urn1:originalText>
               </urn1:roleCoded>
            </urn1:userInfo>
            <urn1:authorized>true</urn1:authorized>
            <urn1:purposeOfDisclosureCoded>
               <urn1:code>PUBLICHEALTH</urn1:code>
               <urn1:codeSystem>2.16.840.1.113883.3.18.7.1</urn1:codeSystem>
               <urn1:codeSystemName>nhin-purpose</urn1:codeSystemName>
               <urn1:codeSystemVersion>1.0</urn1:codeSystemVersion>
               <urn1:displayName>Use or disclosure of Psychotherapy Notes</urn1:displayName>
               <urn1:originalText>Use or disclosure of Psychotherapy Notes</urn1:originalText>
            </urn1:purposeOfDisclosureCoded>
            <urn1:samlAuthnStatement>
               <urn1:authInstant>2009-04-16T13:15:39Z</urn1:authInstant>
               <urn1:sessionIndex>987</urn1:sessionIndex>
               <urn1:authContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:X509</urn1:authContextClassRef>
               <urn1:subjectLocalityAddress>158.147.185.168</urn1:subjectLocalityAddress>
               <urn1:subjectLocalityDNSName>cs.myharris.net</urn1:subjectLocalityDNSName>
            </urn1:samlAuthnStatement>
            <urn1:samlAuthzDecisionStatement>
               <urn1:decision>Permit</urn1:decision>
               <urn1:resource>https://158.147.185.168:8181/SamlReceiveService/SamlProcessWS</urn1:resource>
               <urn1:action>TestSaml</urn1:action>
               <urn1:evidence>
                  <urn1:assertion>
                     <urn1:id>40df7c0a-ff3e-4b26-baeb-f2910f6d05a9</urn1:id>
                     <urn1:issueInstant>2009-04-16T13:10:39.093Z</urn1:issueInstant>
                     <urn1:version>2.0</urn1:version>
                     <urn1:issuerFormat>urn:oasis:names:tc:SAML:1.1:nameid-format:X509SubjectName</urn1:issuerFormat>
                     <urn1:issuer>CN=SAML User,OU=Harris,O=HITS,L=Melbourne,ST=FL,C=US</urn1:issuer>
                     <urn1:conditions>
                        <urn1:notBefore>2009-04-16T13:10:39.093Z</urn1:notBefore>
                        <urn1:notOnOrAfter>2009-12-31T12:00:00.000Z</urn1:notOnOrAfter>
                     </urn1:conditions>
                     <urn1:accessConsentPolicy>Claim-Ref-1234</urn1:accessConsentPolicy>
                     <urn1:instanceAccessConsentPolicy>Claim-Instance-1</urn1:instanceAccessConsentPolicy>
                  </urn1:assertion>
               </urn1:evidence>
            </urn1:samlAuthzDecisionStatement>
         </urn:assertion>
<!--         <urn:NhinTargetCommunities>
            <urn1:nhinTargetCommunity>
               <urn1:homeCommunity>
               <urn1:description>${#Project#RemoteHCDescription}</urn1:description>
               <urn1:homeCommunityId>${#Project#RemoteHCID}</urn1:homeCommunityId>
               <urn1:name>${#Project#RemoteHCDescription}</urn1:name>
               </urn1:homeCommunity>
            </urn1:nhinTargetCommunity> 
         </urn:NhinTargetCommunities> -->
      </urn:RespondingGateway_PRPA_IN201305UV02Request>
      <urn:PIXConsumer_PRPA_IN201305UVRequest/>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
            <con:assertion type="SOAP Response"/>
            <con:assertion disabled="true" type="Schema Compliance">
              <con:configuration/>
            </con:assertion>
            <con:assertion type="SOAP Fault Assertion"/>
            <con:assertion name="Check for existance of [ns3:controlActProcess]" type="XPath Match">
              <con:configuration>
                <path>declare namespace ns3='urn:hl7-org:v3';
exists( //ns3:PRPA_IN201306UV02/ns3:controlActProcess)</path>
                <content>true</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
              </con:configuration>
            </con:assertion>
            <con:assertion name="Given Name XPath Match" type="XPath Match">
              <con:configuration>
                <path>declare namespace ns1='urn:hl7-org:v3';
//ns1:PRPA_IN201306UV02[1]/ns1:controlActProcess[1]/ns1:subject[1]/ns1:registrationEvent[1]/ns1:subject1[1]/ns1:patient[1]/ns1:patientPerson[1]/ns1:name[1]/ns1:given[1]</path>
                <content>${#Project#GivenName}</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
              </con:configuration>
            </con:assertion>
            <con:assertion name="Family Name XPath Match" type="XPath Match">
              <con:configuration>
                <path>declare namespace ns1='urn:hl7-org:v3';
//ns1:PRPA_IN201306UV02[1]/ns1:controlActProcess[1]/ns1:subject[1]/ns1:registrationEvent[1]/ns1:subject1[1]/ns1:patient[1]/ns1:patientPerson[1]/ns1:name[1]/ns1:family[1]</path>
                <content>${#Project#FamilyName}</content>
                <allowWildcards>false</allowWildcards>
                <ignoreNamspaceDifferences>false</ignoreNamspaceDifferences>
              </con:configuration>
            </con:assertion>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep><con:testStep name="count correlations" type="groovy">
        <con:settings/>
        <con:config><script>context.withSql('PatientCorrelationDB') { sql -&gt; 
  assert 6 == sql.firstRow('select count(*) from ' + context.findProperty('PatientCorrelationTable'))[0]
}</script></con:config>
      </con:testStep><con:setupScript>import nhinc.FileUtils;
testCase.getTestSuite().getProject().getMockServiceByName("mockMPI_all").start();
FileUtils.changeSpringConfig("AdapterMpiProxyConfig.xml", "wsunsecured", log);
FileUtils.changeSpringConfig("AdapterComponentMpiProxyConfig.xml", "wsunsecured", log);

def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];

File sourceInternalFile = new File(destConfigFileLocation, "internalConnectionInfo.xml");
File backupInternalFile = new File(destConfigFileLocation, "internalConnectionInfo_BACKUP.xml");

File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(sourceInternalFile, backupInternalFile, log);
MoveFile(sourceUddiFile, backupUddiFile, log);</con:setupScript><con:tearDownScript>import nhinc.FileUtils;
FileUtils.restoreToMasterConfiguration(context, log);
testCase.getTestSuite().getProject().getMockServiceByName("mockMPI_all").getMockRunner().stop();
FileUtils.changetSpringConfig("AdapterMpiProxyConfig.xml", "default", log);
FileUtils.changeSpringConfig("AdapterComponentMpiProxyConfig.xml", "default", log);


File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(backupInternalFile, sourceInternalFile, log);
MoveFile(backupUddiFile, sourceUddiFile, log);

void DeleteFile(File file, log) {  
   if(file.exists()) {    
      log.info("deleting file " + file);
      file.delete(); 
   } else {
      log.info("file not found, skipping delete for " + file);
   }
}

DeleteFile(backupInternalFile, log);
DeleteFile(backupUddiFile, log);</con:tearDownScript><con:properties>
        <con:property>
          <con:name>startDate</con:name>
          <con:value>2012-08-25T01:07:50Z</con:value>
        </con:property>
        <con:property>
          <con:name>endDate</con:name>
          <con:value>2012-08-25T01:17:50Z</con:value>
        </con:property>
        <con:property>
          <con:name>sigDate</con:name>
          <con:value>08/25/2012 01:07:50</con:value>
        </con:property>
        <con:property>
          <con:name>expireDate</con:name>
          <con:value>2012-09-24T00:00:00Z</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
    </con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" id="fab1796e-3ef1-4637-94de-12293f6ce045" keepSession="false" maxResults="0" name="DQ warmup" searchProperties="true">
      <con:settings/>
      
      <con:testStep name="Modify gateway.properties" type="groovy">
        <con:settings/>
        <con:config>
          <script>//def destConfigFileLocation = context.findProperty("NHINGatewayConfigDir");

def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR']

void UpdateProperty(String directory, String filename, String propertyKey, String propertyValue,context,log) {
			  
   log.info("begin UpdateProperty; directory='" + directory + "';filename='" + filename + "';key='" + propertyKey + "';value='" + propertyValue + "';");
   File file = new File(directory,filename);
   Properties properties = new Properties();
   FileInputStream frPropFile = new FileInputStream(file);
   properties.load(frPropFile);
   properties.setProperty(propertyKey, propertyValue);
   FileOutputStream fwPropFile = new FileOutputStream(file);
   properties.store(fwPropFile, "**DO NOT CHECK IN** - written by groovy script FileUtils.groovy-&gt;UpdateProperty");
   properties = null;
}

UpdateProperty(destConfigFileLocation,"gateway.properties","documentQueryQuerySelf","false",context,log);</script>
        </con:config>
      </con:testStep>
      
      <con:testStep name="Clear Correlation Table &amp; Add Correlation" type="groovy">
        <con:settings/>
        <con:config><script>context.withSql('PatientCorrelationDB') { sql -&gt; 
  def table = context.findProperty('PatientCorrelationTable')
  
  sql.execute('delete from ' + table)

  def localAA = context.findProperty( "LocalAA" )
  def localPatientID = context.findProperty("LocalPatientID")
  def remoteAA = context.findProperty( "RemoteAA" )
  def remotePatientID = context.findProperty("RemotePatientID")
  def insertSql = "insert into " + table + " (PatientAssigningAuthorityId, PatientId, CorrelatedPatientAssignAuthId, CorrelatedPatientId) " + 
                   "values (?, ?, ?, ?)"
  sql.executeUpdate(insertSql, [remoteAA, remotePatientID, localAA, localPatientID])
}</script></con:config>
      </con:testStep><con:testStep name="Clear AA Mapping Table &amp; Add Mapping" type="groovy">
        <con:settings/>
        <con:config><script>context.withSql('AAMappingDB') { sql -&gt; 
  def table = context.findProperty('AAMappingTable')
  
  sql.execute('delete from ' + table)

  def remoteAA = context.findProperty( "RemoteAA" )
  def remoteHCID = context.findProperty("RemoteHCID")
  def insertSql = "insert into " + table + " (assigningauthorityid, homecommunityid) " + 
                   "values (?, ?)"
  sql.executeUpdate(insertSql, [remoteAA, remoteHCID])
}</script></con:config>
      </con:testStep><con:testStep name="Document Query" type="request">
        <con:settings/>
        <con:config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:RequestStep">
          <con:interface>EntityDocQueryBindingSoap</con:interface>
          <con:operation>RespondingGateway_CrossGatewayQuery</con:operation>
          <con:request name="Document Query">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/&gt;</con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>${#Project#Endpoint-DocQuery}</con:endpoint>
            <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:nhinccommonentity" xmlns:urn1="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0" xmlns:urn2="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0" xmlns:urn3="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soapenv:Header/>
   <soapenv:Body projectName="EndToEndSelfTest" testCase="Document Query">
      <urn:RespondingGateway_CrossGatewayQueryRequest>
         <urn1:AdhocQueryRequest federated="false" startIndex="0" maxResults="-1">
            <urn1:ResponseOption returnType="LeafClass" returnComposedObjects="false"/>
            <urn2:AdhocQuery home="urn:oid:1.1" id="urn:uuid:14d4debf-8f97-4251-9a74-a90016b0af0d">
               <urn2:Slot name="$XDSDocumentEntryPatientId">
                  <urn2:ValueList>
                     <urn2:Value>'${#Project#DQPatientID}^^^&amp;${#Project#LocalAA}&amp;ISO'</urn2:Value>
                  </urn2:ValueList>
               </urn2:Slot>
               <urn2:Slot name="$XDSDocumentEntryStatus">
                  <urn2:ValueList>
                     <urn2:Value>('urn:oasis:names:tc:ebxml-regrep:StatusType:Approved')</urn2:Value>
                  </urn2:ValueList>
               </urn2:Slot>
            </urn2:AdhocQuery>
         </urn1:AdhocQueryRequest>
         <urn:assertion>
            <urn3:address xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:addressType>
                  <urn3:code>AddrCode</urn3:code>
                  <urn3:codeSystem>AddrCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>AddrCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>AddrCode</urn3:displayName>
                  <urn3:originalText>AddrCode</urn3:originalText>
               </urn3:addressType>
               <urn3:city>AddrCity</urn3:city>
               <urn3:country>AddrCountry</urn3:country>
               <urn3:state>AddrState</urn3:state>
               <urn3:streetAddress>AddrStreet</urn3:streetAddress>
               <urn3:zipCode>AddrZip</urn3:zipCode>
            </urn3:address>
            <urn3:dateOfBirth xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">06/04/1959 05:21:00</urn3:dateOfBirth>
            <urn3:dateOfSignature xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">${#Project#sigDate}</urn3:dateOfSignature>
            <urn3:expirationDate xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">${#Project#expireDate}</urn3:expirationDate>
            <urn3:explanationNonClaimantSignature xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">Electronic</urn3:explanationNonClaimantSignature>
            <urn3:haveSecondWitnessSignature xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">false</urn3:haveSecondWitnessSignature>
            <urn3:haveSignature xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">false</urn3:haveSignature>
            <urn3:haveWitnessSignature xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">false</urn3:haveWitnessSignature>
            <urn3:homeCommunity xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:description>${#Project#LocalHCDescription}</urn3:description>
               <urn3:homeCommunityId>${#Project#LocalHCID}</urn3:homeCommunityId>
               <urn3:name>${#Project#LocalHCDescription}</urn3:name>
            </urn3:homeCommunity>
            <urn3:personName xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:familyName>Smith</urn3:familyName>
               <urn3:givenName>Sandy</urn3:givenName>
               <urn3:nameType>
                  <urn3:code>nameCode</urn3:code>
                  <urn3:codeSystem>nameCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>nameCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>nameCode</urn3:displayName>
                  <urn3:originalText>nameCode</urn3:originalText>
               </urn3:nameType>
               <urn3:secondNameOrInitials>S</urn3:secondNameOrInitials>
               <urn3:fullName>Sandy S. Smith</urn3:fullName>
            </urn3:personName>
            <urn3:phoneNumber xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:areaCode>321</urn3:areaCode>
               <urn3:countryCode>1</urn3:countryCode>
               <urn3:extension>5436</urn3:extension>
               <urn3:localNumber>253-6849</urn3:localNumber>
               <urn3:phoneNumberType>
                  <urn3:code>phoneCode</urn3:code>
                  <urn3:codeSystem>phoneCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>phoneCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>phoneCode</urn3:displayName>
                  <urn3:originalText>phoneCode</urn3:originalText>
               </urn3:phoneNumberType>
            </urn3:phoneNumber>
            <urn3:purposeOfDisclosure xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">TREATMENT</urn3:purposeOfDisclosure>
            <urn3:secondWitnessAddress xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:addressType>
                  <urn3:code>AddrCode</urn3:code>
                  <urn3:codeSystem>AddrCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>AddrCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>AddrCode</urn3:displayName>
                  <urn3:originalText>AddrCode</urn3:originalText>
               </urn3:addressType>
               <urn3:city>Addr2City</urn3:city>
               <urn3:country>Addr2Country</urn3:country>
               <urn3:state>Addr2State</urn3:state>
               <urn3:streetAddress>Addr2Street</urn3:streetAddress>
               <urn3:zipCode>Addr2Zip</urn3:zipCode>
            </urn3:secondWitnessAddress>
            <urn3:secondWitnessName xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:familyName>Smith</urn3:familyName>
               <urn3:givenName>Sammy</urn3:givenName>
               <urn3:nameType>
                  <urn3:code>nameCode</urn3:code>
                  <urn3:codeSystem>nameCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>nameCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>nameCode</urn3:displayName>
                  <urn3:originalText>nameCode</urn3:originalText>
               </urn3:nameType>
               <urn3:secondNameOrInitials>s</urn3:secondNameOrInitials>
               <urn3:fullName>Sammy S. Smith</urn3:fullName>
            </urn3:secondWitnessName>
            <urn3:secondWitnessPhone xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:areaCode>321</urn3:areaCode>
               <urn3:countryCode>1</urn3:countryCode>
               <urn3:extension>5424</urn3:extension>
               <urn3:localNumber>542-6823</urn3:localNumber>
               <urn3:phoneNumberType>
                  <urn3:code>phoneCode</urn3:code>
                  <urn3:codeSystem>phoneCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>phoneCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>phoneCode</urn3:displayName>
                  <urn3:originalText>phoneCode</urn3:originalText>
               </urn3:phoneNumberType>
            </urn3:secondWitnessPhone>
            <urn3:SSN xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">253-98-7546</urn3:SSN>
            <urn3:uniquePatientId xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">500000000^^^&amp;1.1&amp;ISO</urn3:uniquePatientId>
            <urn3:witnessAddress xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:addressType>
                  <urn3:code>addrCode</urn3:code>
                  <urn3:codeSystem>addrCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>addrCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>addrCode</urn3:displayName>
                  <urn3:originalText>addrCode</urn3:originalText>
               </urn3:addressType>
               <urn3:city>Burnell</urn3:city>
               <urn3:country>USA</urn3:country>
               <urn3:state>FL</urn3:state>
               <urn3:streetAddress>825 North</urn3:streetAddress>
               <urn3:zipCode>32184</urn3:zipCode>
            </urn3:witnessAddress>
            <urn3:witnessName xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:familyName>Smith</urn3:familyName>
               <urn3:givenName>Scott</urn3:givenName>
               <urn3:nameType>
                  <urn3:code>nameCode</urn3:code>
                  <urn3:codeSystem>nameCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>nameCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>nameCode</urn3:displayName>
                  <urn3:originalText>nameCode</urn3:originalText>
               </urn3:nameType>
               <urn3:secondNameOrInitials>S.</urn3:secondNameOrInitials>
               <urn3:fullName>Scott S. Smith</urn3:fullName>
            </urn3:witnessName>
            <urn3:witnessPhone xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:areaCode>321</urn3:areaCode>
               <urn3:countryCode>1</urn3:countryCode>
               <urn3:extension>8432</urn3:extension>
               <urn3:localNumber>985-2239</urn3:localNumber>
               <urn3:phoneNumberType>
                  <urn3:code>phoneCode</urn3:code>
                  <urn3:codeSystem>phoneCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>phoneCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>phoneCode</urn3:displayName>
                  <urn3:originalText>phoneCode</urn3:originalText>
               </urn3:phoneNumberType>
            </urn3:witnessPhone>
            <urn3:userInfo xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:personName>
                  <urn3:familyName>Skagerberg</urn3:familyName>
                  <urn3:givenName>Karl</urn3:givenName>
                  <urn3:nameType>
                     <urn3:code>nameCode</urn3:code>
                     <urn3:codeSystem>nameCodeSyst</urn3:codeSystem>
                     <urn3:codeSystemName>nameCodeSystName</urn3:codeSystemName>
                     <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                     <urn3:displayName>nameCode</urn3:displayName>
                     <urn3:originalText>nameCode</urn3:originalText>
                  </urn3:nameType>
                  <urn3:secondNameOrInitials>S</urn3:secondNameOrInitials>
                  <urn3:fullName>Kasrl S. Skagerberg</urn3:fullName>
               </urn3:personName>
               <urn3:userName>kskagerb</urn3:userName>
               <urn3:role>Pharmacy</urn3:role>
               <urn3:org>
                  <urn3:description>${#Project#LocalHCDescription}</urn3:description>
                  <urn3:homeCommunityId>${#Project#LocalHCID}</urn3:homeCommunityId>
                  <urn3:name>${#Project#LocalHCDescription}</urn3:name>
               </urn3:org>
               <urn3:roleCoded>
                  <urn3:code>307969004</urn3:code>
                  <urn3:codeSystem>2.16.840.1.113883.6.96</urn3:codeSystem>
                  <urn3:codeSystemName>SNOMED_CT</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>Public Health</urn3:displayName>
                  <urn3:originalText>Public Health</urn3:originalText>
               </urn3:roleCoded>
            </urn3:userInfo>
            <urn3:authorized xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">true</urn3:authorized>
            <urn3:purposeOfDisclosureCoded xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:code>PUBLICHEALTH</urn3:code>
               <urn3:codeSystem>2.16.840.1.113883.3.18.7.1</urn3:codeSystem>
               <urn3:codeSystemName>nhin-purpose</urn3:codeSystemName>
               <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
               <urn3:displayName>Use or disclosure of Psychotherapy Notes</urn3:displayName>
               <urn3:originalText>Use or disclosure of Psychotherapy Notes</urn3:originalText>
            </urn3:purposeOfDisclosureCoded>
            <urn3:claimFormRef>Ref-Clm-123</urn3:claimFormRef>
            <urn3:claimFormRaw>YWVvbGlhbQ==</urn3:claimFormRaw>
            <urn3:samlAuthnStatement xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:authInstant>2009-04-16T13:15:39Z</urn3:authInstant>
               <urn3:sessionIndex>987</urn3:sessionIndex>
               <urn3:authContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:X509</urn3:authContextClassRef>
               <urn3:subjectLocalityAddress>158.147.185.168</urn3:subjectLocalityAddress>
               <urn3:subjectLocalityDNSName>cs.myharris.net</urn3:subjectLocalityDNSName>
            </urn3:samlAuthnStatement>
         <!--   <urn3:samlAuthzDecisionStatement xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:decision>Permit</urn3:decision>
               <urn3:resource>https://158.147.185.168:8181/SamlReceiveService/SamlProcessWS</urn3:resource>
               <urn3:action>TestSaml</urn3:action>
               <urn3:evidence>
                  <urn3:assertion>
                     <urn3:id>40df7c0a-ff3e-4b26-baeb-f2910f6d05a9</urn3:id>
                     <urn3:issueInstant>2009-04-16T13:10:39.093Z</urn3:issueInstant>
                     <urn3:version>2.0</urn3:version>
                     <urn3:issuerFormat>urn:oasis:names:tc:SAML:1.1:nameid-format:X509SubjectName</urn3:issuerFormat>
                     <urn3:issuer>CN=SAML User,OU=Harris,O=HITS,L=Melbourne,ST=FL,C=US</urn3:issuer>
                     <urn3:conditions>
                        <urn3:notBefore>2009-04-16T13:10:39.093Z</urn3:notBefore>
                        <urn3:notOnOrAfter>2009-12-31T12:00:00.000Z</urn3:notOnOrAfter>
                     </urn3:conditions>
                     <urn3:accessConsentPolicy>urn:oid:1.2.3.4</urn3:accessConsentPolicy>
                     <urn3:instanceAccessConsentPolicy>urn:oid:1.2.3.4.123456789</urn3:instanceAccessConsentPolicy>
                  </urn3:assertion>
               </urn3:evidence>
            </urn3:samlAuthzDecisionStatement> -->
         </urn:assertion>
         <urn:NhinTargetCommunities>
            <urn3:nhinTargetCommunity>
               <urn3:homeCommunity>
                  <urn3:description>${#Project#RemoteHCDescription}</urn3:description>
                  <urn3:homeCommunityId>${#Project#RemoteHCID}</urn3:homeCommunityId>
                  <urn3:name>${#Project#RemoteHCDescription}</urn3:name>
               </urn3:homeCommunity>
            </urn3:nhinTargetCommunity>
         </urn:NhinTargetCommunities>
      </urn:RespondingGateway_CrossGatewayQueryRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
            <con:assertion type="SOAP Response"/>
            <con:assertion disabled="true" type="Schema Compliance">
              <con:configuration/>
            </con:assertion>
            <con:assertion type="SOAP Fault Assertion"/>
            <con:assertion name="DocID Match" type="GroovyScriptAssertion">
              <con:configuration>
                <scriptText>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context );
def holder = groovyUtils.getXmlHolder( messageExchange.responseContent );
holder.namespaces["ns1"] = "urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0";
holder.namespaces["ns3"] = "urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0";

def documentID = context.findProperty('DQDocID')
def msgDocID = holder["//ns1:AdhocQueryResponse[1]/ns3:RegistryObjectList[1]/ns3:ExtrinsicObject[1]/ns3:ExternalIdentifier[@identificationScheme='urn:uuid:2e82c1f6-a085-4c72-9da3-8640a32e42ab']/@value"];
assert (documentID == msgDocID)</scriptText>
              </con:configuration>
            </con:assertion>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep><con:setupScript/><con:tearDownScript>import nhinc.FileUtils;
FileUtils.restoreToMasterConfiguration(context, log);</con:tearDownScript><con:properties>
        <con:property>
          <con:name>startDate</con:name>
          <con:value>2012-08-25T00:56:29Z</con:value>
        </con:property>
        <con:property>
          <con:name>endDate</con:name>
          <con:value>2012-08-25T01:06:29Z</con:value>
        </con:property>
        <con:property>
          <con:name>sigDate</con:name>
          <con:value>08/25/2012 00:56:29</con:value>
        </con:property>
        <con:property>
          <con:name>expireDate</con:name>
          <con:value>2012-09-24T00:00:00Z</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
    </con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" id="94648f94-2016-416c-a170-156933a4b82e" keepSession="false" maxResults="0" name="DQ no mock" searchProperties="true">
      <con:settings/>
      
      <con:testStep name="Modify gateway.properties" type="groovy">
        <con:settings/>
        <con:config>
          <script>//def destConfigFileLocation = context.findProperty("NHINGatewayConfigDir");

def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR']

void UpdateProperty(String directory, String filename, String propertyKey, String propertyValue,context,log) {
			  
   log.info("begin UpdateProperty; directory='" + directory + "';filename='" + filename + "';key='" + propertyKey + "';value='" + propertyValue + "';");
   File file = new File(directory,filename);
   Properties properties = new Properties();
   FileInputStream frPropFile = new FileInputStream(file);
   properties.load(frPropFile);
   properties.setProperty(propertyKey, propertyValue);
   FileOutputStream fwPropFile = new FileOutputStream(file);
   properties.store(fwPropFile, "**DO NOT CHECK IN** - written by groovy script FileUtils.groovy-&gt;UpdateProperty");
   properties = null;
}

UpdateProperty(destConfigFileLocation,"gateway.properties","documentQueryQuerySelf","false",context,log);</script>
        </con:config>
      </con:testStep>
      
      <con:testStep name="Clear Correlation Table &amp; Add Correlation" type="groovy">
        <con:settings/>
        <con:config><script>context.withSql('PatientCorrelationDB') { sql -&gt; 
  def table = context.findProperty('PatientCorrelationTable')
  
  sql.execute('delete from ' + table)

  def localAA = context.findProperty( "LocalAA" )
  def localPatientID = context.findProperty("LocalPatientID")
  def remoteAA = context.findProperty( "RemoteAA" )
  def remotePatientID = context.findProperty("RemotePatientID")
  def insertSql = "insert into " + table + " (PatientAssigningAuthorityId, PatientId, CorrelatedPatientAssignAuthId, CorrelatedPatientId) " + 
                   "values (?, ?, ?, ?)"
//  sql.executeUpdate(insertSql, [remoteAA, remotePatientID, localAA, localPatientID])
  sql.executeUpdate(insertSql, ["2.2", remotePatientID, localAA, localPatientID])
  sql.executeUpdate(insertSql, ["3.3", remotePatientID, localAA, localPatientID])
  sql.executeUpdate(insertSql, ["4.4", remotePatientID, localAA, localPatientID])
  sql.executeUpdate(insertSql, ["5.5", remotePatientID, localAA, localPatientID])
  sql.executeUpdate(insertSql, ["6.6", remotePatientID, localAA, localPatientID])
  sql.executeUpdate(insertSql, ["7.7", remotePatientID, localAA, localPatientID])
  sql.executeUpdate(insertSql, ["8.8", remotePatientID, localAA, localPatientID])
  sql.executeUpdate(insertSql, [localAA, localPatientID, "2.2", remotePatientID])
  sql.executeUpdate(insertSql, [localAA, localPatientID, "3.3", remotePatientID])
  sql.executeUpdate(insertSql, [localAA, localPatientID, "4.4", remotePatientID])
}</script></con:config>
      </con:testStep><con:testStep name="copy uddiConnectionInfo" type="groovy">
				<con:settings/>
				<con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
def projectPropPath = groovyUtils.projectPath

def sourceDir = projectPropPath;
def sourceFile = "uddiConnectionInfo_FANOUT.xml";
def destDir = System.env['NHINC_PROPERTIES_DIR'];
def destFile = "uddiConnectionInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.MoveFile(sourceDir, sourceFile, destDir, destFile, context, log);






					</script></con:config>
			</con:testStep><con:testStep name="Clear AA Mapping Table &amp; Add Mapping" type="groovy">
        <con:settings/>
        <con:config><script>context.withSql('AAMappingDB') { sql -&gt; 
  def table = context.findProperty('AAMappingTable')
  
  sql.execute('delete from ' + table)

  def remoteAA = context.findProperty( "RemoteAA" )
  def remoteHCID = context.findProperty("RemoteHCID")
  def insertSql = "insert into " + table + " (assigningauthorityid, homecommunityid) " + 
                   "values (?, ?)"
//  sql.executeUpdate(insertSql, [remoteAA, remoteHCID])
  sql.executeUpdate(insertSql, ["2.2", "2.2"])
  sql.executeUpdate(insertSql, ["3.3", "3.3"])
  sql.executeUpdate(insertSql, ["4.4", "4.4"])
  sql.executeUpdate(insertSql, ["5.5", "5.5"])
  sql.executeUpdate(insertSql, ["6.6", "6.6"])
  sql.executeUpdate(insertSql, ["7.7", "7.7"])
  sql.executeUpdate(insertSql, ["8.8", "8.8"])
}</script></con:config>
      </con:testStep><con:testStep name="modify uddiConnectionInfo" type="groovy"><con:settings/><con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context );
def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];
def mockHost = context.findProperty("mockHost");
def localHCID = context.findProperty("LocalHCID");

def DQURL = "https://" + mockHost + ":8181/Gateway/DocumentQuery/2_0/NhinService/RespondingGateway_Query_Service/DocQuery";

FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "1.1", "QueryForDocuments", DQURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "2.2", "QueryForDocuments", DQURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "3.3", "QueryForDocuments", DQURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "4.4", "QueryForDocuments", DQURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "5.5", "QueryForDocuments", DQURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "6.6", "QueryForDocuments", DQURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "7.7", "QueryForDocuments", DQURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "8.8", "QueryForDocuments", DQURL, "2.0", context, log)</script></con:config></con:testStep><con:testStep name="Document Query fanout" type="request">
        <con:settings/>
        <con:config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:RequestStep">
          <con:interface>EntityDocQueryBindingSoap</con:interface>
          <con:operation>RespondingGateway_CrossGatewayQuery</con:operation>
          <con:request name="Document Query fanout">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/&gt;</con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>${#Project#Endpoint-DocQuery}</con:endpoint>
            <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:nhinccommonentity" xmlns:urn1="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0" xmlns:urn2="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0" xmlns:urn3="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soapenv:Header/>
   <soapenv:Body projectName="EndToEndSelfTest" testCase="Document Query">
      <urn:RespondingGateway_CrossGatewayQueryRequest>
         <urn1:AdhocQueryRequest federated="false" startIndex="0" maxResults="-1">
            <urn1:ResponseOption returnType="LeafClass" returnComposedObjects="false"/>
            <urn2:AdhocQuery home="urn:oid:1.1" id="urn:uuid:14d4debf-8f97-4251-9a74-a90016b0af0d">
               <urn2:Slot name="$XDSDocumentEntryPatientId">
                  <urn2:ValueList>
                     <urn2:Value>'${#Project#DQPatientID}^^^&amp;${#Project#LocalAA}&amp;ISO'</urn2:Value>
                  </urn2:ValueList>
               </urn2:Slot>
               <urn2:Slot name="$XDSDocumentEntryStatus">
                  <urn2:ValueList>
                     <urn2:Value>('urn:oasis:names:tc:ebxml-regrep:StatusType:Approved')</urn2:Value>
                  </urn2:ValueList>
               </urn2:Slot>
            </urn2:AdhocQuery>
         </urn1:AdhocQueryRequest>
         <urn:assertion>
            <urn3:address xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:addressType>
                  <urn3:code>AddrCode</urn3:code>
                  <urn3:codeSystem>AddrCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>AddrCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>AddrCode</urn3:displayName>
                  <urn3:originalText>AddrCode</urn3:originalText>
               </urn3:addressType>
               <urn3:city>AddrCity</urn3:city>
               <urn3:country>AddrCountry</urn3:country>
               <urn3:state>AddrState</urn3:state>
               <urn3:streetAddress>AddrStreet</urn3:streetAddress>
               <urn3:zipCode>AddrZip</urn3:zipCode>
            </urn3:address>
            <urn3:dateOfBirth xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">06/04/1959 05:21:00</urn3:dateOfBirth>
            <urn3:dateOfSignature xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">${#Project#sigDate}</urn3:dateOfSignature>
            <urn3:expirationDate xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">${#Project#expireDate}</urn3:expirationDate>
            <urn3:explanationNonClaimantSignature xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">Electronic</urn3:explanationNonClaimantSignature>
            <urn3:haveSecondWitnessSignature xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">false</urn3:haveSecondWitnessSignature>
            <urn3:haveSignature xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">false</urn3:haveSignature>
            <urn3:haveWitnessSignature xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">false</urn3:haveWitnessSignature>
            <urn3:homeCommunity xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:description>${#Project#LocalHCDescription}</urn3:description>
               <urn3:homeCommunityId>${#Project#LocalHCID}</urn3:homeCommunityId>
               <urn3:name>${#Project#LocalHCDescription}</urn3:name>
            </urn3:homeCommunity>
            <urn3:personName xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:familyName>Smith</urn3:familyName>
               <urn3:givenName>Sandy</urn3:givenName>
               <urn3:nameType>
                  <urn3:code>nameCode</urn3:code>
                  <urn3:codeSystem>nameCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>nameCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>nameCode</urn3:displayName>
                  <urn3:originalText>nameCode</urn3:originalText>
               </urn3:nameType>
               <urn3:secondNameOrInitials>S</urn3:secondNameOrInitials>
               <urn3:fullName>Sandy S. Smith</urn3:fullName>
            </urn3:personName>
            <urn3:phoneNumber xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:areaCode>321</urn3:areaCode>
               <urn3:countryCode>1</urn3:countryCode>
               <urn3:extension>5436</urn3:extension>
               <urn3:localNumber>253-6849</urn3:localNumber>
               <urn3:phoneNumberType>
                  <urn3:code>phoneCode</urn3:code>
                  <urn3:codeSystem>phoneCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>phoneCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>phoneCode</urn3:displayName>
                  <urn3:originalText>phoneCode</urn3:originalText>
               </urn3:phoneNumberType>
            </urn3:phoneNumber>
            <urn3:purposeOfDisclosure xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">TREATMENT</urn3:purposeOfDisclosure>
            <urn3:secondWitnessAddress xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:addressType>
                  <urn3:code>AddrCode</urn3:code>
                  <urn3:codeSystem>AddrCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>AddrCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>AddrCode</urn3:displayName>
                  <urn3:originalText>AddrCode</urn3:originalText>
               </urn3:addressType>
               <urn3:city>Addr2City</urn3:city>
               <urn3:country>Addr2Country</urn3:country>
               <urn3:state>Addr2State</urn3:state>
               <urn3:streetAddress>Addr2Street</urn3:streetAddress>
               <urn3:zipCode>Addr2Zip</urn3:zipCode>
            </urn3:secondWitnessAddress>
            <urn3:secondWitnessName xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:familyName>Smith</urn3:familyName>
               <urn3:givenName>Sammy</urn3:givenName>
               <urn3:nameType>
                  <urn3:code>nameCode</urn3:code>
                  <urn3:codeSystem>nameCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>nameCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>nameCode</urn3:displayName>
                  <urn3:originalText>nameCode</urn3:originalText>
               </urn3:nameType>
               <urn3:secondNameOrInitials>s</urn3:secondNameOrInitials>
               <urn3:fullName>Sammy S. Smith</urn3:fullName>
            </urn3:secondWitnessName>
            <urn3:secondWitnessPhone xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:areaCode>321</urn3:areaCode>
               <urn3:countryCode>1</urn3:countryCode>
               <urn3:extension>5424</urn3:extension>
               <urn3:localNumber>542-6823</urn3:localNumber>
               <urn3:phoneNumberType>
                  <urn3:code>phoneCode</urn3:code>
                  <urn3:codeSystem>phoneCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>phoneCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>phoneCode</urn3:displayName>
                  <urn3:originalText>phoneCode</urn3:originalText>
               </urn3:phoneNumberType>
            </urn3:secondWitnessPhone>
            <urn3:SSN xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">253-98-7546</urn3:SSN>
            <urn3:uniquePatientId xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">500000000^^^&amp;1.1&amp;ISO</urn3:uniquePatientId>
            <urn3:witnessAddress xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:addressType>
                  <urn3:code>addrCode</urn3:code>
                  <urn3:codeSystem>addrCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>addrCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>addrCode</urn3:displayName>
                  <urn3:originalText>addrCode</urn3:originalText>
               </urn3:addressType>
               <urn3:city>Burnell</urn3:city>
               <urn3:country>USA</urn3:country>
               <urn3:state>FL</urn3:state>
               <urn3:streetAddress>825 North</urn3:streetAddress>
               <urn3:zipCode>32184</urn3:zipCode>
            </urn3:witnessAddress>
            <urn3:witnessName xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:familyName>Smith</urn3:familyName>
               <urn3:givenName>Scott</urn3:givenName>
               <urn3:nameType>
                  <urn3:code>nameCode</urn3:code>
                  <urn3:codeSystem>nameCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>nameCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>nameCode</urn3:displayName>
                  <urn3:originalText>nameCode</urn3:originalText>
               </urn3:nameType>
               <urn3:secondNameOrInitials>S.</urn3:secondNameOrInitials>
               <urn3:fullName>Scott S. Smith</urn3:fullName>
            </urn3:witnessName>
            <urn3:witnessPhone xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:areaCode>321</urn3:areaCode>
               <urn3:countryCode>1</urn3:countryCode>
               <urn3:extension>8432</urn3:extension>
               <urn3:localNumber>985-2239</urn3:localNumber>
               <urn3:phoneNumberType>
                  <urn3:code>phoneCode</urn3:code>
                  <urn3:codeSystem>phoneCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>phoneCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>phoneCode</urn3:displayName>
                  <urn3:originalText>phoneCode</urn3:originalText>
               </urn3:phoneNumberType>
            </urn3:witnessPhone>
            <urn3:userInfo xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:personName>
                  <urn3:familyName>Skagerberg</urn3:familyName>
                  <urn3:givenName>Karl</urn3:givenName>
                  <urn3:nameType>
                     <urn3:code>nameCode</urn3:code>
                     <urn3:codeSystem>nameCodeSyst</urn3:codeSystem>
                     <urn3:codeSystemName>nameCodeSystName</urn3:codeSystemName>
                     <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                     <urn3:displayName>nameCode</urn3:displayName>
                     <urn3:originalText>nameCode</urn3:originalText>
                  </urn3:nameType>
                  <urn3:secondNameOrInitials>S</urn3:secondNameOrInitials>
                  <urn3:fullName>Kasrl S. Skagerberg</urn3:fullName>
               </urn3:personName>
               <urn3:userName>kskagerb</urn3:userName>
               <urn3:role>Pharmacy</urn3:role>
               <urn3:org>
                  <urn3:description>${#Project#LocalHCDescription}</urn3:description>
                  <urn3:homeCommunityId>${#Project#LocalHCID}</urn3:homeCommunityId>
                  <urn3:name>${#Project#LocalHCDescription}</urn3:name>
               </urn3:org>
               <urn3:roleCoded>
                  <urn3:code>307969004</urn3:code>
                  <urn3:codeSystem>2.16.840.1.113883.6.96</urn3:codeSystem>
                  <urn3:codeSystemName>SNOMED_CT</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>Public Health</urn3:displayName>
                  <urn3:originalText>Public Health</urn3:originalText>
               </urn3:roleCoded>
            </urn3:userInfo>
            <urn3:authorized xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">true</urn3:authorized>
            <urn3:purposeOfDisclosureCoded xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:code>PUBLICHEALTH</urn3:code>
               <urn3:codeSystem>2.16.840.1.113883.3.18.7.1</urn3:codeSystem>
               <urn3:codeSystemName>nhin-purpose</urn3:codeSystemName>
               <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
               <urn3:displayName>Use or disclosure of Psychotherapy Notes</urn3:displayName>
               <urn3:originalText>Use or disclosure of Psychotherapy Notes</urn3:originalText>
            </urn3:purposeOfDisclosureCoded>
            <urn3:claimFormRef>Ref-Clm-123</urn3:claimFormRef>
            <urn3:claimFormRaw>YWVvbGlhbQ==</urn3:claimFormRaw>
            <urn3:samlAuthnStatement xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:authInstant>2009-04-16T13:15:39Z</urn3:authInstant>
               <urn3:sessionIndex>987</urn3:sessionIndex>
               <urn3:authContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:X509</urn3:authContextClassRef>
               <urn3:subjectLocalityAddress>158.147.185.168</urn3:subjectLocalityAddress>
               <urn3:subjectLocalityDNSName>cs.myharris.net</urn3:subjectLocalityDNSName>
            </urn3:samlAuthnStatement>
         <!--   <urn3:samlAuthzDecisionStatement xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:decision>Permit</urn3:decision>
               <urn3:resource>https://158.147.185.168:8181/SamlReceiveService/SamlProcessWS</urn3:resource>
               <urn3:action>TestSaml</urn3:action>
               <urn3:evidence>
                  <urn3:assertion>
                     <urn3:id>40df7c0a-ff3e-4b26-baeb-f2910f6d05a9</urn3:id>
                     <urn3:issueInstant>2009-04-16T13:10:39.093Z</urn3:issueInstant>
                     <urn3:version>2.0</urn3:version>
                     <urn3:issuerFormat>urn:oasis:names:tc:SAML:1.1:nameid-format:X509SubjectName</urn3:issuerFormat>
                     <urn3:issuer>CN=SAML User,OU=Harris,O=HITS,L=Melbourne,ST=FL,C=US</urn3:issuer>
                     <urn3:conditions>
                        <urn3:notBefore>2009-04-16T13:10:39.093Z</urn3:notBefore>
                        <urn3:notOnOrAfter>2009-12-31T12:00:00.000Z</urn3:notOnOrAfter>
                     </urn3:conditions>
                     <urn3:accessConsentPolicy>urn:oid:1.2.3.4</urn3:accessConsentPolicy>
                     <urn3:instanceAccessConsentPolicy>urn:oid:1.2.3.4.123456789</urn3:instanceAccessConsentPolicy>
                  </urn3:assertion>
               </urn3:evidence>
            </urn3:samlAuthzDecisionStatement> -->
         </urn:assertion>
<!--         <urn:NhinTargetCommunities>
            <urn3:nhinTargetCommunity>
               <urn3:homeCommunity>
                  <urn3:description>${#Project#RemoteHCDescription}</urn3:description>
                  <urn3:homeCommunityId>${#Project#RemoteHCID}</urn3:homeCommunityId>
                  <urn3:name>${#Project#RemoteHCDescription}</urn3:name>
               </urn3:homeCommunity>
            </urn3:nhinTargetCommunity>
         </urn:NhinTargetCommunities> -->
      </urn:RespondingGateway_CrossGatewayQueryRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
            <con:assertion type="SOAP Response"/>
            <con:assertion disabled="true" type="Schema Compliance">
              <con:configuration/>
            </con:assertion>
            <con:assertion type="SOAP Fault Assertion"/>
            
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep><con:setupScript>import nhinc.FileUtils;
def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];

File sourceInternalFile = new File(destConfigFileLocation, "internalConnectionInfo.xml");
File backupInternalFile = new File(destConfigFileLocation, "internalConnectionInfo_BACKUP.xml");

File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(sourceInternalFile, backupInternalFile, log);
MoveFile(sourceUddiFile, backupUddiFile, log);</con:setupScript><con:tearDownScript>import nhinc.FileUtils;
FileUtils.restoreToMasterConfiguration(context, log);


File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(backupInternalFile, sourceInternalFile, log);
MoveFile(backupUddiFile, sourceUddiFile, log);

void DeleteFile(File file, log) {  
   if(file.exists()) {    
      log.info("deleting file " + file);
      file.delete(); 
   } else {
      log.info("file not found, skipping delete for " + file);
   }
}

DeleteFile(backupInternalFile, log);
DeleteFile(backupUddiFile, log);</con:tearDownScript><con:properties>
        <con:property>
          <con:name>startDate</con:name>
          <con:value>2012-08-25T00:56:31Z</con:value>
        </con:property>
        <con:property>
          <con:name>endDate</con:name>
          <con:value>2012-08-25T01:06:31Z</con:value>
        </con:property>
        <con:property>
          <con:name>sigDate</con:name>
          <con:value>08/25/2012 00:56:31</con:value>
        </con:property>
        <con:property>
          <con:name>expireDate</con:name>
          <con:value>2012-09-24T00:00:00Z</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
    </con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" id="e988f772-1136-42da-9211-f4f9cc2d7098" keepSession="false" maxResults="0" name="DQ happy path" searchProperties="true">
      <con:settings/>
      
      <con:testStep name="Modify gateway.properties" type="groovy">
        <con:settings/>
        <con:config>
          <script>//def destConfigFileLocation = context.findProperty("NHINGatewayConfigDir");

def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR']

void UpdateProperty(String directory, String filename, String propertyKey, String propertyValue,context,log) {
			  
   log.info("begin UpdateProperty; directory='" + directory + "';filename='" + filename + "';key='" + propertyKey + "';value='" + propertyValue + "';");
   File file = new File(directory,filename);
   Properties properties = new Properties();
   FileInputStream frPropFile = new FileInputStream(file);
   properties.load(frPropFile);
   properties.setProperty(propertyKey, propertyValue);
   FileOutputStream fwPropFile = new FileOutputStream(file);
   properties.store(fwPropFile, "**DO NOT CHECK IN** - written by groovy script FileUtils.groovy-&gt;UpdateProperty");
   properties = null;
}

UpdateProperty(destConfigFileLocation,"gateway.properties","documentQueryQuerySelf","false",context,log);</script>
        </con:config>
      </con:testStep>
      
      <con:testStep name="Clear Correlation Table &amp; Add Correlation" type="groovy">
        <con:settings/>
        <con:config><script>context.withSql('PatientCorrelationDB') { sql -&gt; 
  def table = context.findProperty('PatientCorrelationTable')
  
  sql.execute('delete from ' + table)

  def localAA = context.findProperty( "LocalAA" )
  def localPatientID = context.findProperty("LocalPatientID")
  def remoteAA = context.findProperty( "RemoteAA" )
  def remotePatientID = context.findProperty("RemotePatientID")
  def insertSql = "insert into " + table + " (PatientAssigningAuthorityId, PatientId, CorrelatedPatientAssignAuthId, CorrelatedPatientId) " + 
                   "values (?, ?, ?, ?)"
//  sql.executeUpdate(insertSql, [remoteAA, remotePatientID, localAA, localPatientID])
  sql.executeUpdate(insertSql, ["2.2", remotePatientID, localAA, localPatientID])
  sql.executeUpdate(insertSql, ["3.3", remotePatientID, localAA, localPatientID])
  sql.executeUpdate(insertSql, ["4.4", remotePatientID, localAA, localPatientID])
  sql.executeUpdate(insertSql, ["5.5", remotePatientID, localAA, localPatientID])
  sql.executeUpdate(insertSql, ["6.6", remotePatientID, localAA, localPatientID])
  sql.executeUpdate(insertSql, ["7.7", remotePatientID, localAA, localPatientID])
  sql.executeUpdate(insertSql, ["8.8", remotePatientID, localAA, localPatientID])
}</script></con:config>
      </con:testStep><con:testStep name="Clear AA Mapping Table &amp; Add Mapping" type="groovy">
        <con:settings/>
        <con:config><script>context.withSql('AAMappingDB') { sql -&gt; 
  def table = context.findProperty('AAMappingTable')
  
  sql.execute('delete from ' + table)

  def remoteAA = context.findProperty( "RemoteAA" )
  def remoteHCID = context.findProperty("RemoteHCID")
  def insertSql = "insert into " + table + " (assigningauthorityid, homecommunityid) " + 
                   "values (?, ?)"
//  sql.executeUpdate(insertSql, [remoteAA, remoteHCID])
  sql.executeUpdate(insertSql, ["2.2", "2.2"])
  sql.executeUpdate(insertSql, ["3.3", "3.3"])
  sql.executeUpdate(insertSql, ["4.4", "4.4"])
  sql.executeUpdate(insertSql, ["5.5", "5.5"])
  sql.executeUpdate(insertSql, ["6.6", "6.6"])
  sql.executeUpdate(insertSql, ["7.7", "7.7"])
  sql.executeUpdate(insertSql, ["8.8", "8.8"])
}</script></con:config>
      </con:testStep><con:testStep name="copy uddiConnectionInfo" type="groovy">
				<con:settings/>
				<con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
def projectPropPath = groovyUtils.projectPath

def sourceDir = projectPropPath;
def sourceFile = "uddiConnectionInfo_FANOUT.xml";
def destDir = System.env['NHINC_PROPERTIES_DIR'];
def destFile = "uddiConnectionInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.MoveFile(sourceDir, sourceFile, destDir, destFile, context, log);






					</script></con:config>
			</con:testStep><con:testStep name="modify uddiConnectionInfo" type="groovy"><con:settings/><con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context );
def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];
def mockHost = context.findProperty("mockHost");
def localHCID = context.findProperty("LocalHCID");

def DQURL = "https://" + mockHost + ":8181/Gateway/DocumentQuery/2_0/NhinService/RespondingGateway_Query_Service/DocQuery";

FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "1.1", "QueryForDocuments", DQURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "2.2", "QueryForDocuments", DQURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "3.3", "QueryForDocuments", DQURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "4.4", "QueryForDocuments", DQURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "5.5", "QueryForDocuments", DQURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "6.6", "QueryForDocuments", DQURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "7.7", "QueryForDocuments", DQURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "8.8", "QueryForDocuments", DQURL, "2.0", context, log)</script></con:config></con:testStep><con:testStep name="modify internalConnectionInfo" type="groovy"><con:settings/><con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context );
def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];
def mockHost = context.findProperty("mockHost");
def localHCID = context.findProperty("LocalHCID");

def AdapterDQURL = "http://" + mockHost + ":7782/MockDQResp";

FileUtils.CreateOrUpdateConnection("internalConnectionInfo.xml", destConfigFileLocation, localHCID, "adapterdocquery", AdapterDQURL, "LEVEL_a0", context, log)
</script></con:config></con:testStep><con:testStep name="Document Query fanout" type="request">
        <con:settings/>
        <con:config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:RequestStep">
          <con:interface>EntityDocQueryBindingSoap</con:interface>
          <con:operation>RespondingGateway_CrossGatewayQuery</con:operation>
          <con:request name="Document Query fanout">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/&gt;</con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>${#Project#Endpoint-DocQuery}</con:endpoint>
            <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:nhinccommonentity" xmlns:urn1="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0" xmlns:urn2="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0" xmlns:urn3="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soapenv:Header/>
   <soapenv:Body projectName="EndToEndSelfTest" testCase="Document Query">
      <urn:RespondingGateway_CrossGatewayQueryRequest>
         <urn1:AdhocQueryRequest federated="false" startIndex="0" maxResults="-1">
            <urn1:ResponseOption returnType="LeafClass" returnComposedObjects="false"/>
            <urn2:AdhocQuery home="urn:oid:1.1" id="urn:uuid:14d4debf-8f97-4251-9a74-a90016b0af0d">
               <urn2:Slot name="$XDSDocumentEntryPatientId">
                  <urn2:ValueList>
                     <urn2:Value>'${#Project#DQPatientID}^^^&amp;${#Project#LocalAA}&amp;ISO'</urn2:Value>
                  </urn2:ValueList>
               </urn2:Slot>
               <urn2:Slot name="$XDSDocumentEntryStatus">
                  <urn2:ValueList>
                     <urn2:Value>('urn:oasis:names:tc:ebxml-regrep:StatusType:Approved')</urn2:Value>
                  </urn2:ValueList>
               </urn2:Slot>
            </urn2:AdhocQuery>
         </urn1:AdhocQueryRequest>
         <urn:assertion>
            <urn3:address xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:addressType>
                  <urn3:code>AddrCode</urn3:code>
                  <urn3:codeSystem>AddrCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>AddrCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>AddrCode</urn3:displayName>
                  <urn3:originalText>AddrCode</urn3:originalText>
               </urn3:addressType>
               <urn3:city>AddrCity</urn3:city>
               <urn3:country>AddrCountry</urn3:country>
               <urn3:state>AddrState</urn3:state>
               <urn3:streetAddress>AddrStreet</urn3:streetAddress>
               <urn3:zipCode>AddrZip</urn3:zipCode>
            </urn3:address>
            <urn3:dateOfBirth xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">06/04/1959 05:21:00</urn3:dateOfBirth>
            <urn3:dateOfSignature xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">${#Project#sigDate}</urn3:dateOfSignature>
            <urn3:expirationDate xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">${#Project#expireDate}</urn3:expirationDate>
            <urn3:explanationNonClaimantSignature xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">Electronic</urn3:explanationNonClaimantSignature>
            <urn3:haveSecondWitnessSignature xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">false</urn3:haveSecondWitnessSignature>
            <urn3:haveSignature xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">false</urn3:haveSignature>
            <urn3:haveWitnessSignature xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">false</urn3:haveWitnessSignature>
            <urn3:homeCommunity xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:description>${#Project#LocalHCDescription}</urn3:description>
               <urn3:homeCommunityId>${#Project#LocalHCID}</urn3:homeCommunityId>
               <urn3:name>${#Project#LocalHCDescription}</urn3:name>
            </urn3:homeCommunity>
            <urn3:personName xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:familyName>Smith</urn3:familyName>
               <urn3:givenName>Sandy</urn3:givenName>
               <urn3:nameType>
                  <urn3:code>nameCode</urn3:code>
                  <urn3:codeSystem>nameCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>nameCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>nameCode</urn3:displayName>
                  <urn3:originalText>nameCode</urn3:originalText>
               </urn3:nameType>
               <urn3:secondNameOrInitials>S</urn3:secondNameOrInitials>
               <urn3:fullName>Sandy S. Smith</urn3:fullName>
            </urn3:personName>
            <urn3:phoneNumber xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:areaCode>321</urn3:areaCode>
               <urn3:countryCode>1</urn3:countryCode>
               <urn3:extension>5436</urn3:extension>
               <urn3:localNumber>253-6849</urn3:localNumber>
               <urn3:phoneNumberType>
                  <urn3:code>phoneCode</urn3:code>
                  <urn3:codeSystem>phoneCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>phoneCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>phoneCode</urn3:displayName>
                  <urn3:originalText>phoneCode</urn3:originalText>
               </urn3:phoneNumberType>
            </urn3:phoneNumber>
            <urn3:purposeOfDisclosure xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">TREATMENT</urn3:purposeOfDisclosure>
            <urn3:secondWitnessAddress xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:addressType>
                  <urn3:code>AddrCode</urn3:code>
                  <urn3:codeSystem>AddrCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>AddrCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>AddrCode</urn3:displayName>
                  <urn3:originalText>AddrCode</urn3:originalText>
               </urn3:addressType>
               <urn3:city>Addr2City</urn3:city>
               <urn3:country>Addr2Country</urn3:country>
               <urn3:state>Addr2State</urn3:state>
               <urn3:streetAddress>Addr2Street</urn3:streetAddress>
               <urn3:zipCode>Addr2Zip</urn3:zipCode>
            </urn3:secondWitnessAddress>
            <urn3:secondWitnessName xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:familyName>Smith</urn3:familyName>
               <urn3:givenName>Sammy</urn3:givenName>
               <urn3:nameType>
                  <urn3:code>nameCode</urn3:code>
                  <urn3:codeSystem>nameCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>nameCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>nameCode</urn3:displayName>
                  <urn3:originalText>nameCode</urn3:originalText>
               </urn3:nameType>
               <urn3:secondNameOrInitials>s</urn3:secondNameOrInitials>
               <urn3:fullName>Sammy S. Smith</urn3:fullName>
            </urn3:secondWitnessName>
            <urn3:secondWitnessPhone xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:areaCode>321</urn3:areaCode>
               <urn3:countryCode>1</urn3:countryCode>
               <urn3:extension>5424</urn3:extension>
               <urn3:localNumber>542-6823</urn3:localNumber>
               <urn3:phoneNumberType>
                  <urn3:code>phoneCode</urn3:code>
                  <urn3:codeSystem>phoneCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>phoneCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>phoneCode</urn3:displayName>
                  <urn3:originalText>phoneCode</urn3:originalText>
               </urn3:phoneNumberType>
            </urn3:secondWitnessPhone>
            <urn3:SSN xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">253-98-7546</urn3:SSN>
            <urn3:uniquePatientId xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">500000000^^^&amp;1.1&amp;ISO</urn3:uniquePatientId>
            <urn3:witnessAddress xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:addressType>
                  <urn3:code>addrCode</urn3:code>
                  <urn3:codeSystem>addrCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>addrCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>addrCode</urn3:displayName>
                  <urn3:originalText>addrCode</urn3:originalText>
               </urn3:addressType>
               <urn3:city>Burnell</urn3:city>
               <urn3:country>USA</urn3:country>
               <urn3:state>FL</urn3:state>
               <urn3:streetAddress>825 North</urn3:streetAddress>
               <urn3:zipCode>32184</urn3:zipCode>
            </urn3:witnessAddress>
            <urn3:witnessName xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:familyName>Smith</urn3:familyName>
               <urn3:givenName>Scott</urn3:givenName>
               <urn3:nameType>
                  <urn3:code>nameCode</urn3:code>
                  <urn3:codeSystem>nameCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>nameCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>nameCode</urn3:displayName>
                  <urn3:originalText>nameCode</urn3:originalText>
               </urn3:nameType>
               <urn3:secondNameOrInitials>S.</urn3:secondNameOrInitials>
               <urn3:fullName>Scott S. Smith</urn3:fullName>
            </urn3:witnessName>
            <urn3:witnessPhone xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:areaCode>321</urn3:areaCode>
               <urn3:countryCode>1</urn3:countryCode>
               <urn3:extension>8432</urn3:extension>
               <urn3:localNumber>985-2239</urn3:localNumber>
               <urn3:phoneNumberType>
                  <urn3:code>phoneCode</urn3:code>
                  <urn3:codeSystem>phoneCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>phoneCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>phoneCode</urn3:displayName>
                  <urn3:originalText>phoneCode</urn3:originalText>
               </urn3:phoneNumberType>
            </urn3:witnessPhone>
            <urn3:userInfo xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:personName>
                  <urn3:familyName>Skagerberg</urn3:familyName>
                  <urn3:givenName>Karl</urn3:givenName>
                  <urn3:nameType>
                     <urn3:code>nameCode</urn3:code>
                     <urn3:codeSystem>nameCodeSyst</urn3:codeSystem>
                     <urn3:codeSystemName>nameCodeSystName</urn3:codeSystemName>
                     <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                     <urn3:displayName>nameCode</urn3:displayName>
                     <urn3:originalText>nameCode</urn3:originalText>
                  </urn3:nameType>
                  <urn3:secondNameOrInitials>S</urn3:secondNameOrInitials>
                  <urn3:fullName>Kasrl S. Skagerberg</urn3:fullName>
               </urn3:personName>
               <urn3:userName>kskagerb</urn3:userName>
               <urn3:role>Pharmacy</urn3:role>
               <urn3:org>
                  <urn3:description>${#Project#LocalHCDescription}</urn3:description>
                  <urn3:homeCommunityId>${#Project#LocalHCID}</urn3:homeCommunityId>
                  <urn3:name>${#Project#LocalHCDescription}</urn3:name>
               </urn3:org>
               <urn3:roleCoded>
                  <urn3:code>307969004</urn3:code>
                  <urn3:codeSystem>2.16.840.1.113883.6.96</urn3:codeSystem>
                  <urn3:codeSystemName>SNOMED_CT</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>Public Health</urn3:displayName>
                  <urn3:originalText>Public Health</urn3:originalText>
               </urn3:roleCoded>
            </urn3:userInfo>
            <urn3:authorized xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">true</urn3:authorized>
            <urn3:purposeOfDisclosureCoded xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:code>PUBLICHEALTH</urn3:code>
               <urn3:codeSystem>2.16.840.1.113883.3.18.7.1</urn3:codeSystem>
               <urn3:codeSystemName>nhin-purpose</urn3:codeSystemName>
               <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
               <urn3:displayName>Use or disclosure of Psychotherapy Notes</urn3:displayName>
               <urn3:originalText>Use or disclosure of Psychotherapy Notes</urn3:originalText>
            </urn3:purposeOfDisclosureCoded>
            <urn3:claimFormRef>Ref-Clm-123</urn3:claimFormRef>
            <urn3:claimFormRaw>YWVvbGlhbQ==</urn3:claimFormRaw>
            <urn3:samlAuthnStatement xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:authInstant>2009-04-16T13:15:39Z</urn3:authInstant>
               <urn3:sessionIndex>987</urn3:sessionIndex>
               <urn3:authContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:X509</urn3:authContextClassRef>
               <urn3:subjectLocalityAddress>158.147.185.168</urn3:subjectLocalityAddress>
               <urn3:subjectLocalityDNSName>cs.myharris.net</urn3:subjectLocalityDNSName>
            </urn3:samlAuthnStatement>
         <!--   <urn3:samlAuthzDecisionStatement xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:decision>Permit</urn3:decision>
               <urn3:resource>https://158.147.185.168:8181/SamlReceiveService/SamlProcessWS</urn3:resource>
               <urn3:action>TestSaml</urn3:action>
               <urn3:evidence>
                  <urn3:assertion>
                     <urn3:id>40df7c0a-ff3e-4b26-baeb-f2910f6d05a9</urn3:id>
                     <urn3:issueInstant>2009-04-16T13:10:39.093Z</urn3:issueInstant>
                     <urn3:version>2.0</urn3:version>
                     <urn3:issuerFormat>urn:oasis:names:tc:SAML:1.1:nameid-format:X509SubjectName</urn3:issuerFormat>
                     <urn3:issuer>CN=SAML User,OU=Harris,O=HITS,L=Melbourne,ST=FL,C=US</urn3:issuer>
                     <urn3:conditions>
                        <urn3:notBefore>2009-04-16T13:10:39.093Z</urn3:notBefore>
                        <urn3:notOnOrAfter>2009-12-31T12:00:00.000Z</urn3:notOnOrAfter>
                     </urn3:conditions>
                     <urn3:accessConsentPolicy>urn:oid:1.2.3.4</urn3:accessConsentPolicy>
                     <urn3:instanceAccessConsentPolicy>urn:oid:1.2.3.4.123456789</urn3:instanceAccessConsentPolicy>
                  </urn3:assertion>
               </urn3:evidence>
            </urn3:samlAuthzDecisionStatement> -->
         </urn:assertion>
<!--        <urn:NhinTargetCommunities>
            <urn3:nhinTargetCommunity>
               <urn3:homeCommunity>
                  <urn3:description>${#Project#RemoteHCDescription}</urn3:description>
                  <urn3:homeCommunityId>${#Project#RemoteHCID}</urn3:homeCommunityId>
                  <urn3:name>${#Project#RemoteHCDescription}</urn3:name>
               </urn3:homeCommunity>
            </urn3:nhinTargetCommunity>
         </urn:NhinTargetCommunities> -->
      </urn:RespondingGateway_CrossGatewayQueryRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
            <con:assertion type="SOAP Response"/>
            <con:assertion disabled="true" type="Schema Compliance">
              <con:configuration/>
            </con:assertion>
            <con:assertion type="SOAP Fault Assertion"/>
            <con:assertion name="DocID Match" type="GroovyScriptAssertion">
              <con:configuration><scriptText>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context );
def holder = groovyUtils.getXmlHolder( messageExchange.responseContent );
holder.namespaces["ns1"] = "urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0";
holder.namespaces["ns3"] = "urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0";

def documentID = context.findProperty('DQDocID')
def msgDocID = holder["//ns1:AdhocQueryResponse[1]/ns3:RegistryObjectList[1]/ns3:ExtrinsicObject/ns3:ExternalIdentifier[@identificationScheme='urn:uuid:2e82c1f6-a085-4c72-9da3-8640a32e42ab']/@value"];
assert (msgDocID.toString().contains(documentID))
assert (msgDocID.toString().contains("1.123401.66666"))
assert (msgDocID.toString().contains("1.123402.11111"))</scriptText></con:configuration>
            </con:assertion>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep><con:setupScript>import nhinc.FileUtils;
testCase.getTestSuite().getProject().getMockServiceByName("mockDQ_happy_path").start();
FileUtils.changeSpringConfig("AdapterDocQueryProxyConfig.xml", "wsunsecured", log);

def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];

File sourceInternalFile = new File(destConfigFileLocation, "internalConnectionInfo.xml");
File backupInternalFile = new File(destConfigFileLocation, "internalConnectionInfo_BACKUP.xml");

File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(sourceInternalFile, backupInternalFile, log);
MoveFile(sourceUddiFile, backupUddiFile, log);</con:setupScript><con:tearDownScript>import nhinc.FileUtils;
FileUtils.restoreToMasterConfiguration(context, log);
testCase.getTestSuite().getProject().getMockServiceByName("mockDQ_happy_path").getMockRunner().stop();
FileUtils.changeSpringConfig("AdapterDocQueryProxyConfig.xml", "default", log);


File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(backupInternalFile, sourceInternalFile, log);
MoveFile(backupUddiFile, sourceUddiFile, log);

void DeleteFile(File file, log) {  
   if(file.exists()) {    
      log.info("deleting file " + file);
      file.delete(); 
   } else {
      log.info("file not found, skipping delete for " + file);
   }
}

DeleteFile(backupInternalFile, log);
DeleteFile(backupUddiFile, log);</con:tearDownScript><con:properties>
        <con:property>
          <con:name>startDate</con:name>
          <con:value>2012-08-25T00:56:36Z</con:value>
        </con:property>
        <con:property>
          <con:name>endDate</con:name>
          <con:value>2012-08-25T01:06:36Z</con:value>
        </con:property>
        <con:property>
          <con:name>sigDate</con:name>
          <con:value>08/25/2012 00:56:36</con:value>
        </con:property>
        <con:property>
          <con:name>expireDate</con:name>
          <con:value>2012-09-24T00:00:00Z</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
    </con:testCase><con:testCase failOnError="true" failTestCaseOnErrors="true" id="c9b0592a-9f0d-4079-9292-1027fe6f3fd3" keepSession="false" maxResults="0" name="DQ all" searchProperties="true">
      <con:settings/>
      
      <con:testStep name="Modify gateway.properties" type="groovy">
        <con:settings/>
        <con:config>
          <script>//def destConfigFileLocation = context.findProperty("NHINGatewayConfigDir");

def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR']

void UpdateProperty(String directory, String filename, String propertyKey, String propertyValue,context,log) {
			  
   log.info("begin UpdateProperty; directory='" + directory + "';filename='" + filename + "';key='" + propertyKey + "';value='" + propertyValue + "';");
   File file = new File(directory,filename);
   Properties properties = new Properties();
   FileInputStream frPropFile = new FileInputStream(file);
   properties.load(frPropFile);
   properties.setProperty(propertyKey, propertyValue);
   FileOutputStream fwPropFile = new FileOutputStream(file);
   properties.store(fwPropFile, "**DO NOT CHECK IN** - written by groovy script FileUtils.groovy-&gt;UpdateProperty");
   properties = null;
}

UpdateProperty(destConfigFileLocation,"gateway.properties","documentQueryQuerySelf","false",context,log);</script>
        </con:config>
      </con:testStep>
      
      <con:testStep name="Clear Correlation Table &amp; Add Correlation" type="groovy">
        <con:settings/>
        <con:config><script>context.withSql('PatientCorrelationDB') { sql -&gt; 
  def table = context.findProperty('PatientCorrelationTable')
  
  sql.execute('delete from ' + table)

  def localAA = context.findProperty( "LocalAA" )
  def localPatientID = context.findProperty("LocalPatientID")
  def remoteAA = context.findProperty( "RemoteAA" )
  def remotePatientID = context.findProperty("RemotePatientID")
  def insertSql = "insert into " + table + " (PatientAssigningAuthorityId, PatientId, CorrelatedPatientAssignAuthId, CorrelatedPatientId) " + 
                   "values (?, ?, ?, ?)"
//  sql.executeUpdate(insertSql, [remoteAA, remotePatientID, localAA, localPatientID])
  sql.executeUpdate(insertSql, ["2.2", remotePatientID, localAA, localPatientID])
  sql.executeUpdate(insertSql, ["3.3", remotePatientID, localAA, localPatientID])
  sql.executeUpdate(insertSql, ["4.4", remotePatientID, localAA, localPatientID])
  sql.executeUpdate(insertSql, ["5.5", remotePatientID, localAA, localPatientID])
  sql.executeUpdate(insertSql, ["6.6", remotePatientID, localAA, localPatientID])
  sql.executeUpdate(insertSql, ["7.7", remotePatientID, localAA, localPatientID])
  sql.executeUpdate(insertSql, ["8.8", remotePatientID, localAA, localPatientID])
}</script></con:config>
      </con:testStep><con:testStep name="Clear AA Mapping Table &amp; Add Mapping" type="groovy">
        <con:settings/>
        <con:config><script>context.withSql('AAMappingDB') { sql -&gt; 
  def table = context.findProperty('AAMappingTable')
  
  sql.execute('delete from ' + table)

  def remoteAA = context.findProperty( "RemoteAA" )
  def remoteHCID = context.findProperty("RemoteHCID")
  def insertSql = "insert into " + table + " (assigningauthorityid, homecommunityid) " + 
                   "values (?, ?)"
//  sql.executeUpdate(insertSql, [remoteAA, remoteHCID])
  sql.executeUpdate(insertSql, ["2.2", "2.2"])
  sql.executeUpdate(insertSql, ["3.3", "3.3"])
  sql.executeUpdate(insertSql, ["4.4", "4.4"])
  sql.executeUpdate(insertSql, ["5.5", "5.5"])
  sql.executeUpdate(insertSql, ["6.6", "6.6"])
  sql.executeUpdate(insertSql, ["7.7", "7.7"])
  sql.executeUpdate(insertSql, ["8.8", "8.8"])
}</script></con:config>
      </con:testStep><con:testStep name="copy uddiConnectionInfo" type="groovy">
				<con:settings/>
				<con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context )
def testCase = testRunner.getTestCase()
def testSuite = testCase.getTestSuite()
def project = testSuite.getProject()
def projectPropFullFile = project.getPath()
def projectPropPath = groovyUtils.projectPath

def sourceDir = projectPropPath;
def sourceFile = "uddiConnectionInfo_FANOUT.xml";
def destDir = System.env['NHINC_PROPERTIES_DIR'];
def destFile = "uddiConnectionInfo.xml";

log.info(sourceDir +'; ' + sourceFile  +'; ' + destDir +'; ' + destFile );

FileUtils.MoveFile(sourceDir, sourceFile, destDir, destFile, context, log);






					</script></con:config>
			</con:testStep><con:testStep name="modify uddiConnectionInfo" type="groovy"><con:settings/><con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context );
def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];
def mockHost = context.findProperty("mockHost");
def localHCID = context.findProperty("LocalHCID");

def DQURL = "https://" + mockHost + ":8181/Gateway/DocumentQuery/2_0/NhinService/RespondingGateway_Query_Service/DocQuery";

FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "1.1", "QueryForDocuments", DQURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "2.2", "QueryForDocuments", DQURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "3.3", "QueryForDocuments", DQURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "4.4", "QueryForDocuments", DQURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "5.5", "QueryForDocuments", DQURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "6.6", "QueryForDocuments", DQURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "7.7", "QueryForDocuments", DQURL, "2.0", context, log)
FileUtils.CreateOrUpdateConnection("uddiConnectionInfo.xml", destConfigFileLocation, "8.8", "QueryForDocuments", DQURL, "2.0", context, log)</script></con:config></con:testStep><con:testStep name="modify internalConnectionInfo" type="groovy"><con:settings/><con:config><script>import nhinc.FileUtils;
def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context );
def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];
def mockHost = context.findProperty("mockHost");
def localHCID = context.findProperty("LocalHCID");

def AdapterDQURL = "http://" + mockHost + ":7784/MockDQResp";

FileUtils.CreateOrUpdateConnection("internalConnectionInfo.xml", destConfigFileLocation, localHCID, "adapterdocquery", AdapterDQURL, "LEVEL_a0", context, log)</script></con:config></con:testStep><con:testStep name="Document Query fanout" type="request">
        <con:settings/>
        <con:config xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:RequestStep">
          <con:interface>EntityDocQueryBindingSoap</con:interface>
          <con:operation>RespondingGateway_CrossGatewayQuery</con:operation>
          <con:request name="Document Query fanout">
            <con:settings>
              <con:setting id="com.eviware.soapui.impl.wsdl.WsdlRequest@request-headers">&lt;xml-fragment/&gt;</con:setting>
            </con:settings>
            <con:encoding>UTF-8</con:encoding>
            <con:endpoint>${#Project#Endpoint-DocQuery}</con:endpoint>
            <con:request><![CDATA[<soapenv:Envelope xmlns:soapenv="http://www.w3.org/2003/05/soap-envelope" xmlns:urn="urn:gov:hhs:fha:nhinc:common:nhinccommonentity" xmlns:urn1="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0" xmlns:urn2="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0" xmlns:urn3="urn:gov:hhs:fha:nhinc:common:nhinccommon">
   <soapenv:Header/>
   <soapenv:Body projectName="EndToEndSelfTest" testCase="Document Query">
      <urn:RespondingGateway_CrossGatewayQueryRequest>
         <urn1:AdhocQueryRequest federated="false" startIndex="0" maxResults="-1">
            <urn1:ResponseOption returnType="LeafClass" returnComposedObjects="false"/>
            <urn2:AdhocQuery home="urn:oid:1.1" id="urn:uuid:14d4debf-8f97-4251-9a74-a90016b0af0d">
               <urn2:Slot name="$XDSDocumentEntryPatientId">
                  <urn2:ValueList>
                     <urn2:Value>'${#Project#DQPatientID}^^^&amp;${#Project#LocalAA}&amp;ISO'</urn2:Value>
                  </urn2:ValueList>
               </urn2:Slot>
               <urn2:Slot name="$XDSDocumentEntryStatus">
                  <urn2:ValueList>
                     <urn2:Value>('urn:oasis:names:tc:ebxml-regrep:StatusType:Approved')</urn2:Value>
                  </urn2:ValueList>
               </urn2:Slot>
            </urn2:AdhocQuery>
         </urn1:AdhocQueryRequest>
         <urn:assertion>
            <urn3:address xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:addressType>
                  <urn3:code>AddrCode</urn3:code>
                  <urn3:codeSystem>AddrCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>AddrCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>AddrCode</urn3:displayName>
                  <urn3:originalText>AddrCode</urn3:originalText>
               </urn3:addressType>
               <urn3:city>AddrCity</urn3:city>
               <urn3:country>AddrCountry</urn3:country>
               <urn3:state>AddrState</urn3:state>
               <urn3:streetAddress>AddrStreet</urn3:streetAddress>
               <urn3:zipCode>AddrZip</urn3:zipCode>
            </urn3:address>
            <urn3:dateOfBirth xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">06/04/1959 05:21:00</urn3:dateOfBirth>
            <urn3:dateOfSignature xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">${#Project#sigDate}</urn3:dateOfSignature>
            <urn3:expirationDate xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">${#Project#expireDate}</urn3:expirationDate>
            <urn3:explanationNonClaimantSignature xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">Electronic</urn3:explanationNonClaimantSignature>
            <urn3:haveSecondWitnessSignature xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">false</urn3:haveSecondWitnessSignature>
            <urn3:haveSignature xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">false</urn3:haveSignature>
            <urn3:haveWitnessSignature xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">false</urn3:haveWitnessSignature>
            <urn3:homeCommunity xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:description>${#Project#LocalHCDescription}</urn3:description>
               <urn3:homeCommunityId>${#Project#LocalHCID}</urn3:homeCommunityId>
               <urn3:name>${#Project#LocalHCDescription}</urn3:name>
            </urn3:homeCommunity>
            <urn3:personName xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:familyName>Smith</urn3:familyName>
               <urn3:givenName>Sandy</urn3:givenName>
               <urn3:nameType>
                  <urn3:code>nameCode</urn3:code>
                  <urn3:codeSystem>nameCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>nameCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>nameCode</urn3:displayName>
                  <urn3:originalText>nameCode</urn3:originalText>
               </urn3:nameType>
               <urn3:secondNameOrInitials>S</urn3:secondNameOrInitials>
               <urn3:fullName>Sandy S. Smith</urn3:fullName>
            </urn3:personName>
            <urn3:phoneNumber xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:areaCode>321</urn3:areaCode>
               <urn3:countryCode>1</urn3:countryCode>
               <urn3:extension>5436</urn3:extension>
               <urn3:localNumber>253-6849</urn3:localNumber>
               <urn3:phoneNumberType>
                  <urn3:code>phoneCode</urn3:code>
                  <urn3:codeSystem>phoneCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>phoneCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>phoneCode</urn3:displayName>
                  <urn3:originalText>phoneCode</urn3:originalText>
               </urn3:phoneNumberType>
            </urn3:phoneNumber>
            <urn3:purposeOfDisclosure xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">TREATMENT</urn3:purposeOfDisclosure>
            <urn3:secondWitnessAddress xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:addressType>
                  <urn3:code>AddrCode</urn3:code>
                  <urn3:codeSystem>AddrCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>AddrCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>AddrCode</urn3:displayName>
                  <urn3:originalText>AddrCode</urn3:originalText>
               </urn3:addressType>
               <urn3:city>Addr2City</urn3:city>
               <urn3:country>Addr2Country</urn3:country>
               <urn3:state>Addr2State</urn3:state>
               <urn3:streetAddress>Addr2Street</urn3:streetAddress>
               <urn3:zipCode>Addr2Zip</urn3:zipCode>
            </urn3:secondWitnessAddress>
            <urn3:secondWitnessName xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:familyName>Smith</urn3:familyName>
               <urn3:givenName>Sammy</urn3:givenName>
               <urn3:nameType>
                  <urn3:code>nameCode</urn3:code>
                  <urn3:codeSystem>nameCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>nameCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>nameCode</urn3:displayName>
                  <urn3:originalText>nameCode</urn3:originalText>
               </urn3:nameType>
               <urn3:secondNameOrInitials>s</urn3:secondNameOrInitials>
               <urn3:fullName>Sammy S. Smith</urn3:fullName>
            </urn3:secondWitnessName>
            <urn3:secondWitnessPhone xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:areaCode>321</urn3:areaCode>
               <urn3:countryCode>1</urn3:countryCode>
               <urn3:extension>5424</urn3:extension>
               <urn3:localNumber>542-6823</urn3:localNumber>
               <urn3:phoneNumberType>
                  <urn3:code>phoneCode</urn3:code>
                  <urn3:codeSystem>phoneCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>phoneCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>phoneCode</urn3:displayName>
                  <urn3:originalText>phoneCode</urn3:originalText>
               </urn3:phoneNumberType>
            </urn3:secondWitnessPhone>
            <urn3:SSN xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">253-98-7546</urn3:SSN>
            <urn3:uniquePatientId xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">500000000^^^&amp;1.1&amp;ISO</urn3:uniquePatientId>
            <urn3:witnessAddress xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:addressType>
                  <urn3:code>addrCode</urn3:code>
                  <urn3:codeSystem>addrCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>addrCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>addrCode</urn3:displayName>
                  <urn3:originalText>addrCode</urn3:originalText>
               </urn3:addressType>
               <urn3:city>Burnell</urn3:city>
               <urn3:country>USA</urn3:country>
               <urn3:state>FL</urn3:state>
               <urn3:streetAddress>825 North</urn3:streetAddress>
               <urn3:zipCode>32184</urn3:zipCode>
            </urn3:witnessAddress>
            <urn3:witnessName xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:familyName>Smith</urn3:familyName>
               <urn3:givenName>Scott</urn3:givenName>
               <urn3:nameType>
                  <urn3:code>nameCode</urn3:code>
                  <urn3:codeSystem>nameCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>nameCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>nameCode</urn3:displayName>
                  <urn3:originalText>nameCode</urn3:originalText>
               </urn3:nameType>
               <urn3:secondNameOrInitials>S.</urn3:secondNameOrInitials>
               <urn3:fullName>Scott S. Smith</urn3:fullName>
            </urn3:witnessName>
            <urn3:witnessPhone xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:areaCode>321</urn3:areaCode>
               <urn3:countryCode>1</urn3:countryCode>
               <urn3:extension>8432</urn3:extension>
               <urn3:localNumber>985-2239</urn3:localNumber>
               <urn3:phoneNumberType>
                  <urn3:code>phoneCode</urn3:code>
                  <urn3:codeSystem>phoneCodeSyst</urn3:codeSystem>
                  <urn3:codeSystemName>phoneCodeSystName</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>phoneCode</urn3:displayName>
                  <urn3:originalText>phoneCode</urn3:originalText>
               </urn3:phoneNumberType>
            </urn3:witnessPhone>
            <urn3:userInfo xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:personName>
                  <urn3:familyName>Skagerberg</urn3:familyName>
                  <urn3:givenName>Karl</urn3:givenName>
                  <urn3:nameType>
                     <urn3:code>nameCode</urn3:code>
                     <urn3:codeSystem>nameCodeSyst</urn3:codeSystem>
                     <urn3:codeSystemName>nameCodeSystName</urn3:codeSystemName>
                     <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                     <urn3:displayName>nameCode</urn3:displayName>
                     <urn3:originalText>nameCode</urn3:originalText>
                  </urn3:nameType>
                  <urn3:secondNameOrInitials>S</urn3:secondNameOrInitials>
                  <urn3:fullName>Kasrl S. Skagerberg</urn3:fullName>
               </urn3:personName>
               <urn3:userName>kskagerb</urn3:userName>
               <urn3:role>Pharmacy</urn3:role>
               <urn3:org>
                  <urn3:description>${#Project#LocalHCDescription}</urn3:description>
                  <urn3:homeCommunityId>${#Project#LocalHCID}</urn3:homeCommunityId>
                  <urn3:name>${#Project#LocalHCDescription}</urn3:name>
               </urn3:org>
               <urn3:roleCoded>
                  <urn3:code>307969004</urn3:code>
                  <urn3:codeSystem>2.16.840.1.113883.6.96</urn3:codeSystem>
                  <urn3:codeSystemName>SNOMED_CT</urn3:codeSystemName>
                  <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
                  <urn3:displayName>Public Health</urn3:displayName>
                  <urn3:originalText>Public Health</urn3:originalText>
               </urn3:roleCoded>
            </urn3:userInfo>
            <urn3:authorized xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">true</urn3:authorized>
            <urn3:purposeOfDisclosureCoded xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:code>PUBLICHEALTH</urn3:code>
               <urn3:codeSystem>2.16.840.1.113883.3.18.7.1</urn3:codeSystem>
               <urn3:codeSystemName>nhin-purpose</urn3:codeSystemName>
               <urn3:codeSystemVersion>1.0</urn3:codeSystemVersion>
               <urn3:displayName>Use or disclosure of Psychotherapy Notes</urn3:displayName>
               <urn3:originalText>Use or disclosure of Psychotherapy Notes</urn3:originalText>
            </urn3:purposeOfDisclosureCoded>
            <urn3:claimFormRef>Ref-Clm-123</urn3:claimFormRef>
            <urn3:claimFormRaw>YWVvbGlhbQ==</urn3:claimFormRaw>
            <urn3:samlAuthnStatement xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:authInstant>2009-04-16T13:15:39Z</urn3:authInstant>
               <urn3:sessionIndex>987</urn3:sessionIndex>
               <urn3:authContextClassRef>urn:oasis:names:tc:SAML:2.0:ac:classes:X509</urn3:authContextClassRef>
               <urn3:subjectLocalityAddress>158.147.185.168</urn3:subjectLocalityAddress>
               <urn3:subjectLocalityDNSName>cs.myharris.net</urn3:subjectLocalityDNSName>
            </urn3:samlAuthnStatement>
         <!--   <urn3:samlAuthzDecisionStatement xmlns:urn1="urn:gov:hhs:fha:nhinc:common:nhinccommon">
               <urn3:decision>Permit</urn3:decision>
               <urn3:resource>https://158.147.185.168:8181/SamlReceiveService/SamlProcessWS</urn3:resource>
               <urn3:action>TestSaml</urn3:action>
               <urn3:evidence>
                  <urn3:assertion>
                     <urn3:id>40df7c0a-ff3e-4b26-baeb-f2910f6d05a9</urn3:id>
                     <urn3:issueInstant>2009-04-16T13:10:39.093Z</urn3:issueInstant>
                     <urn3:version>2.0</urn3:version>
                     <urn3:issuerFormat>urn:oasis:names:tc:SAML:1.1:nameid-format:X509SubjectName</urn3:issuerFormat>
                     <urn3:issuer>CN=SAML User,OU=Harris,O=HITS,L=Melbourne,ST=FL,C=US</urn3:issuer>
                     <urn3:conditions>
                        <urn3:notBefore>2009-04-16T13:10:39.093Z</urn3:notBefore>
                        <urn3:notOnOrAfter>2009-12-31T12:00:00.000Z</urn3:notOnOrAfter>
                     </urn3:conditions>
                     <urn3:accessConsentPolicy>urn:oid:1.2.3.4</urn3:accessConsentPolicy>
                     <urn3:instanceAccessConsentPolicy>urn:oid:1.2.3.4.123456789</urn3:instanceAccessConsentPolicy>
                  </urn3:assertion>
               </urn3:evidence>
            </urn3:samlAuthzDecisionStatement> -->
         </urn:assertion>
<!--        <urn:NhinTargetCommunities>
            <urn3:nhinTargetCommunity>
               <urn3:homeCommunity>
                  <urn3:description>${#Project#RemoteHCDescription}</urn3:description>
                  <urn3:homeCommunityId>${#Project#RemoteHCID}</urn3:homeCommunityId>
                  <urn3:name>${#Project#RemoteHCDescription}</urn3:name>
               </urn3:homeCommunity>
            </urn3:nhinTargetCommunity>
         </urn:NhinTargetCommunities> -->
      </urn:RespondingGateway_CrossGatewayQueryRequest>
   </soapenv:Body>
</soapenv:Envelope>]]></con:request>
            <con:assertion type="SOAP Response"/>
            <con:assertion disabled="true" type="Schema Compliance">
              <con:configuration/>
            </con:assertion>
            <con:assertion type="SOAP Fault Assertion"/>
            <con:assertion name="DocID Match" type="GroovyScriptAssertion">
              <con:configuration>
                <scriptText>def groovyUtils = new com.eviware.soapui.support.GroovyUtils( context );
def holder = groovyUtils.getXmlHolder( messageExchange.responseContent );
holder.namespaces["ns1"] = "urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0";
holder.namespaces["ns3"] = "urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0";

def documentID = context.findProperty('DQDocID')
def msgDocID = holder["//ns1:AdhocQueryResponse[1]/ns3:RegistryObjectList[1]/ns3:ExtrinsicObject[1]/ns3:ExternalIdentifier[@identificationScheme='urn:uuid:2e82c1f6-a085-4c72-9da3-8640a32e42ab']/@value"];
assert (documentID == msgDocID)</scriptText>
              </con:configuration>
            </con:assertion>
            <con:jmsConfig JMSDeliveryMode="PERSISTENT"/>
            <con:jmsPropertyConfig/>
            <con:wsaConfig mustUnderstand="NONE" version="200508"/>
            <con:wsrmConfig version="1.2"/>
          </con:request>
        </con:config>
      </con:testStep><con:setupScript>import nhinc.FileUtils;
testCase.getTestSuite().getProject().getMockServiceByName("mockDQ_all").start();
FileUtils.changeSpringConfig("AdapterDocQueryProxyConfig.xml", "wsunsecured", log);

def destConfigFileLocation = System.env['NHINC_PROPERTIES_DIR'];

File sourceInternalFile = new File(destConfigFileLocation, "internalConnectionInfo.xml");
File backupInternalFile = new File(destConfigFileLocation, "internalConnectionInfo_BACKUP.xml");

File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(sourceInternalFile, backupInternalFile, log);
MoveFile(sourceUddiFile, backupUddiFile, log);</con:setupScript><con:tearDownScript>import nhinc.FileUtils;
FileUtils.restoreToMasterConfiguration(context, log);
testCase.getTestSuite().getProject().getMockServiceByName("mockDQ_all").getMockRunner().stop();
FileUtils.changeSpringConfig("AdapterDocQueryProxyConfig.xml", "default", log);


File sourceUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo.xml");
File backupUddiFile = new File(destConfigFileLocation, "uddiConnectionInfo_BACKUP.xml");

void MoveFile(File sourceFile, File destinationFile, log){
 
 if(sourceFile.exists())
   {
    def reader = sourceFile.newReader();
    destinationFile.withWriter 
    { writer -&gt;       
     writer &lt;&lt; reader;   
    }   
    reader.close();
   } 
   else {
      log.info("unable to find source file " + sourceFile);
   }   
}

MoveFile(backupInternalFile, sourceInternalFile, log);
MoveFile(backupUddiFile, sourceUddiFile, log);

void DeleteFile(File file, log) {  
   if(file.exists()) {    
      log.info("deleting file " + file);
      file.delete(); 
   } else {
      log.info("file not found, skipping delete for " + file);
   }
}

DeleteFile(backupInternalFile, log);
DeleteFile(backupUddiFile, log);</con:tearDownScript><con:properties>
        <con:property>
          <con:name>startDate</con:name>
          <con:value>2012-08-25T00:56:40Z</con:value>
        </con:property>
        <con:property>
          <con:name>endDate</con:name>
          <con:value>2012-08-25T01:06:40Z</con:value>
        </con:property>
        <con:property>
          <con:name>sigDate</con:name>
          <con:value>08/25/2012 00:56:40</con:value>
        </con:property>
        <con:property>
          <con:name>expireDate</con:name>
          <con:value>2012-09-24T00:00:00Z</con:value>
        </con:property>
      </con:properties>
      <con:reportParameters/>
    </con:testCase><con:properties/><con:setupScript/></con:testSuite><con:mockService bindToHostOnly="false" docroot="" host="localhost" name="mockMPI_all" path="/MockMPIResp" port="7781"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.mock.WsdlMockService@require-soap-action">false</con:setting></con:settings><con:mockOperation interface="AdapterComponentMpiPortTypeBinding" name="FindCandidates" operation="FindCandidates"><con:settings/><con:dispatchStyle>QUERY_MATCH</con:dispatchStyle><con:defaultResponse>Gallow</con:defaultResponse><con:response encoding="UTF-8" name="Gallow"><con:settings/><con:script>context.patientid = Math.random()
context.root = Math.random()</con:script><con:responseContent><![CDATA[<S:Envelope xmlns:S="http://www.w3.org/2003/05/soap-envelope" xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:wsse11="http://docs.oasis-open.org/wss/oasis-wss-wssecurity-secext-1.1.xsd">
   <S:Body>
      <PRPA_IN201306UV02 ITSVersion="XML_1.0" xmlns="urn:hl7-org:v3" xmlns:ns2="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:ns3="http://schemas.xmlsoap.org/ws/2004/08/addressing" xmlns:ns4="urn:gov:hhs:fha:nhinc:common:patientcorrelationfacade">
         <id extension="3b839b4e:133af7051a3:-7fbd" root="1.1"/>
         <creationTime value="2011111725448"/>
         <interactionId extension="PRPA_IN201306UV02" root="2.16.840.1.113883.1.6"/>
         <processingCode code="P"/>
         <processingModeCode code="T"/>
         <acceptAckCode code="NE"/>
         <receiver typeCode="RCV">
            <device determinerCode="INSTANCE" classCode="DEV">
               <id root="1.2.345.678.999"/>
               <asAgent classCode="AGNT">
                  <representedOrganization determinerCode="INSTANCE" classCode="ORG">
                     <id root="2.2"/>
                  </representedOrganization>
               </asAgent>
            </device>
         </receiver>
         <sender typeCode="SND">
            <device determinerCode="INSTANCE" classCode="DEV">
               <id root="1.2.345.678.999"/>
               <asAgent classCode="AGNT">
                  <representedOrganization determinerCode="INSTANCE" classCode="ORG">
                     <id root="1.1"/>
                  </representedOrganization>
               </asAgent>
            </device>
         </sender>
         <acknowledgement>
            <typeId extension="PRPA_IN201305UV02" root="2.16.840.1.113883.1.6"/>
            <typeCode code="AA"/>
            <targetMessage xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
         </acknowledgement>
         <controlActProcess moodCode="EVN" classCode="CACT">
            <code codeSystem="2.16.840.1.113883.1.6" code="PRPA_TE201306UV"/>
            <subject typeCode="SUBJ">
               <registrationEvent moodCode="EVN" classCode="REG">
                  <id nullFlavor="NA"/>
                  <statusCode code="active"/>
                  <subject1 typeCode="SBJ">
                     <patient classCode="PAT">
                        <id extension="${patientid}" root="${root}"/>
                        <statusCode code="SD"/>
                        <patientPerson determinerCode="INSTANCE" classCode="PSN">
                           <name>
                              <family partType="FAM">Younger</family>
                              <given partType="GIV">Gallow</given>
                           </name>
                           <telecom value="tel:+1-888-555-1234"/>
                           <administrativeGenderCode code="M"/>
                           <birthTime value="19630804"/>
                           <addr>
                              <city>LEESBURG</city>
                              <state>VA</state>
                              <postalCode>20176</postalCode>
                           </addr>
                           <asOtherIDs classCode="SD">
                              <id extension="999123401" root="2.16.840.1.113883.4.1"/>
                              <scopingOrganization determinerCode="INSTANCE" classCode="ORG">
                                 <id root="2.16.840.1.113883.4.1"/>
                              </scopingOrganization>
                           </asOtherIDs>
                        </patientPerson>
                        <providerOrganization determinerCode="INSTANCE" classCode="ORG">
                           <id root="1.1"/>
                           <contactParty xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
                        </providerOrganization>
                        <subjectOf1>
                           <queryMatchObservation moodCode="EVN" classCode="CASE">
                              <code code="IHE_PDQ"/>
                              <value xsi:type="INT" value="100" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
                           </queryMatchObservation>
                        </subjectOf1>
                     </patient>
                  </subject1>
                  <custodian typeCode="CST">
                     <assignedEntity classCode="ASSIGNED">
                        <id root="1.1"/>
                        <code codeSystem="1.3.6.1.4.1.19376.1.2.27.2" code="NotHealthDataLocator"/>
                     </assignedEntity>
                  </custodian>
               </registrationEvent>
            </subject>
            <queryAck>
               <queryId extension="-abd3453dcd24wkkks545" root="2.2"/>
               <queryResponseCode code="OK"/>
            </queryAck>
            <queryByParameter>
               <queryId extension="-abd3453dcd24wkkks545" root="2.2"/>
               <statusCode code="new"/>
               <responseModalityCode code="R"/>
               <responsePriorityCode code="I"/>
               <parameterList>
                  <livingSubjectAdministrativeGender>
                     <value code="M"/>
                     <semanticsText representation="TXT"/>
                  </livingSubjectAdministrativeGender>
                  <livingSubjectBirthTime>
                     <value value="19630804"/>
                     <semanticsText representation="TXT"/>
                  </livingSubjectBirthTime>
                  <livingSubjectId>
                     <value extension="1111" root="2.2"/>
                     <semanticsText representation="TXT"/>
                  </livingSubjectId>
                  <livingSubjectName>
                     <value>
                        <family partType="FAM">Younger</family>
                        <given partType="GIV">Gallow</given>
                     </value>
                     <semanticsText representation="TXT"/>
                  </livingSubjectName>
               </parameterList>
            </queryByParameter>
         </controlActProcess>
      </PRPA_IN201306UV02>
   </S:Body>
</S:Envelope>]]></con:responseContent><con:wsaConfig action="urn:gov:hhs:fha:nhinc:adaptercomponentmpi/AdapterComponentMpiPortType/FindCandidatesResponse" mustUnderstand="NONE" version="200508"/></con:response><con:response encoding="UTF-8" name="MAA"><con:settings/><con:script>dl= Ma</con:script><con:responseContent><![CDATA[<S:Envelope xmlns:S="http://www.w3.org/2003/05/soap-envelope">
   <S:Body>
      <ns3:PRPA_IN201306UV02 ITSVersion="XML_1.0" xmlns="http://schemas.xmlsoap.org/ws/2004/08/addressing" xmlns:ns2="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:ns3="urn:hl7-org:v3" xmlns:ns4="urn:gov:hhs:fha:nhinc:common:patientcorrelationfacade">
         <ns3:id extension="2dec1e:133c34b2251:-7d95" root="1.1"/>
         <ns3:creationTime value="2011112121319"/>
         <ns3:interactionId extension="PRPA_IN201306UV02" root="2.16.840.1.113883.1.6"/>
         <ns3:processingCode code="P"/>
         <ns3:processingModeCode code="T"/>
         <ns3:acceptAckCode code="NE"/>
         <ns3:receiver typeCode="RCV">
            <ns3:device determinerCode="INSTANCE" classCode="DEV">
               <ns3:id root="1.2.345.678.999"/>
               <ns3:asAgent classCode="AGNT">
                  <ns3:representedOrganization determinerCode="INSTANCE" classCode="ORG">
                     <ns3:id root="2.2"/>
                  </ns3:representedOrganization>
               </ns3:asAgent>
            </ns3:device>
         </ns3:receiver>
         <ns3:sender typeCode="SND">
            <ns3:device determinerCode="INSTANCE" classCode="DEV">
               <ns3:id root="1.2.345.678.999"/>
               <ns3:asAgent classCode="AGNT">
                  <ns3:representedOrganization determinerCode="INSTANCE" classCode="ORG">
                     <ns3:id root="1.1"/>
                  </ns3:representedOrganization>
               </ns3:asAgent>
            </ns3:device>
         </ns3:sender>
         <ns3:acknowledgement>
            <ns3:typeId extension="PRPA_IN201305UV02" root="2.16.840.1.113883.1.6"/>
            <ns3:typeCode code="AA"/>
            <ns3:targetMessage xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
         </ns3:acknowledgement>
         <ns3:controlActProcess moodCode="EVN" classCode="CACT">
            <ns3:code codeSystem="2.16.840.1.113883.1.6" code="PRPA_TE201306UV"/>
            <ns3:subject typeCode="SUBJ">
               <ns3:registrationEvent moodCode="EVN" classCode="REG">
                  <ns3:id nullFlavor="NA"/>
                  <ns3:statusCode code="active"/>
                  <ns3:subject1 typeCode="SBJ">
                     <ns3:patient classCode="PAT">
                        <ns3:id extension="3456.1" root="1.1.1"/>
                        <ns3:statusCode code="SD"/>
                        <ns3:patientPerson determinerCode="INSTANCE" classCode="PSN">
                           <ns3:name>
                              <ns3:family partType="FAM">Evans</ns3:family>
                              <ns3:given partType="GIV">Daniel</ns3:given>
                              <ns3:given partType="GIV">Peter</ns3:given>
                           </ns3:name>
                           <ns3:telecom value="tel:+1-987-555-9876"/>
                           <ns3:administrativeGenderCode code="M"/>
                           <ns3:birthTime value="20040315"/>
                           <ns3:addr>
                              <ns3:streetAddressLine>4000 Minor St</ns3:streetAddressLine>
                              <ns3:city>Springfield</ns3:city>
                              <ns3:state>MO</ns3:state>
                              <ns3:postalCode>65801</ns3:postalCode>
                           </ns3:addr>
                           <ns3:asOtherIDs classCode="SD">
                              <ns3:id extension="999123404" root="2.16.840.1.113883.4.1"/>
                              <ns3:scopingOrganization determinerCode="INSTANCE" classCode="ORG">
                                 <ns3:id root="2.16.840.1.113883.4.1"/>
                              </ns3:scopingOrganization>
                           </ns3:asOtherIDs>
                        </ns3:patientPerson>
                        <ns3:providerOrganization determinerCode="INSTANCE" classCode="ORG">
                           <ns3:id root="1.1.1"/>
                           <ns3:contactParty xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
                        </ns3:providerOrganization>
                        <ns3:subjectOf1>
                           <ns3:queryMatchObservation moodCode="EVN" classCode="CASE">
                              <ns3:code code="IHE_PDQ"/>
                              <ns3:value xsi:type="ns3:INT" value="100" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
                           </ns3:queryMatchObservation>
                        </ns3:subjectOf1>
                     </ns3:patient>
                  </ns3:subject1>
                  <ns3:custodian typeCode="CST">
                     <ns3:assignedEntity classCode="ASSIGNED">
                        <ns3:id root="1.1.1"/>
                        <ns3:code codeSystem="1.3.6.1.4.1.19376.1.2.27.2" code="NotHealthDataLocator"/>
                     </ns3:assignedEntity>
                  </ns3:custodian>
               </ns3:registrationEvent>
            </ns3:subject>
            <ns3:subject typeCode="SUBJ">
               <ns3:registrationEvent moodCode="EVN" classCode="REG">
                  <ns3:id nullFlavor="NA"/>
                  <ns3:statusCode code="active"/>
                  <ns3:subject1 typeCode="SBJ">
                     <ns3:patient classCode="PAT">
                        <ns3:id extension="3456.2" root="1.1.2"/>
                        <ns3:statusCode code="SD"/>
                        <ns3:patientPerson determinerCode="INSTANCE" classCode="PSN">
                           <ns3:name>
                              <ns3:family partType="FAM">Evans</ns3:family>
                              <ns3:given partType="GIV">Daniel</ns3:given>
                              <ns3:given partType="GIV">Peter</ns3:given>
                           </ns3:name>
                           <ns3:telecom value="tel:+1-987-555-9876"/>
                           <ns3:administrativeGenderCode code="M"/>
                           <ns3:birthTime value="20040315"/>
                           <ns3:addr>
                              <ns3:streetAddressLine>4000 Minor St</ns3:streetAddressLine>
                              <ns3:city>Springfield</ns3:city>
                              <ns3:state>MO</ns3:state>
                              <ns3:postalCode>65801</ns3:postalCode>
                           </ns3:addr>
                           <ns3:asOtherIDs classCode="SD">
                              <ns3:id extension="999123404" root="2.16.840.1.113883.4.1"/>
                              <ns3:scopingOrganization determinerCode="INSTANCE" classCode="ORG">
                                 <ns3:id root="2.16.840.1.113883.4.1"/>
                              </ns3:scopingOrganization>
                           </ns3:asOtherIDs>
                        </ns3:patientPerson>
                        <ns3:providerOrganization determinerCode="INSTANCE" classCode="ORG">
                           <ns3:id root="1.1.2"/>
                           <ns3:contactParty xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
                        </ns3:providerOrganization>
                        <ns3:subjectOf1>
                           <ns3:queryMatchObservation moodCode="EVN" classCode="CASE">
                              <ns3:code code="IHE_PDQ"/>
                              <ns3:value xsi:type="ns3:INT" value="100" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
                           </ns3:queryMatchObservation>
                        </ns3:subjectOf1>
                     </ns3:patient>
                  </ns3:subject1>
                  <ns3:custodian typeCode="CST">
                     <ns3:assignedEntity classCode="ASSIGNED">
                        <ns3:id root="1.1.2"/>
                        <ns3:code codeSystem="1.3.6.1.4.1.19376.1.2.27.2" code="NotHealthDataLocator"/>
                     </ns3:assignedEntity>
                  </ns3:custodian>
               </ns3:registrationEvent>
            </ns3:subject>
            <ns3:queryAck>
               <ns3:queryId extension="-abd3453dcd24wkkks545" root="2.2"/>
               <ns3:queryResponseCode code="OK"/>
            </ns3:queryAck>
            <ns3:queryByParameter>
               <ns3:queryId extension="-abd3453dcd24wkkks545" root="2.2"/>
               <ns3:statusCode code="new"/>
               <ns3:responseModalityCode code="R"/>
               <ns3:responsePriorityCode code="I"/>
               <ns3:parameterList>
                  <ns3:livingSubjectAdministrativeGender>
                     <ns3:value code="M"/>
                     <ns3:semanticsText representation="TXT"/>
                  </ns3:livingSubjectAdministrativeGender>
                  <ns3:livingSubjectBirthTime>
                     <ns3:value value="20040315"/>
                     <ns3:semanticsText representation="TXT"/>
                  </ns3:livingSubjectBirthTime>
                  <ns3:livingSubjectId>
                     <ns3:value extension="1111" root="2.2"/>
                     <ns3:semanticsText representation="TXT"/>
                  </ns3:livingSubjectId>
                  <ns3:livingSubjectName>
                     <ns3:value>
                        <ns3:family partType="FAM">Evans</ns3:family>
                        <ns3:given partType="GIV">Daniel</ns3:given>
                     </ns3:value>
                     <ns3:semanticsText representation="TXT"/>
                  </ns3:livingSubjectName>
               </ns3:parameterList>
            </ns3:queryByParameter>
         </ns3:controlActProcess>
      </ns3:PRPA_IN201306UV02>
   </S:Body>
</S:Envelope>]]></con:responseContent><con:wsaConfig action="urn:gov:hhs:fha:nhinc:adaptercomponentmpi/AdapterComponentMpiPortType/FindCandidatesResponse" mustUnderstand="NONE" version="200508"/></con:response><con:response encoding="UTF-8" name="Bad Response"><con:settings/><con:responseContent>this is a bad response</con:responseContent><con:wsaConfig action="urn:gov:hhs:fha:nhinc:adaptercomponentmpi/AdapterComponentMpiPortType/FindCandidatesResponse" mustUnderstand="NONE" version="200508"/></con:response><con:response encoding="UTF-8" name="ResponderBusy"><con:settings/><con:responseContent><![CDATA[<S:Envelope xmlns:S="http://www.w3.org/2003/05/soap-envelope" xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:wsse11="http://docs.oasis-open.org/wss/oasis-wss-wssecurity-secext-1.1.xsd">
   <S:Body>
      <PRPA_IN201306UV02 ITSVersion="XML_1.0" xmlns="urn:hl7-org:v3" xmlns:ns2="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:ns3="http://schemas.xmlsoap.org/ws/2004/08/addressing" xmlns:ns4="urn:gov:hhs:fha:nhinc:common:patientcorrelationfacade">
         <id extension="3b839b4e:133af7051a3:-7fbd" root="1.1"/>
         <creationTime value="2011111725448"/>
         <interactionId extension="PRPA_IN201306UV02" root="2.16.840.1.113883.1.6"/>
         <processingCode code="P"/>
         <processingModeCode code="T"/>
         <acceptAckCode code="NE"/>
         <receiver typeCode="RCV">
            <device determinerCode="INSTANCE" classCode="DEV">
               <id root="1.2.345.678.999"/>
               <asAgent classCode="AGNT">
                  <representedOrganization determinerCode="INSTANCE" classCode="ORG">
                     <id root="2.2"/>
                  </representedOrganization>
               </asAgent>
            </device>
         </receiver>
         <sender typeCode="SND">
            <device determinerCode="INSTANCE" classCode="DEV">
               <id root="1.2.345.678.999"/>
               <asAgent classCode="AGNT">
                  <representedOrganization determinerCode="INSTANCE" classCode="ORG">
                     <id root="1.1"/>
                  </representedOrganization>
               </asAgent>
            </device>
         </sender>
         <acknowledgement>
            <typeId extension="PRPA_IN201305UV02" root="2.16.840.1.113883.1.6"/>
            <typeCode code="AA"/>
            <targetMessage xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
         </acknowledgement>
         <controlActProcess moodCode="EVN" classCode="CACT">
            <code codeSystem="2.16.840.1.113883.1.6" code="PRPA_TE201306UV"/>
            <subject typeCode="SUBJ">
               
            </subject>
	<detectedIssueEvent classCode="ALRT" moodCode="EVN">
		<code code="ActAdministrativeDetectedIssueCode" codeSystem="2.16.840.1.113883.5.4"/>
		<mitigatedBy typeCode="MITGT">
          		<detectedIssueManagement classCode="ACT" moodCode="EVN">
				<code code="ResponderBusy" codeSystem="1.3.6.1.4.1.19376.1.2.27.3"/>
			</detectedIssueManagement>
		</mitigatedBy>
	</detectedIssueEvent>
            <queryAck>
               <queryId extension="-abd3453dcd24wkkks545" root="2.2"/>
               <queryResponseCode code="QE"/>
            </queryAck>
            <queryByParameter>
               <queryId extension="-abd3453dcd24wkkks545" root="2.2"/>
               <statusCode code="new"/>
               <responseModalityCode code="R"/>
               <responsePriorityCode code="I"/>
               <parameterList>
                  <livingSubjectAdministrativeGender>
                     <value code="M"/>
                     <semanticsText representation="TXT"/>
                  </livingSubjectAdministrativeGender>
                  <livingSubjectBirthTime>
                     <value value="19630804"/>
                     <semanticsText representation="TXT"/>
                  </livingSubjectBirthTime>
                  <livingSubjectId>
                     <value extension="1111" root="2.2"/>
                     <semanticsText representation="TXT"/>
                  </livingSubjectId>
                  <livingSubjectName>
                     <value>
                        <family partType="FAM">Younger</family>
                        <given partType="GIV">Gallow</given>
                     </value>
                     <semanticsText representation="TXT"/>
                  </livingSubjectName>
               </parameterList>
            </queryByParameter>
         </controlActProcess>
      </PRPA_IN201306UV02>
   </S:Body>
</S:Envelope>]]></con:responseContent><con:wsaConfig action="urn:gov:hhs:fha:nhinc:adaptercomponentmpi/AdapterComponentMpiPortType/FindCandidatesResponse" mustUnderstand="NONE" version="200508"/></con:response><con:response encoding="UTF-8" name="AnswerNotAvailable"><con:settings/><con:responseContent><![CDATA[<S:Envelope xmlns:S="http://www.w3.org/2003/05/soap-envelope" xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:wsse11="http://docs.oasis-open.org/wss/oasis-wss-wssecurity-secext-1.1.xsd">
   <S:Body>
      <PRPA_IN201306UV02 ITSVersion="XML_1.0" xmlns="urn:hl7-org:v3" xmlns:ns2="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:ns3="http://schemas.xmlsoap.org/ws/2004/08/addressing" xmlns:ns4="urn:gov:hhs:fha:nhinc:common:patientcorrelationfacade">
         <id extension="3b839b4e:133af7051a3:-7fbd" root="1.1"/>
         <creationTime value="2011111725448"/>
         <interactionId extension="PRPA_IN201306UV02" root="2.16.840.1.113883.1.6"/>
         <processingCode code="P"/>
         <processingModeCode code="T"/>
         <acceptAckCode code="NE"/>
         <receiver typeCode="RCV">
            <device determinerCode="INSTANCE" classCode="DEV">
               <id root="1.2.345.678.999"/>
               <asAgent classCode="AGNT">
                  <representedOrganization determinerCode="INSTANCE" classCode="ORG">
                     <id root="2.2"/>
                  </representedOrganization>
               </asAgent>
            </device>
         </receiver>
         <sender typeCode="SND">
            <device determinerCode="INSTANCE" classCode="DEV">
               <id root="1.2.345.678.999"/>
               <asAgent classCode="AGNT">
                  <representedOrganization determinerCode="INSTANCE" classCode="ORG">
                     <id root="1.1"/>
                  </representedOrganization>
               </asAgent>
            </device>
         </sender>
         <acknowledgement>
            <typeId extension="PRPA_IN201305UV02" root="2.16.840.1.113883.1.6"/>
            <typeCode code="AA"/>
            <targetMessage xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
         </acknowledgement>
         <controlActProcess moodCode="EVN" classCode="CACT">
            <code codeSystem="2.16.840.1.113883.1.6" code="PRPA_TE201306UV"/>
            <subject typeCode="SUBJ">
               
            </subject>
	<detectedIssueEvent classCode="ALRT" moodCode="EVN">
		<code code="ActAdministrativeDetectedIssueCode" codeSystem="2.16.840.1.113883.5.4"/>
		<mitigatedBy typeCode="MITGT">
          		<detectedIssueManagement classCode="ACT" moodCode="EVN">
				<code code="AnswerNotAvailable" codeSystem="1.3.6.1.4.1.19376.1.2.27.3"/>
			</detectedIssueManagement>
		</mitigatedBy>
	</detectedIssueEvent>
            <queryAck>
               <queryId extension="-abd3453dcd24wkkks545" root="2.2"/>
               <queryResponseCode code="QE"/>
            </queryAck>
            <queryByParameter>
               <queryId extension="-abd3453dcd24wkkks545" root="2.2"/>
               <statusCode code="new"/>
               <responseModalityCode code="R"/>
               <responsePriorityCode code="I"/>
               <parameterList>
                  <livingSubjectAdministrativeGender>
                     <value code="M"/>
                     <semanticsText representation="TXT"/>
                  </livingSubjectAdministrativeGender>
                  <livingSubjectBirthTime>
                     <value value="19630804"/>
                     <semanticsText representation="TXT"/>
                  </livingSubjectBirthTime>
                  <livingSubjectId>
                     <value extension="1111" root="2.2"/>
                     <semanticsText representation="TXT"/>
                  </livingSubjectId>
                  <livingSubjectName>
                     <value>
                        <family partType="FAM">Younger</family>
                        <given partType="GIV">Gallow</given>
                     </value>
                     <semanticsText representation="TXT"/>
                  </livingSubjectName>
               </parameterList>
            </queryByParameter>
         </controlActProcess>
      </PRPA_IN201306UV02>
   </S:Body>
</S:Envelope>]]></con:responseContent><con:wsaConfig action="urn:gov:hhs:fha:nhinc:adaptercomponentmpi/AdapterComponentMpiPortType/FindCandidatesResponse" mustUnderstand="NONE" version="200508"/></con:response><con:response encoding="UTF-8" name="Soap Fault"><con:settings/><con:responseContent><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:wsa="http://schemas.xmlsoap.org/ws/2004/08/addressing" xmlns:dsc="http://schemas.microsoft.com/windows/2008/12/wdp/distributedscan/configuration">
   <soap:Header>
      <wsa:Action>http://schemas.xmlsoap.org/ws/2004/08/addressing/fault</wsa:Action>
      <!--Headers excluded for brevity-->
   </soap:Header>
   <soap:Body>
      <soap:Fault>
         <soap:Code>
            <soap:Value>soap:Receiver</soap:Value>
            <soap:Subcode>
               <soap:Value>dsc:ClientErrorJobTokenNotFound</soap:Value>
            </soap:Subcode>
         </soap:Code>
         <soap:Reason>
            <soap:Text xml:lang="en">A PostScan job identified by the 
            specified dsc:JobToken argument could not be found.</soap:Text>
         </soap:Reason>
      </soap:Fault>
   </soap:Body>
</soap:Envelope>]]></con:responseContent><con:wsaConfig action="urn:gov:hhs:fha:nhinc:adaptercomponentmpi/AdapterComponentMpiPortType/FindCandidatesResponse" mustUnderstand="NONE" version="200508"/></con:response><con:response encoding="UTF-8" name="Soap Fault 2"><con:settings/><con:responseContent><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  <soap:Body>
    <soap:Fault>
      <soap:Code>
        <soap:Value>Server</soap:Value>
      </soap:Code>
      <soap:Reason>
        <!--1 or more repetitions:-->
        <soap:Text xml:lang="en">Missing operation for soapAction [null] and body element [{urn:hl7-org:v3}PRPA_IN201305UV02] with SOAP Version [SOAP 1.2]</soap:Text>
      </soap:Reason>
    </soap:Fault>
  </soap:Body>
</soap:Envelope>]]></con:responseContent><con:wsaConfig action="urn:gov:hhs:fha:nhinc:adaptercomponentmpi/AdapterComponentMpiPortType/FindCandidatesResponse" mustUnderstand="NONE" version="200508"/></con:response><con:dispatchConfig xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:MockOperationQueryMatchDispatch"><con:query><con:name>MAA</con:name><con:query>declare namespace ns3='urn:hl7-org:v3';
declare namespace S='http://www.w3.org/2003/05/soap-envelope'

//S:Envelope[1]/S:Body[1]/ns3:PRPA_IN201305UV02[1]/ns3:receiver[1]/ns3:device[1]/ns3:asAgent[1]/ns3:representedOrganization[1]/ns3:id[1]/@root</con:query><con:match>2.2</con:match><con:response>MAA</con:response></con:query><con:query><con:name>Bad Response</con:name><con:query>declare namespace ns3='urn:hl7-org:v3';
declare namespace S='http://www.w3.org/2003/05/soap-envelope'

//S:Envelope[1]/S:Body[1]/ns3:PRPA_IN201305UV02[1]/ns3:receiver[1]/ns3:device[1]/ns3:asAgent[1]/ns3:representedOrganization[1]/ns3:id[1]/@root</con:query><con:match>3.3</con:match><con:response>Bad Response</con:response></con:query><con:query><con:name>ResponderBusy</con:name><con:query>declare namespace ns3='urn:hl7-org:v3';
declare namespace S='http://www.w3.org/2003/05/soap-envelope'

//S:Envelope[1]/S:Body[1]/ns3:PRPA_IN201305UV02[1]/ns3:receiver[1]/ns3:device[1]/ns3:asAgent[1]/ns3:representedOrganization[1]/ns3:id[1]/@root</con:query><con:match>4.4</con:match><con:response>ResponderBusy</con:response></con:query><con:query><con:name>AnswerNotAvailable</con:name><con:query>declare namespace ns3='urn:hl7-org:v3';
declare namespace S='http://www.w3.org/2003/05/soap-envelope'

//S:Envelope[1]/S:Body[1]/ns3:PRPA_IN201305UV02[1]/ns3:receiver[1]/ns3:device[1]/ns3:asAgent[1]/ns3:representedOrganization[1]/ns3:id[1]/@root</con:query><con:match>5.5</con:match><con:response>AnswerNotAvailable</con:response></con:query><con:query><con:name>Soap Fault</con:name><con:query>declare namespace ns3='urn:hl7-org:v3';
declare namespace S='http://www.w3.org/2003/05/soap-envelope'

//S:Envelope[1]/S:Body[1]/ns3:PRPA_IN201305UV02[1]/ns3:receiver[1]/ns3:device[1]/ns3:asAgent[1]/ns3:representedOrganization[1]/ns3:id[1]/@root</con:query><con:match>6.6</con:match><con:response>Soap Fault</con:response></con:query><con:query><con:name>Soap Fault 2</con:name><con:query>declare namespace ns3='urn:hl7-org:v3';
declare namespace S='http://www.w3.org/2003/05/soap-envelope'

//S:Envelope[1]/S:Body[1]/ns3:PRPA_IN201305UV02[1]/ns3:receiver[1]/ns3:device[1]/ns3:asAgent[1]/ns3:representedOrganization[1]/ns3:id[1]/@root</con:query><con:match>7.7</con:match><con:response>Soap Fault 2</con:response></con:query></con:dispatchConfig></con:mockOperation><con:properties/></con:mockService><con:mockService bindToHostOnly="false" docroot="" host="localhost" name="mockDQ_all" path="/MockDQResp" port="7784"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.mock.WsdlMockService@require-soap-action">false</con:setting></con:settings><con:mockOperation interface="AdapterDocQueryBindingSoap" name="RespondingGateway_CrossGatewayQuery" operation="RespondingGateway_CrossGatewayQuery"><con:settings/><con:dispatchStyle>QUERY_MATCH</con:dispatchStyle><con:defaultResponse>correct doc</con:defaultResponse><con:response encoding="UTF-8" name="correct doc"><con:settings/><con:responseContent><![CDATA[<S:Envelope xmlns:S="http://www.w3.org/2003/05/soap-envelope">
   <S:Body>
      <ns8:AdhocQueryResponse status="urn:oasis:names:tc:ebxml-regrep:ResponseStatusType:Success" xmlns:ns2="urn:hl7-org:v3" xmlns:ns3="http://schemas.xmlsoap.org/ws/2004/08/addressing" xmlns:ns4="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:ns5="urn:gov:hhs:fha:nhinc:common:patientcorrelationfacade" xmlns:ns6="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0" xmlns:ns7="urn:oasis:names:tc:ebxml-regrep:xsd:rs:3.0" xmlns:ns8="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0" xmlns:ns9="urn:oasis:names:tc:ebxml-regrep:xsd:lcm:3.0">
         <ns6:RegistryObjectList>
            <ns6:ExtrinsicObject isOpaque="false" mimeType="text/xml" status="Active" objectType="urn:uuid:7edca82f-054d-47f2-a032-9b2a5b5186c1" home="urn:oid:1.1" id="urn:uuid:d44e754c-36e2-45c6-aafb-ad788fee5f7d">
               <ns6:Slot name="creationTime">
                  <ns6:ValueList>
                     <ns6:Value>20080617124906</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="hash">
                  <ns6:ValueList>
                     <ns6:Value>be56ce49a2a021c5c88bd4a3eef617ce5b94e002</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="intendedRecipient">
                  <ns6:ValueList>
                     <ns6:Value>Scott Borst</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="languageCode">
                  <ns6:ValueList>
                     <ns6:Value>en-US</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="legalAuthenticator">
                  <ns6:ValueList>
                     <ns6:Value>legal</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="serviceStartTime">
                  <ns6:ValueList>
                     <ns6:Value>19990320050000</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="serviceStopTime">
                  <ns6:ValueList>
                     <ns6:Value>20080101050000</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="size">
                  <ns6:ValueList>
                     <ns6:Value>30845</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="sourcePatientId">
                  <ns6:ValueList>
                     <ns6:Value>D123401^^^&amp;2.2&amp;ISO</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="sourcePatientInfo">
                  <ns6:ValueList>
                     <ns6:Value>PID-3|pid1^^^domain</ns6:Value>
                     <ns6:Value>PID-5|Younger^Gallow^^^</ns6:Value>
                     <ns6:Value>PID-7|19990627</ns6:Value>
                     <ns6:Value>PID-8|M</ns6:Value>
                     <ns6:Value>PID-11|1111 Main Street^^Kingsport^TN^37662^US</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="URI">
                  <ns6:ValueList>
                     <ns6:Value>1.123401.11111</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="repositoryUniqueId">
                  <ns6:ValueList>
                     <ns6:Value>1</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Name>
                  <ns6:LocalizedString value="Younger CONNECT TESTGATEWAY Document 1"/>
               </ns6:Name>
               <ns6:Description>
                  <ns6:LocalizedString value="Document 1 Younder CONNECT TESTGATEWAY comments"/>
               </ns6:Description>
               <ns6:Classification nodeRepresentation="" classifiedObject="urn:uuid:d44e754c-36e2-45c6-aafb-ad788fee5f7d" classificationScheme="urn:uuid:93606bcf-9494-43ec-9b4e-a7748d1a838d" id="">
                  <ns6:Slot name="authorPerson">
                     <ns6:ValueList>
                        <ns6:Value>Dr. Joseph Hoodwink</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Slot name="authorInstitution">
                     <ns6:ValueList>
                        <ns6:Value>Main Children's Hospital</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Slot name="authorRole">
                     <ns6:ValueList>
                        <ns6:Value>Primary Care Provider</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Slot name="authorSpecialty">
                     <ns6:ValueList>
                        <ns6:Value>Pediatrician</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="34133-9" classifiedObject="urn:uuid:d44e754c-36e2-45c6-aafb-ad788fee5f7d" classificationScheme="urn:uuid:41a5887f-8865-4c09-adf7-e362475b143a" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>2.16.840.1.113883.6.1</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="Summarization of Episode Note"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="Confidential" classifiedObject="urn:uuid:d44e754c-36e2-45c6-aafb-ad788fee5f7d" classificationScheme="urn:uuid:f4f85eac-e6cb-4883-b524-f2705394840f" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>Confidential</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="Confidential"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="CDAR2/IHE 1.0" classifiedObject="urn:uuid:d44e754c-36e2-45c6-aafb-ad788fee5f7d" classificationScheme="urn:uuid:a09d5840-386c-46f2-b5ad-9c3699a4309d" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>formatCodeScheme_value</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="formatCodeDisplayName_value"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="UTF-8" classifiedObject="urn:uuid:d44e754c-36e2-45c6-aafb-ad788fee5f7d" classificationScheme="urn:uuid:f33fb8ac-18af-42cc-ae0e-ed0b0bdb91e1" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>UTF-8</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="UTF-8"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="test" classifiedObject="urn:uuid:d44e754c-36e2-45c6-aafb-ad788fee5f7d" classificationScheme="urn:uuid:cccf5598-8b07-4b77-a05e-ae952c785ead" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>test</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="test"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="test" classifiedObject="urn:uuid:d44e754c-36e2-45c6-aafb-ad788fee5f7d" classificationScheme="urn:uuid:f0306f51-975f-434e-a61c-c59651d33983" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>test</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="test"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:ExternalIdentifier value="1.123401.44444" identificationScheme="urn:uuid:2e82c1f6-a085-4c72-9da3-8640a32e42ab" registryObject="urn:uuid:d44e754c-36e2-45c6-aafb-ad788fee5f7d" id="">
                  <ns6:Name>
                     <ns6:LocalizedString value="XDSDocumentEntry.uniqueId"/>
                  </ns6:Name>
               </ns6:ExternalIdentifier>
               <ns6:ExternalIdentifier value="D123401^^^&amp;2.2&amp;ISO" identificationScheme="urn:uuid:58a6f841-87b3-4a3e-92fd-a8ffeff98427" registryObject="urn:uuid:d44e754c-36e2-45c6-aafb-ad788fee5f7d" id="">
                  <ns6:Name>
                     <ns6:LocalizedString value="XDSDocumentEntry.patientId"/>
                  </ns6:Name>
               </ns6:ExternalIdentifier>
            </ns6:ExtrinsicObject>
            <ns6:ExtrinsicObject isOpaque="false" mimeType="text/xml" status="Active" objectType="urn:uuid:7edca82f-054d-47f2-a032-9b2a5b5186c1" home="urn:oid:1.1" id="urn:uuid:6c8b060e-88ad-4c2d-8b95-81451d7a4f1f">
               <ns6:Slot name="creationTime">
                  <ns6:ValueList>
                     <ns6:Value>20080627174924</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="hash">
                  <ns6:ValueList>
                     <ns6:Value>ac0eec55d17eaa9c24054f8a7ecc5d3caa45d9f0</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="intendedRecipient">
                  <ns6:ValueList>
                     <ns6:Value>Scott Borst</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="languageCode">
                  <ns6:ValueList>
                     <ns6:Value>en-US</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="legalAuthenticator">
                  <ns6:ValueList>
                     <ns6:Value>legal</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="serviceStartTime">
                  <ns6:ValueList>
                     <ns6:Value>20070911040000</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="serviceStopTime">
                  <ns6:ValueList>
                     <ns6:Value>20080627040000</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="size">
                  <ns6:ValueList>
                     <ns6:Value>26934</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="sourcePatientId">
                  <ns6:ValueList>
                     <ns6:Value>D123402^^^&amp;1.1&amp;ISO</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="sourcePatientInfo">
                  <ns6:ValueList>
                     <ns6:Value>PID-3|pid1^^^domain</ns6:Value>
                     <ns6:Value>PID-5|Schnur^Anna^^^</ns6:Value>
                     <ns6:Value>PID-7|19560813</ns6:Value>
                     <ns6:Value>PID-8|F</ns6:Value>
                     <ns6:Value>PID-11|312 HILL ROAD^^HILLSBORO^MO^37660^US</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="URI">
                  <ns6:ValueList>
                     <ns6:Value>1.123402.11111</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="repositoryUniqueId">
                  <ns6:ValueList>
                     <ns6:Value>1</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Name>
                  <ns6:LocalizedString value="Schnur CONNECT TESTGATEWAY Document 1"/>
               </ns6:Name>
               <ns6:Description>
                  <ns6:LocalizedString value="Document 1 Schnur CONNECT TESTGATEWAY comments"/>
               </ns6:Description>
               <ns6:Classification nodeRepresentation="" classifiedObject="urn:uuid:6c8b060e-88ad-4c2d-8b95-81451d7a4f1f" classificationScheme="urn:uuid:93606bcf-9494-43ec-9b4e-a7748d1a838d" id="">
                  <ns6:Slot name="authorPerson">
                     <ns6:ValueList>
                        <ns6:Value>Axolotl Elysium</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Slot name="authorInstitution">
                     <ns6:ValueList>
                        <ns6:Value>Test Two Workgroup</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Slot name="authorRole">
                     <ns6:ValueList>
                        <ns6:Value>Primary Care Provider</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Slot name="authorSpecialty">
                     <ns6:ValueList>
                        <ns6:Value>General</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="34133-9" classifiedObject="urn:uuid:6c8b060e-88ad-4c2d-8b95-81451d7a4f1f" classificationScheme="urn:uuid:41a5887f-8865-4c09-adf7-e362475b143a" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>2.16.840.1.113883.6.1</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="Summarization of Episode Note"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="Confidential" classifiedObject="urn:uuid:6c8b060e-88ad-4c2d-8b95-81451d7a4f1f" classificationScheme="urn:uuid:f4f85eac-e6cb-4883-b524-f2705394840f" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>Confidential</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="Confidential"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="CDAR2/IHE 1.0" classifiedObject="urn:uuid:6c8b060e-88ad-4c2d-8b95-81451d7a4f1f" classificationScheme="urn:uuid:a09d5840-386c-46f2-b5ad-9c3699a4309d" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>formatCodeScheme_value</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="formatCodeDisplayName_value"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="UTF-8" classifiedObject="urn:uuid:6c8b060e-88ad-4c2d-8b95-81451d7a4f1f" classificationScheme="urn:uuid:f33fb8ac-18af-42cc-ae0e-ed0b0bdb91e1" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>UTF-8</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="UTF-8"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="test" classifiedObject="urn:uuid:6c8b060e-88ad-4c2d-8b95-81451d7a4f1f" classificationScheme="urn:uuid:cccf5598-8b07-4b77-a05e-ae952c785ead" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>test</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="test"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="test" classifiedObject="urn:uuid:6c8b060e-88ad-4c2d-8b95-81451d7a4f1f" classificationScheme="urn:uuid:f0306f51-975f-434e-a61c-c59651d33983" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>test</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="test"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:ExternalIdentifier value="1.123401.55555" identificationScheme="urn:uuid:2e82c1f6-a085-4c72-9da3-8640a32e42ab" registryObject="urn:uuid:6c8b060e-88ad-4c2d-8b95-81451d7a4f1f" id="">
                  <ns6:Name>
                     <ns6:LocalizedString value="XDSDocumentEntry.uniqueId"/>
                  </ns6:Name>
               </ns6:ExternalIdentifier>
               <ns6:ExternalIdentifier value="D123401^^^&amp;2.2&amp;ISO" identificationScheme="urn:uuid:58a6f841-87b3-4a3e-92fd-a8ffeff98427" registryObject="urn:uuid:6c8b060e-88ad-4c2d-8b95-81451d7a4f1f" id="">
                  <ns6:Name>
                     <ns6:LocalizedString value="XDSDocumentEntry.patientId"/>
                  </ns6:Name>
               </ns6:ExternalIdentifier>
            </ns6:ExtrinsicObject>
            <ns6:ExtrinsicObject isOpaque="false" mimeType="text/xml" status="Active" objectType="urn:uuid:7edca82f-054d-47f2-a032-9b2a5b5186c1" home="urn:oid:1.1" id="urn:uuid:ba11f2e7-065f-4f03-ae34-71e060e58e31">
               <ns6:Slot name="creationTime">
                  <ns6:ValueList>
                     <ns6:Value>20080627174924</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="hash">
                  <ns6:ValueList>
                     <ns6:Value>ac0eec55d17eaa9c24054f8a7ecc5d3caa45d9f0</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="intendedRecipient">
                  <ns6:ValueList>
                     <ns6:Value>Scott Borst</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="languageCode">
                  <ns6:ValueList>
                     <ns6:Value>en-US</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="legalAuthenticator">
                  <ns6:ValueList>
                     <ns6:Value>legal</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="serviceStartTime">
                  <ns6:ValueList>
                     <ns6:Value>20070911040000</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="serviceStopTime">
                  <ns6:ValueList>
                     <ns6:Value>20080627040000</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="size">
                  <ns6:ValueList>
                     <ns6:Value>26934</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="sourcePatientId">
                  <ns6:ValueList>
                     <ns6:Value>D123402^^^&amp;1.1&amp;ISO</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="sourcePatientInfo">
                  <ns6:ValueList>
                     <ns6:Value>PID-3|pid1^^^domain</ns6:Value>
                     <ns6:Value>PID-5|Schnur^Anna^^^</ns6:Value>
                     <ns6:Value>PID-7|19560813</ns6:Value>
                     <ns6:Value>PID-8|F</ns6:Value>
                     <ns6:Value>PID-11|312 HILL ROAD^^HILLSBORO^MO^37660^US</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="URI">
                  <ns6:ValueList>
                     <ns6:Value>1.123402.11111</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="repositoryUniqueId">
                  <ns6:ValueList>
                     <ns6:Value>1</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Name>
                  <ns6:LocalizedString value="Schnur CONNECT TESTGATEWAY Document 1"/>
               </ns6:Name>
               <ns6:Description>
                  <ns6:LocalizedString value="Document 1 Schnur CONNECT TESTGATEWAY comments"/>
               </ns6:Description>
               <ns6:Classification nodeRepresentation="" classifiedObject="urn:uuid:ba11f2e7-065f-4f03-ae34-71e060e58e31" classificationScheme="urn:uuid:93606bcf-9494-43ec-9b4e-a7748d1a838d" id="">
                  <ns6:Slot name="authorPerson">
                     <ns6:ValueList>
                        <ns6:Value>Axolotl Elysium</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Slot name="authorInstitution">
                     <ns6:ValueList>
                        <ns6:Value>Test Two Workgroup</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Slot name="authorRole">
                     <ns6:ValueList>
                        <ns6:Value>Primary Care Provider</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Slot name="authorSpecialty">
                     <ns6:ValueList>
                        <ns6:Value>General</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="34133-9" classifiedObject="urn:uuid:ba11f2e7-065f-4f03-ae34-71e060e58e31" classificationScheme="urn:uuid:41a5887f-8865-4c09-adf7-e362475b143a" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>2.16.840.1.113883.6.1</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="Summarization of Episode Note"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="Confidential" classifiedObject="urn:uuid:ba11f2e7-065f-4f03-ae34-71e060e58e31" classificationScheme="urn:uuid:f4f85eac-e6cb-4883-b524-f2705394840f" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>Confidential</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="Confidential"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="CDAR2/IHE 1.0" classifiedObject="urn:uuid:ba11f2e7-065f-4f03-ae34-71e060e58e31" classificationScheme="urn:uuid:a09d5840-386c-46f2-b5ad-9c3699a4309d" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>formatCodeScheme_value</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="formatCodeDisplayName_value"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="UTF-8" classifiedObject="urn:uuid:ba11f2e7-065f-4f03-ae34-71e060e58e31" classificationScheme="urn:uuid:f33fb8ac-18af-42cc-ae0e-ed0b0bdb91e1" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>UTF-8</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="UTF-8"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="test" classifiedObject="urn:uuid:ba11f2e7-065f-4f03-ae34-71e060e58e31" classificationScheme="urn:uuid:cccf5598-8b07-4b77-a05e-ae952c785ead" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>test</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="test"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="test" classifiedObject="urn:uuid:ba11f2e7-065f-4f03-ae34-71e060e58e31" classificationScheme="urn:uuid:f0306f51-975f-434e-a61c-c59651d33983" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>test</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="test"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:ExternalIdentifier value="1.123401.66666" identificationScheme="urn:uuid:2e82c1f6-a085-4c72-9da3-8640a32e42ab" registryObject="urn:uuid:ba11f2e7-065f-4f03-ae34-71e060e58e31" id="">
                  <ns6:Name>
                     <ns6:LocalizedString value="XDSDocumentEntry.uniqueId"/>
                  </ns6:Name>
               </ns6:ExternalIdentifier>
               <ns6:ExternalIdentifier value="D123401^^^&amp;2.2&amp;ISO" identificationScheme="urn:uuid:58a6f841-87b3-4a3e-92fd-a8ffeff98427" registryObject="urn:uuid:ba11f2e7-065f-4f03-ae34-71e060e58e31" id="">
                  <ns6:Name>
                     <ns6:LocalizedString value="XDSDocumentEntry.patientId"/>
                  </ns6:Name>
               </ns6:ExternalIdentifier>
            </ns6:ExtrinsicObject>
         </ns6:RegistryObjectList>
      </ns8:AdhocQueryResponse>
   </S:Body>
</S:Envelope>]]></con:responseContent><con:wsaConfig action="urn:gov:hhs:fha:nhinc:adapterdocquery/AdapterDocQueryPortType/RespondingGateway_CrossGatewayQueryResponse" mustUnderstand="NONE" version="200508"/></con:response><con:response encoding="UTF-8" name="Soap Fault"><con:settings/><con:responseContent><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope" xmlns:wsa="http://schemas.xmlsoap.org/ws/2004/08/addressing" xmlns:dsc="http://schemas.microsoft.com/windows/2008/12/wdp/distributedscan/configuration">
   <soap:Header>
      <wsa:Action>http://schemas.xmlsoap.org/ws/2004/08/addressing/fault</wsa:Action>
      <!--Headers excluded for brevity-->
   </soap:Header>
   <soap:Body>
      <soap:Fault>
         <soap:Code>
            <soap:Value>soap:Receiver</soap:Value>
            <soap:Subcode>
               <soap:Value>dsc:ClientErrorJobTokenNotFound</soap:Value>
            </soap:Subcode>
         </soap:Code>
         <soap:Reason>
            <soap:Text xml:lang="en">A PostScan job identified by the 
            specified dsc:JobToken argument could not be found.</soap:Text>
         </soap:Reason>
      </soap:Fault>
   </soap:Body>
</soap:Envelope>]]></con:responseContent><con:wsaConfig action="urn:gov:hhs:fha:nhinc:adapterdocquery/AdapterDocQueryPortType/RespondingGateway_CrossGatewayQueryResponse" mustUnderstand="NONE" version="200508"/></con:response><con:response encoding="UTF-8" name="Soap Fault 2"><con:settings/><con:responseContent><![CDATA[<soap:Envelope xmlns:soap="http://www.w3.org/2003/05/soap-envelope">
  <soap:Body>
    <soap:Fault>
      <soap:Code>
        <soap:Value>Server</soap:Value>
      </soap:Code>
      <soap:Reason>
        <!--1 or more repetitions:-->
        <soap:Text xml:lang="en">Missing operation for soapAction [null] and body element [{urn:hl7-org:v3}PRPA_IN201305UV02] with SOAP Version [SOAP 1.2]</soap:Text>
      </soap:Reason>
    </soap:Fault>
  </soap:Body>
</soap:Envelope>]]></con:responseContent><con:wsaConfig action="urn:gov:hhs:fha:nhinc:adapterdocquery/AdapterDocQueryPortType/RespondingGateway_CrossGatewayQueryResponse" mustUnderstand="NONE" version="200508"/></con:response><con:dispatchConfig/></con:mockOperation><con:properties/></con:mockService><con:mockService bindToHostOnly="false" docroot="" host="localhost" name="mockMPI_happy_path" path="/MockMPIResp" port="7783"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.mock.WsdlMockService@require-soap-action">false</con:setting></con:settings><con:mockOperation interface="AdapterComponentMpiPortTypeBinding" name="FindCandidates" operation="FindCandidates"><con:settings/><con:dispatchStyle>QUERY_MATCH</con:dispatchStyle><con:defaultResponse>Gallow</con:defaultResponse><con:response encoding="UTF-8" name="Gallow"><con:settings/><con:script>context.patientid = Math.random()
context.root = Math.random()</con:script><con:responseContent><![CDATA[<S:Envelope xmlns:S="http://www.w3.org/2003/05/soap-envelope" xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:wsse11="http://docs.oasis-open.org/wss/oasis-wss-wssecurity-secext-1.1.xsd">
   <S:Body>
      <PRPA_IN201306UV02 ITSVersion="XML_1.0" xmlns="urn:hl7-org:v3" xmlns:ns2="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:ns3="http://schemas.xmlsoap.org/ws/2004/08/addressing" xmlns:ns4="urn:gov:hhs:fha:nhinc:common:patientcorrelationfacade">
         <id extension="3b839b4e:133af7051a3:-7fbd" root="1.1"/>
         <creationTime value="2011111725448"/>
         <interactionId extension="PRPA_IN201306UV02" root="2.16.840.1.113883.1.6"/>
         <processingCode code="P"/>
         <processingModeCode code="T"/>
         <acceptAckCode code="NE"/>
         <receiver typeCode="RCV">
            <device determinerCode="INSTANCE" classCode="DEV">
               <id root="1.2.345.678.999"/>
               <asAgent classCode="AGNT">
                  <representedOrganization determinerCode="INSTANCE" classCode="ORG">
                     <id root="2.2"/>
                  </representedOrganization>
               </asAgent>
            </device>
         </receiver>
         <sender typeCode="SND">
            <device determinerCode="INSTANCE" classCode="DEV">
               <id root="1.2.345.678.999"/>
               <asAgent classCode="AGNT">
                  <representedOrganization determinerCode="INSTANCE" classCode="ORG">
                     <id root="1.1"/>
                  </representedOrganization>
               </asAgent>
            </device>
         </sender>
         <acknowledgement>
            <typeId extension="PRPA_IN201305UV02" root="2.16.840.1.113883.1.6"/>
            <typeCode code="AA"/>
            <targetMessage xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
         </acknowledgement>
         <controlActProcess moodCode="EVN" classCode="CACT">
            <code codeSystem="2.16.840.1.113883.1.6" code="PRPA_TE201306UV"/>
            <subject typeCode="SUBJ">
               <registrationEvent moodCode="EVN" classCode="REG">
                  <id nullFlavor="NA"/>
                  <statusCode code="active"/>
                  <subject1 typeCode="SBJ">
                     <patient classCode="PAT">
                        <id extension="${patientid}" root="${root}"/>
                        <statusCode code="SD"/>
                        <patientPerson determinerCode="INSTANCE" classCode="PSN">
                           <name>
                              <family partType="FAM">Younger</family>
                              <given partType="GIV">Gallow</given>
                           </name>
                           <telecom value="tel:+1-888-555-1234"/>
                           <administrativeGenderCode code="M"/>
                           <birthTime value="19630804"/>
                           <addr>
                              <city>LEESBURG</city>
                              <state>VA</state>
                              <postalCode>20176</postalCode>
                           </addr>
                           <asOtherIDs classCode="SD">
                              <id extension="999123401" root="2.16.840.1.113883.4.1"/>
                              <scopingOrganization determinerCode="INSTANCE" classCode="ORG">
                                 <id root="2.16.840.1.113883.4.1"/>
                              </scopingOrganization>
                           </asOtherIDs>
                        </patientPerson>
                        <providerOrganization determinerCode="INSTANCE" classCode="ORG">
                           <id root="1.1"/>
                           <contactParty xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
                        </providerOrganization>
                        <subjectOf1>
                           <queryMatchObservation moodCode="EVN" classCode="CASE">
                              <code code="IHE_PDQ"/>
                              <value xsi:type="INT" value="100" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
                           </queryMatchObservation>
                        </subjectOf1>
                     </patient>
                  </subject1>
                  <custodian typeCode="CST">
                     <assignedEntity classCode="ASSIGNED">
                        <id root="1.1"/>
                        <code codeSystem="1.3.6.1.4.1.19376.1.2.27.2" code="NotHealthDataLocator"/>
                     </assignedEntity>
                  </custodian>
               </registrationEvent>
            </subject>
            <queryAck>
               <queryId extension="-abd3453dcd24wkkks545" root="2.2"/>
               <queryResponseCode code="OK"/>
            </queryAck>
            <queryByParameter>
               <queryId extension="-abd3453dcd24wkkks545" root="2.2"/>
               <statusCode code="new"/>
               <responseModalityCode code="R"/>
               <responsePriorityCode code="I"/>
               <parameterList>
                  <livingSubjectAdministrativeGender>
                     <value code="M"/>
                     <semanticsText representation="TXT"/>
                  </livingSubjectAdministrativeGender>
                  <livingSubjectBirthTime>
                     <value value="19630804"/>
                     <semanticsText representation="TXT"/>
                  </livingSubjectBirthTime>
                  <livingSubjectId>
                     <value extension="1111" root="2.2"/>
                     <semanticsText representation="TXT"/>
                  </livingSubjectId>
                  <livingSubjectName>
                     <value>
                        <family partType="FAM">Younger</family>
                        <given partType="GIV">Gallow</given>
                     </value>
                     <semanticsText representation="TXT"/>
                  </livingSubjectName>
               </parameterList>
            </queryByParameter>
         </controlActProcess>
      </PRPA_IN201306UV02>
   </S:Body>
</S:Envelope>]]></con:responseContent><con:wsaConfig action="urn:gov:hhs:fha:nhinc:adaptercomponentmpi/AdapterComponentMpiPortType/FindCandidatesResponse" mustUnderstand="NONE" version="200508"/></con:response><con:response encoding="UTF-8" name="MAA"><con:settings/><con:responseContent><![CDATA[<S:Envelope xmlns:S="http://www.w3.org/2003/05/soap-envelope">
   <S:Body>
      <ns3:PRPA_IN201306UV02 ITSVersion="XML_1.0" xmlns="http://schemas.xmlsoap.org/ws/2004/08/addressing" xmlns:ns2="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:ns3="urn:hl7-org:v3" xmlns:ns4="urn:gov:hhs:fha:nhinc:common:patientcorrelationfacade">
         <ns3:id extension="2dec1e:133c34b2251:-7d95" root="1.1"/>
         <ns3:creationTime value="2011112121319"/>
         <ns3:interactionId extension="PRPA_IN201306UV02" root="2.16.840.1.113883.1.6"/>
         <ns3:processingCode code="P"/>
         <ns3:processingModeCode code="T"/>
         <ns3:acceptAckCode code="NE"/>
         <ns3:receiver typeCode="RCV">
            <ns3:device determinerCode="INSTANCE" classCode="DEV">
               <ns3:id root="1.2.345.678.999"/>
               <ns3:asAgent classCode="AGNT">
                  <ns3:representedOrganization determinerCode="INSTANCE" classCode="ORG">
                     <ns3:id root="2.2"/>
                  </ns3:representedOrganization>
               </ns3:asAgent>
            </ns3:device>
         </ns3:receiver>
         <ns3:sender typeCode="SND">
            <ns3:device determinerCode="INSTANCE" classCode="DEV">
               <ns3:id root="1.2.345.678.999"/>
               <ns3:asAgent classCode="AGNT">
                  <ns3:representedOrganization determinerCode="INSTANCE" classCode="ORG">
                     <ns3:id root="1.1"/>
                  </ns3:representedOrganization>
               </ns3:asAgent>
            </ns3:device>
         </ns3:sender>
         <ns3:acknowledgement>
            <ns3:typeId extension="PRPA_IN201305UV02" root="2.16.840.1.113883.1.6"/>
            <ns3:typeCode code="AA"/>
            <ns3:targetMessage xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
         </ns3:acknowledgement>
         <ns3:controlActProcess moodCode="EVN" classCode="CACT">
            <ns3:code codeSystem="2.16.840.1.113883.1.6" code="PRPA_TE201306UV"/>
            <ns3:subject typeCode="SUBJ">
               <ns3:registrationEvent moodCode="EVN" classCode="REG">
                  <ns3:id nullFlavor="NA"/>
                  <ns3:statusCode code="active"/>
                  <ns3:subject1 typeCode="SBJ">
                     <ns3:patient classCode="PAT">
                        <ns3:id extension="3456.1" root="1.1.1"/>
                        <ns3:statusCode code="SD"/>
                        <ns3:patientPerson determinerCode="INSTANCE" classCode="PSN">
                           <ns3:name>
                              <ns3:family partType="FAM">Evans</ns3:family>
                              <ns3:given partType="GIV">Daniel</ns3:given>
                              <ns3:given partType="GIV">Peter</ns3:given>
                           </ns3:name>
                           <ns3:telecom value="tel:+1-987-555-9876"/>
                           <ns3:administrativeGenderCode code="M"/>
                           <ns3:birthTime value="20040315"/>
                           <ns3:addr>
                              <ns3:streetAddressLine>4000 Minor St</ns3:streetAddressLine>
                              <ns3:city>Springfield</ns3:city>
                              <ns3:state>MO</ns3:state>
                              <ns3:postalCode>65801</ns3:postalCode>
                           </ns3:addr>
                           <ns3:asOtherIDs classCode="SD">
                              <ns3:id extension="999123404" root="2.16.840.1.113883.4.1"/>
                              <ns3:scopingOrganization determinerCode="INSTANCE" classCode="ORG">
                                 <ns3:id root="2.16.840.1.113883.4.1"/>
                              </ns3:scopingOrganization>
                           </ns3:asOtherIDs>
                        </ns3:patientPerson>
                        <ns3:providerOrganization determinerCode="INSTANCE" classCode="ORG">
                           <ns3:id root="1.1.1"/>
                           <ns3:contactParty xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
                        </ns3:providerOrganization>
                        <ns3:subjectOf1>
                           <ns3:queryMatchObservation moodCode="EVN" classCode="CASE">
                              <ns3:code code="IHE_PDQ"/>
                              <ns3:value xsi:type="ns3:INT" value="100" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
                           </ns3:queryMatchObservation>
                        </ns3:subjectOf1>
                     </ns3:patient>
                  </ns3:subject1>
                  <ns3:custodian typeCode="CST">
                     <ns3:assignedEntity classCode="ASSIGNED">
                        <ns3:id root="1.1.1"/>
                        <ns3:code codeSystem="1.3.6.1.4.1.19376.1.2.27.2" code="NotHealthDataLocator"/>
                     </ns3:assignedEntity>
                  </ns3:custodian>
               </ns3:registrationEvent>
            </ns3:subject>
            <ns3:subject typeCode="SUBJ">
               <ns3:registrationEvent moodCode="EVN" classCode="REG">
                  <ns3:id nullFlavor="NA"/>
                  <ns3:statusCode code="active"/>
                  <ns3:subject1 typeCode="SBJ">
                     <ns3:patient classCode="PAT">
                        <ns3:id extension="3456.2" root="1.1.2"/>
                        <ns3:statusCode code="SD"/>
                        <ns3:patientPerson determinerCode="INSTANCE" classCode="PSN">
                           <ns3:name>
                              <ns3:family partType="FAM">Evans</ns3:family>
                              <ns3:given partType="GIV">Daniel</ns3:given>
                              <ns3:given partType="GIV">Peter</ns3:given>
                           </ns3:name>
                           <ns3:telecom value="tel:+1-987-555-9876"/>
                           <ns3:administrativeGenderCode code="M"/>
                           <ns3:birthTime value="20040315"/>
                           <ns3:addr>
                              <ns3:streetAddressLine>4000 Minor St</ns3:streetAddressLine>
                              <ns3:city>Springfield</ns3:city>
                              <ns3:state>MO</ns3:state>
                              <ns3:postalCode>65801</ns3:postalCode>
                           </ns3:addr>
                           <ns3:asOtherIDs classCode="SD">
                              <ns3:id extension="999123404" root="2.16.840.1.113883.4.1"/>
                              <ns3:scopingOrganization determinerCode="INSTANCE" classCode="ORG">
                                 <ns3:id root="2.16.840.1.113883.4.1"/>
                              </ns3:scopingOrganization>
                           </ns3:asOtherIDs>
                        </ns3:patientPerson>
                        <ns3:providerOrganization determinerCode="INSTANCE" classCode="ORG">
                           <ns3:id root="1.1.2"/>
                           <ns3:contactParty xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
                        </ns3:providerOrganization>
                        <ns3:subjectOf1>
                           <ns3:queryMatchObservation moodCode="EVN" classCode="CASE">
                              <ns3:code code="IHE_PDQ"/>
                              <ns3:value xsi:type="ns3:INT" value="100" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
                           </ns3:queryMatchObservation>
                        </ns3:subjectOf1>
                     </ns3:patient>
                  </ns3:subject1>
                  <ns3:custodian typeCode="CST">
                     <ns3:assignedEntity classCode="ASSIGNED">
                        <ns3:id root="1.1.2"/>
                        <ns3:code codeSystem="1.3.6.1.4.1.19376.1.2.27.2" code="NotHealthDataLocator"/>
                     </ns3:assignedEntity>
                  </ns3:custodian>
               </ns3:registrationEvent>
            </ns3:subject>
            <ns3:queryAck>
               <ns3:queryId extension="-abd3453dcd24wkkks545" root="2.2"/>
               <ns3:queryResponseCode code="OK"/>
            </ns3:queryAck>
            <ns3:queryByParameter>
               <ns3:queryId extension="-abd3453dcd24wkkks545" root="2.2"/>
               <ns3:statusCode code="new"/>
               <ns3:responseModalityCode code="R"/>
               <ns3:responsePriorityCode code="I"/>
               <ns3:parameterList>
                  <ns3:livingSubjectAdministrativeGender>
                     <ns3:value code="M"/>
                     <ns3:semanticsText representation="TXT"/>
                  </ns3:livingSubjectAdministrativeGender>
                  <ns3:livingSubjectBirthTime>
                     <ns3:value value="20040315"/>
                     <ns3:semanticsText representation="TXT"/>
                  </ns3:livingSubjectBirthTime>
                  <ns3:livingSubjectId>
                     <ns3:value extension="1111" root="2.2"/>
                     <ns3:semanticsText representation="TXT"/>
                  </ns3:livingSubjectId>
                  <ns3:livingSubjectName>
                     <ns3:value>
                        <ns3:family partType="FAM">Evans</ns3:family>
                        <ns3:given partType="GIV">Daniel</ns3:given>
                     </ns3:value>
                     <ns3:semanticsText representation="TXT"/>
                  </ns3:livingSubjectName>
               </ns3:parameterList>
            </ns3:queryByParameter>
         </ns3:controlActProcess>
      </ns3:PRPA_IN201306UV02>
   </S:Body>
</S:Envelope>]]></con:responseContent><con:wsaConfig action="urn:gov:hhs:fha:nhinc:adaptercomponentmpi/AdapterComponentMpiPortType/FindCandidatesResponse" mustUnderstand="NONE" version="200508"/></con:response><con:dispatchConfig xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:type="con:MockOperationQueryMatchDispatch"><con:query><con:name>MAA</con:name><con:query>declare namespace ns3='urn:hl7-org:v3';
declare namespace S='http://www.w3.org/2003/05/soap-envelope'

//S:Envelope[1]/S:Body[1]/ns3:PRPA_IN201305UV02[1]/ns3:receiver[1]/ns3:device[1]/ns3:asAgent[1]/ns3:representedOrganization[1]/ns3:id[1]/@root</con:query><con:match>3.3</con:match><con:response>MAA</con:response></con:query></con:dispatchConfig></con:mockOperation><con:properties/></con:mockService><con:mockService bindToHostOnly="false" docroot="" host="localhost" name="mockDQ_happy_path" path="/MockDQResp" port="7782"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.mock.WsdlMockService@require-soap-action">false</con:setting></con:settings><con:mockOperation interface="AdapterDocQueryBindingSoap" name="RespondingGateway_CrossGatewayQuery" operation="RespondingGateway_CrossGatewayQuery"><con:settings/><con:dispatchStyle>SEQUENCE</con:dispatchStyle><con:defaultResponse>correct doc</con:defaultResponse><con:response encoding="UTF-8" name="correct doc"><con:settings/><con:responseContent><![CDATA[<S:Envelope xmlns:S="http://www.w3.org/2003/05/soap-envelope">
   <S:Body>
      <ns8:AdhocQueryResponse status="urn:oasis:names:tc:ebxml-regrep:ResponseStatusType:Success" xmlns:ns2="urn:hl7-org:v3" xmlns:ns3="http://schemas.xmlsoap.org/ws/2004/08/addressing" xmlns:ns4="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:ns5="urn:gov:hhs:fha:nhinc:common:patientcorrelationfacade" xmlns:ns6="urn:oasis:names:tc:ebxml-regrep:xsd:rim:3.0" xmlns:ns7="urn:oasis:names:tc:ebxml-regrep:xsd:rs:3.0" xmlns:ns8="urn:oasis:names:tc:ebxml-regrep:xsd:query:3.0" xmlns:ns9="urn:oasis:names:tc:ebxml-regrep:xsd:lcm:3.0">
         <ns6:RegistryObjectList>
            <ns6:ExtrinsicObject isOpaque="false" mimeType="text/xml" status="Active" objectType="urn:uuid:7edca82f-054d-47f2-a032-9b2a5b5186c1" home="urn:oid:1.1" id="urn:uuid:d44e754c-36e2-45c6-aafb-ad788fee5f7d">
               <ns6:Slot name="creationTime">
                  <ns6:ValueList>
                     <ns6:Value>20080617124906</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="hash">
                  <ns6:ValueList>
                     <ns6:Value>be56ce49a2a021c5c88bd4a3eef617ce5b94e002</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="intendedRecipient">
                  <ns6:ValueList>
                     <ns6:Value>Scott Borst</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="languageCode">
                  <ns6:ValueList>
                     <ns6:Value>en-US</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="legalAuthenticator">
                  <ns6:ValueList>
                     <ns6:Value>legal</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="serviceStartTime">
                  <ns6:ValueList>
                     <ns6:Value>19990320050000</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="serviceStopTime">
                  <ns6:ValueList>
                     <ns6:Value>20080101050000</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="size">
                  <ns6:ValueList>
                     <ns6:Value>30845</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="sourcePatientId">
                  <ns6:ValueList>
                     <ns6:Value>D123401^^^&amp;2.2&amp;ISO</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="sourcePatientInfo">
                  <ns6:ValueList>
                     <ns6:Value>PID-3|pid1^^^domain</ns6:Value>
                     <ns6:Value>PID-5|Younger^Gallow^^^</ns6:Value>
                     <ns6:Value>PID-7|19990627</ns6:Value>
                     <ns6:Value>PID-8|M</ns6:Value>
                     <ns6:Value>PID-11|1111 Main Street^^Kingsport^TN^37662^US</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="URI">
                  <ns6:ValueList>
                     <ns6:Value>1.123401.11111</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="repositoryUniqueId">
                  <ns6:ValueList>
                     <ns6:Value>1</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Name>
                  <ns6:LocalizedString value="Younger CONNECT TESTGATEWAY Document 1"/>
               </ns6:Name>
               <ns6:Description>
                  <ns6:LocalizedString value="Document 1 Younder CONNECT TESTGATEWAY comments"/>
               </ns6:Description>
               <ns6:Classification nodeRepresentation="" classifiedObject="urn:uuid:d44e754c-36e2-45c6-aafb-ad788fee5f7d" classificationScheme="urn:uuid:93606bcf-9494-43ec-9b4e-a7748d1a838d" id="">
                  <ns6:Slot name="authorPerson">
                     <ns6:ValueList>
                        <ns6:Value>Dr. Joseph Hoodwink</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Slot name="authorInstitution">
                     <ns6:ValueList>
                        <ns6:Value>Main Children's Hospital</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Slot name="authorRole">
                     <ns6:ValueList>
                        <ns6:Value>Primary Care Provider</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Slot name="authorSpecialty">
                     <ns6:ValueList>
                        <ns6:Value>Pediatrician</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="34133-9" classifiedObject="urn:uuid:d44e754c-36e2-45c6-aafb-ad788fee5f7d" classificationScheme="urn:uuid:41a5887f-8865-4c09-adf7-e362475b143a" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>2.16.840.1.113883.6.1</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="Summarization of Episode Note"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="Confidential" classifiedObject="urn:uuid:d44e754c-36e2-45c6-aafb-ad788fee5f7d" classificationScheme="urn:uuid:f4f85eac-e6cb-4883-b524-f2705394840f" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>Confidential</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="Confidential"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="CDAR2/IHE 1.0" classifiedObject="urn:uuid:d44e754c-36e2-45c6-aafb-ad788fee5f7d" classificationScheme="urn:uuid:a09d5840-386c-46f2-b5ad-9c3699a4309d" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>formatCodeScheme_value</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="formatCodeDisplayName_value"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="UTF-8" classifiedObject="urn:uuid:d44e754c-36e2-45c6-aafb-ad788fee5f7d" classificationScheme="urn:uuid:f33fb8ac-18af-42cc-ae0e-ed0b0bdb91e1" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>UTF-8</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="UTF-8"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="test" classifiedObject="urn:uuid:d44e754c-36e2-45c6-aafb-ad788fee5f7d" classificationScheme="urn:uuid:cccf5598-8b07-4b77-a05e-ae952c785ead" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>test</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="test"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="test" classifiedObject="urn:uuid:d44e754c-36e2-45c6-aafb-ad788fee5f7d" classificationScheme="urn:uuid:f0306f51-975f-434e-a61c-c59651d33983" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>test</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="test"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:ExternalIdentifier value="1.123401.44444" identificationScheme="urn:uuid:2e82c1f6-a085-4c72-9da3-8640a32e42ab" registryObject="urn:uuid:d44e754c-36e2-45c6-aafb-ad788fee5f7d" id="">
                  <ns6:Name>
                     <ns6:LocalizedString value="XDSDocumentEntry.uniqueId"/>
                  </ns6:Name>
               </ns6:ExternalIdentifier>
               <ns6:ExternalIdentifier value="D123401^^^&amp;2.2&amp;ISO" identificationScheme="urn:uuid:58a6f841-87b3-4a3e-92fd-a8ffeff98427" registryObject="urn:uuid:d44e754c-36e2-45c6-aafb-ad788fee5f7d" id="">
                  <ns6:Name>
                     <ns6:LocalizedString value="XDSDocumentEntry.patientId"/>
                  </ns6:Name>
               </ns6:ExternalIdentifier>
            </ns6:ExtrinsicObject>
            <ns6:ExtrinsicObject isOpaque="false" mimeType="text/xml" status="Active" objectType="urn:uuid:7edca82f-054d-47f2-a032-9b2a5b5186c1" home="urn:oid:1.1" id="urn:uuid:6c8b060e-88ad-4c2d-8b95-81451d7a4f1f">
               <ns6:Slot name="creationTime">
                  <ns6:ValueList>
                     <ns6:Value>20080627174924</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="hash">
                  <ns6:ValueList>
                     <ns6:Value>ac0eec55d17eaa9c24054f8a7ecc5d3caa45d9f0</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="intendedRecipient">
                  <ns6:ValueList>
                     <ns6:Value>Scott Borst</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="languageCode">
                  <ns6:ValueList>
                     <ns6:Value>en-US</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="legalAuthenticator">
                  <ns6:ValueList>
                     <ns6:Value>legal</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="serviceStartTime">
                  <ns6:ValueList>
                     <ns6:Value>20070911040000</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="serviceStopTime">
                  <ns6:ValueList>
                     <ns6:Value>20080627040000</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="size">
                  <ns6:ValueList>
                     <ns6:Value>26934</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="sourcePatientId">
                  <ns6:ValueList>
                     <ns6:Value>D123402^^^&amp;1.1&amp;ISO</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="sourcePatientInfo">
                  <ns6:ValueList>
                     <ns6:Value>PID-3|pid1^^^domain</ns6:Value>
                     <ns6:Value>PID-5|Schnur^Anna^^^</ns6:Value>
                     <ns6:Value>PID-7|19560813</ns6:Value>
                     <ns6:Value>PID-8|F</ns6:Value>
                     <ns6:Value>PID-11|312 HILL ROAD^^HILLSBORO^MO^37660^US</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="URI">
                  <ns6:ValueList>
                     <ns6:Value>1.123402.11111</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="repositoryUniqueId">
                  <ns6:ValueList>
                     <ns6:Value>1</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Name>
                  <ns6:LocalizedString value="Schnur CONNECT TESTGATEWAY Document 1"/>
               </ns6:Name>
               <ns6:Description>
                  <ns6:LocalizedString value="Document 1 Schnur CONNECT TESTGATEWAY comments"/>
               </ns6:Description>
               <ns6:Classification nodeRepresentation="" classifiedObject="urn:uuid:6c8b060e-88ad-4c2d-8b95-81451d7a4f1f" classificationScheme="urn:uuid:93606bcf-9494-43ec-9b4e-a7748d1a838d" id="">
                  <ns6:Slot name="authorPerson">
                     <ns6:ValueList>
                        <ns6:Value>Axolotl Elysium</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Slot name="authorInstitution">
                     <ns6:ValueList>
                        <ns6:Value>Test Two Workgroup</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Slot name="authorRole">
                     <ns6:ValueList>
                        <ns6:Value>Primary Care Provider</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Slot name="authorSpecialty">
                     <ns6:ValueList>
                        <ns6:Value>General</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="34133-9" classifiedObject="urn:uuid:6c8b060e-88ad-4c2d-8b95-81451d7a4f1f" classificationScheme="urn:uuid:41a5887f-8865-4c09-adf7-e362475b143a" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>2.16.840.1.113883.6.1</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="Summarization of Episode Note"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="Confidential" classifiedObject="urn:uuid:6c8b060e-88ad-4c2d-8b95-81451d7a4f1f" classificationScheme="urn:uuid:f4f85eac-e6cb-4883-b524-f2705394840f" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>Confidential</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="Confidential"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="CDAR2/IHE 1.0" classifiedObject="urn:uuid:6c8b060e-88ad-4c2d-8b95-81451d7a4f1f" classificationScheme="urn:uuid:a09d5840-386c-46f2-b5ad-9c3699a4309d" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>formatCodeScheme_value</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="formatCodeDisplayName_value"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="UTF-8" classifiedObject="urn:uuid:6c8b060e-88ad-4c2d-8b95-81451d7a4f1f" classificationScheme="urn:uuid:f33fb8ac-18af-42cc-ae0e-ed0b0bdb91e1" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>UTF-8</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="UTF-8"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="test" classifiedObject="urn:uuid:6c8b060e-88ad-4c2d-8b95-81451d7a4f1f" classificationScheme="urn:uuid:cccf5598-8b07-4b77-a05e-ae952c785ead" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>test</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="test"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="test" classifiedObject="urn:uuid:6c8b060e-88ad-4c2d-8b95-81451d7a4f1f" classificationScheme="urn:uuid:f0306f51-975f-434e-a61c-c59651d33983" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>test</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="test"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:ExternalIdentifier value="1.123401.55555" identificationScheme="urn:uuid:2e82c1f6-a085-4c72-9da3-8640a32e42ab" registryObject="urn:uuid:6c8b060e-88ad-4c2d-8b95-81451d7a4f1f" id="">
                  <ns6:Name>
                     <ns6:LocalizedString value="XDSDocumentEntry.uniqueId"/>
                  </ns6:Name>
               </ns6:ExternalIdentifier>
               <ns6:ExternalIdentifier value="D123401^^^&amp;2.2&amp;ISO" identificationScheme="urn:uuid:58a6f841-87b3-4a3e-92fd-a8ffeff98427" registryObject="urn:uuid:6c8b060e-88ad-4c2d-8b95-81451d7a4f1f" id="">
                  <ns6:Name>
                     <ns6:LocalizedString value="XDSDocumentEntry.patientId"/>
                  </ns6:Name>
               </ns6:ExternalIdentifier>
            </ns6:ExtrinsicObject>
            <ns6:ExtrinsicObject isOpaque="false" mimeType="text/xml" status="Active" objectType="urn:uuid:7edca82f-054d-47f2-a032-9b2a5b5186c1" home="urn:oid:1.1" id="urn:uuid:ba11f2e7-065f-4f03-ae34-71e060e58e31">
               <ns6:Slot name="creationTime">
                  <ns6:ValueList>
                     <ns6:Value>20080627174924</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="hash">
                  <ns6:ValueList>
                     <ns6:Value>ac0eec55d17eaa9c24054f8a7ecc5d3caa45d9f0</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="intendedRecipient">
                  <ns6:ValueList>
                     <ns6:Value>Scott Borst</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="languageCode">
                  <ns6:ValueList>
                     <ns6:Value>en-US</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="legalAuthenticator">
                  <ns6:ValueList>
                     <ns6:Value>legal</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="serviceStartTime">
                  <ns6:ValueList>
                     <ns6:Value>20070911040000</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="serviceStopTime">
                  <ns6:ValueList>
                     <ns6:Value>20080627040000</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="size">
                  <ns6:ValueList>
                     <ns6:Value>26934</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="sourcePatientId">
                  <ns6:ValueList>
                     <ns6:Value>D123402^^^&amp;1.1&amp;ISO</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="sourcePatientInfo">
                  <ns6:ValueList>
                     <ns6:Value>PID-3|pid1^^^domain</ns6:Value>
                     <ns6:Value>PID-5|Schnur^Anna^^^</ns6:Value>
                     <ns6:Value>PID-7|19560813</ns6:Value>
                     <ns6:Value>PID-8|F</ns6:Value>
                     <ns6:Value>PID-11|312 HILL ROAD^^HILLSBORO^MO^37660^US</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="URI">
                  <ns6:ValueList>
                     <ns6:Value>1.123402.11111</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Slot name="repositoryUniqueId">
                  <ns6:ValueList>
                     <ns6:Value>1</ns6:Value>
                  </ns6:ValueList>
               </ns6:Slot>
               <ns6:Name>
                  <ns6:LocalizedString value="Schnur CONNECT TESTGATEWAY Document 1"/>
               </ns6:Name>
               <ns6:Description>
                  <ns6:LocalizedString value="Document 1 Schnur CONNECT TESTGATEWAY comments"/>
               </ns6:Description>
               <ns6:Classification nodeRepresentation="" classifiedObject="urn:uuid:ba11f2e7-065f-4f03-ae34-71e060e58e31" classificationScheme="urn:uuid:93606bcf-9494-43ec-9b4e-a7748d1a838d" id="">
                  <ns6:Slot name="authorPerson">
                     <ns6:ValueList>
                        <ns6:Value>Axolotl Elysium</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Slot name="authorInstitution">
                     <ns6:ValueList>
                        <ns6:Value>Test Two Workgroup</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Slot name="authorRole">
                     <ns6:ValueList>
                        <ns6:Value>Primary Care Provider</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Slot name="authorSpecialty">
                     <ns6:ValueList>
                        <ns6:Value>General</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="34133-9" classifiedObject="urn:uuid:ba11f2e7-065f-4f03-ae34-71e060e58e31" classificationScheme="urn:uuid:41a5887f-8865-4c09-adf7-e362475b143a" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>2.16.840.1.113883.6.1</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="Summarization of Episode Note"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="Confidential" classifiedObject="urn:uuid:ba11f2e7-065f-4f03-ae34-71e060e58e31" classificationScheme="urn:uuid:f4f85eac-e6cb-4883-b524-f2705394840f" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>Confidential</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="Confidential"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="CDAR2/IHE 1.0" classifiedObject="urn:uuid:ba11f2e7-065f-4f03-ae34-71e060e58e31" classificationScheme="urn:uuid:a09d5840-386c-46f2-b5ad-9c3699a4309d" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>formatCodeScheme_value</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="formatCodeDisplayName_value"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="UTF-8" classifiedObject="urn:uuid:ba11f2e7-065f-4f03-ae34-71e060e58e31" classificationScheme="urn:uuid:f33fb8ac-18af-42cc-ae0e-ed0b0bdb91e1" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>UTF-8</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="UTF-8"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="test" classifiedObject="urn:uuid:ba11f2e7-065f-4f03-ae34-71e060e58e31" classificationScheme="urn:uuid:cccf5598-8b07-4b77-a05e-ae952c785ead" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>test</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="test"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:Classification nodeRepresentation="test" classifiedObject="urn:uuid:ba11f2e7-065f-4f03-ae34-71e060e58e31" classificationScheme="urn:uuid:f0306f51-975f-434e-a61c-c59651d33983" id="">
                  <ns6:Slot name="codingScheme">
                     <ns6:ValueList>
                        <ns6:Value>test</ns6:Value>
                     </ns6:ValueList>
                  </ns6:Slot>
                  <ns6:Name>
                     <ns6:LocalizedString value="test"/>
                  </ns6:Name>
               </ns6:Classification>
               <ns6:ExternalIdentifier value="1.123401.66666" identificationScheme="urn:uuid:2e82c1f6-a085-4c72-9da3-8640a32e42ab" registryObject="urn:uuid:ba11f2e7-065f-4f03-ae34-71e060e58e31" id="">
                  <ns6:Name>
                     <ns6:LocalizedString value="XDSDocumentEntry.uniqueId"/>
                  </ns6:Name>
               </ns6:ExternalIdentifier>
               <ns6:ExternalIdentifier value="D123401^^^&amp;2.2&amp;ISO" identificationScheme="urn:uuid:58a6f841-87b3-4a3e-92fd-a8ffeff98427" registryObject="urn:uuid:ba11f2e7-065f-4f03-ae34-71e060e58e31" id="">
                  <ns6:Name>
                     <ns6:LocalizedString value="XDSDocumentEntry.patientId"/>
                  </ns6:Name>
               </ns6:ExternalIdentifier>
            </ns6:ExtrinsicObject>
         </ns6:RegistryObjectList>
      </ns8:AdhocQueryResponse>
   </S:Body>
</S:Envelope>]]></con:responseContent><con:wsaConfig action="urn:gov:hhs:fha:nhinc:adapterdocquery/AdapterDocQueryPortType/RespondingGateway_CrossGatewayQueryResponse" mustUnderstand="NONE" version="200508"/></con:response><con:dispatchConfig/></con:mockOperation><con:properties/></con:mockService><con:mockService bindToHostOnly="false" docroot="" host="localhost" name="mockPD_adapter" path="/mockPDAdapter" port="7785"><con:settings><con:setting id="com.eviware.soapui.impl.wsdl.mock.WsdlMockService@require-soap-action">false</con:setting></con:settings><con:mockOperation interface="AdapterPatientDiscoveryBindingSoap" name="RespondingGateway_PRPA_IN201305UV02" operation="RespondingGateway_PRPA_IN201305UV02"><con:settings/><con:dispatchStyle>SEQUENCE</con:dispatchStyle><con:defaultResponse>Gallow</con:defaultResponse><con:response encoding="UTF-8" name="Gallow"><con:settings/><con:script>context.patientid = Math.random()
context.root = Math.random()</con:script><con:responseContent><![CDATA[<S:Envelope xmlns:S="http://www.w3.org/2003/05/soap-envelope" xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" xmlns:xs="http://www.w3.org/2001/XMLSchema" xmlns:wsse11="http://docs.oasis-open.org/wss/oasis-wss-wssecurity-secext-1.1.xsd">
   <S:Body>
      <PRPA_IN201306UV02 ITSVersion="XML_1.0" xmlns="urn:hl7-org:v3" xmlns:ns2="urn:gov:hhs:fha:nhinc:common:nhinccommon" xmlns:ns3="http://schemas.xmlsoap.org/ws/2004/08/addressing" xmlns:ns4="urn:gov:hhs:fha:nhinc:common:patientcorrelationfacade">
         <id extension="3b839b4e:133af7051a3:-7fbd" root="1.1"/>
         <creationTime value="2011111725448"/>
         <interactionId extension="PRPA_IN201306UV02" root="2.16.840.1.113883.1.6"/>
         <processingCode code="P"/>
         <processingModeCode code="T"/>
         <acceptAckCode code="NE"/>
         <receiver typeCode="RCV">
            <device determinerCode="INSTANCE" classCode="DEV">
               <id root="1.2.345.678.999"/>
               <asAgent classCode="AGNT">
                  <representedOrganization determinerCode="INSTANCE" classCode="ORG">
                     <id root="2.2"/>
                  </representedOrganization>
               </asAgent>
            </device>
         </receiver>
         <sender typeCode="SND">
            <device determinerCode="INSTANCE" classCode="DEV">
               <id root="1.2.345.678.999"/>
               <asAgent classCode="AGNT">
                  <representedOrganization determinerCode="INSTANCE" classCode="ORG">
                     <id root="1.1"/>
                  </representedOrganization>
               </asAgent>
            </device>
         </sender>
         <acknowledgement>
            <typeId extension="PRPA_IN201305UV02" root="2.16.840.1.113883.1.6"/>
            <typeCode code="AA"/>
            <targetMessage xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
         </acknowledgement>
         <controlActProcess moodCode="EVN" classCode="CACT">
            <code codeSystem="2.16.840.1.113883.1.6" code="PRPA_TE201306UV"/>
            <subject typeCode="SUBJ">
               <registrationEvent moodCode="EVN" classCode="REG">
                  <id nullFlavor="NA"/>
                  <statusCode code="active"/>
                  <subject1 typeCode="SBJ">
                     <patient classCode="PAT">
                        <id extension="${patientid}" root="${root}"/>
                        <statusCode code="SD"/>
                        <patientPerson determinerCode="INSTANCE" classCode="PSN">
                           <name>
                              <family partType="FAM">Younger</family>
                              <given partType="GIV">Gallow</given>
                           </name>
                           <telecom value="tel:+1-888-555-1234"/>
                           <administrativeGenderCode code="M"/>
                           <birthTime value="19630804"/>
                           <addr>
                              <city>LEESBURG</city>
                              <state>VA</state>
                              <postalCode>20176</postalCode>
                           </addr>
                           <asOtherIDs classCode="SD">
                              <id extension="999123401" root="2.16.840.1.113883.4.1"/>
                              <scopingOrganization determinerCode="INSTANCE" classCode="ORG">
                                 <id root="2.16.840.1.113883.4.1"/>
                              </scopingOrganization>
                           </asOtherIDs>
                        </patientPerson>
                        <providerOrganization determinerCode="INSTANCE" classCode="ORG">
                           <id root="1.1"/>
                           <contactParty xsi:nil="true" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
                        </providerOrganization>
                        <subjectOf1>
                           <queryMatchObservation moodCode="EVN" classCode="CASE">
                              <code code="IHE_PDQ"/>
                              <value xsi:type="INT" value="100" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"/>
                           </queryMatchObservation>
                        </subjectOf1>
                     </patient>
                  </subject1>
                  <custodian typeCode="CST">
                     <assignedEntity classCode="ASSIGNED">
                        <id root="1.1"/>
                        <code codeSystem="1.3.6.1.4.1.19376.1.2.27.2" code="NotHealthDataLocator"/>
                     </assignedEntity>
                  </custodian>
               </registrationEvent>
            </subject>
            <queryAck>
               <queryId extension="-abd3453dcd24wkkks545" root="2.2"/>
               <queryResponseCode code="OK"/>
            </queryAck>
            <queryByParameter>
               <queryId extension="-abd3453dcd24wkkks545" root="2.2"/>
               <statusCode code="new"/>
               <responseModalityCode code="R"/>
               <responsePriorityCode code="I"/>
               <parameterList>
                  <livingSubjectAdministrativeGender>
                     <value code="M"/>
                     <semanticsText representation="TXT"/>
                  </livingSubjectAdministrativeGender>
                  <livingSubjectBirthTime>
                     <value value="19630804"/>
                     <semanticsText representation="TXT"/>
                  </livingSubjectBirthTime>
                  <livingSubjectId>
                     <value extension="1111" root="2.2"/>
                     <semanticsText representation="TXT"/>
                  </livingSubjectId>
                  <livingSubjectName>
                     <value>
                        <family partType="FAM">Younger</family>
                        <given partType="GIV">Gallow</given>
                     </value>
                     <semanticsText representation="TXT"/>
                  </livingSubjectName>
               </parameterList>
            </queryByParameter>
         </controlActProcess>
      </PRPA_IN201306UV02>
   </S:Body>
</S:Envelope>]]></con:responseContent><con:header><con:name>Content-Type</con:name><con:value>application/soap+xml; charset=utf-8</con:value></con:header><con:wsaConfig action="urn:RespondingGateway_PRPA_IN201305UV02" mustUnderstand="NONE" version="200508"/></con:response><con:dispatchConfig/></con:mockOperation><con:properties/></con:mockService><con:properties><con:property><con:name>AAMappingDB</con:name><con:value>assigningauthoritydb</con:value></con:property><con:property><con:name>AAMappingTable</con:name><con:value>aa_to_home_community_mapping</con:value></con:property><con:property><con:name>AQPatientID</con:name><con:value>D123401</con:value></con:property><con:property><con:name>AQUserID</con:name><con:value>kskagerb</con:value></con:property><con:property><con:name>AsyncMsgDB</con:name><con:value>asyncmsgs</con:value></con:property><con:property><con:name>AsyncMsgsDB</con:name><con:value>asyncmsgs</con:value></con:property><con:property><con:name>AsyncMsgTable</con:name><con:value>asyncmsgrepo</con:value></con:property><con:property><con:name>AuditRepoDB</con:name><con:value>auditrepo</con:value></con:property><con:property><con:name>AuditRepoTable</con:name><con:value>auditrepository</con:value></con:property><con:property><con:name>BirthTime</con:name><con:value>19630804</con:value></con:property><con:property><con:name>City</con:name><con:value>Melbourne</con:value></con:property><con:property><con:name>Country</con:name><con:value>US</con:value></con:property><con:property><con:name>DateOfSignature</con:name><con:value>20080520</con:value></con:property><con:property><con:name>DBHost</con:name><con:value>localhost</con:value></con:property><con:property><con:name>DBPass</con:name><con:value>nhincpass</con:value></con:property><con:property><con:name>DBPort</con:name><con:value>3306</con:value></con:property><con:property><con:name>DBUser</con:name><con:value>nhincuser</con:value></con:property><con:property><con:name>DeferredDocRetrieveReqMessageID</con:name><con:value>dcd29642-5bc0-4e6f-84be-de0870b075ec</con:value></con:property><con:property><con:name>DeferredDocRetrieveReqMessageIDLocal</con:name><con:value>b508147b-482f-4bc3-9de0-42ee85f1ccac</con:value></con:property><con:property><con:name>DeferredDocRetrieveReqMessageIDRemote</con:name><con:value>dcd29642-5bc0-4e6f-84be-de0870b075ec</con:value></con:property><con:property><con:name>DeferredPatientDiscoveryReqMessageID</con:name><con:value>uuid:6666666666.66666.666.66</con:value></con:property><con:property><con:name>DeferredQueryReqMessageID</con:name><con:value>091cda8e-95b0-4ac8-a8bb-11224affede4</con:value></con:property><con:property><con:name>DeferredQueryReqMessageIDLocal</con:name><con:value>013c7195-12e1-454b-ac0a-c7705e1f3a14</con:value></con:property><con:property><con:name>DOB</con:name><con:value>19800516</con:value></con:property><con:property><con:name>DQDocID</con:name><con:value>1.123401.55555</con:value></con:property><con:property><con:name>DQPatientID</con:name><con:value>D123401</con:value></con:property><con:property><con:name>DRDocID</con:name><con:value>1.123407.777777</con:value></con:property><con:property><con:name>DRRepoID</con:name><con:value>1</con:value></con:property><con:property><con:name>DynamicDQDocID</con:name><con:value>103.8.9284320.020.3590.75^1266324032288</con:value></con:property><con:property><con:name>DynamicDRDocID</con:name><con:value/></con:property><con:property><con:name>Endpoint-AuditLogQuery</con:name><con:value>http://localhost:8080/CONNECTAdapter/EntityAuditQuery</con:value></con:property><con:property><con:name>Endpoint-DeferredDQRequest</con:name><con:value>http://localhost:8080/CONNECTGateway/EntityService/EntityDocQueryDeferredRequestUnsecured</con:value></con:property><con:property><con:name>Endpoint-DeferredDQResponse</con:name><con:value>http://localhost:8080/CONNECTGateway/EntityService/EntityDocQueryDeferredResponseUnsecured</con:value></con:property><con:property><con:name>Endpoint-DocQuery</con:name><con:value>http://localhost:8080/Gateway/DocumentQuery/2_0/EntityService/EntityDocQueryUnsecured</con:value></con:property><con:property><con:name>Endpoint-DocRetrieve</con:name><con:value>http://localhost:8080/CONNECTGateway/EntityService/EntityDocRetrieve</con:value></con:property><con:property><con:name>Endpoint-DocRetrieveDeferredRequest</con:name><con:value>http://localhost:8080/CONNECTGateway/EntityService/EntityDocRetrieveDeferredRequest</con:value></con:property><con:property><con:name>Endpoint-DocRetrieveDeferredResponse</con:name><con:value>http://localhost:8080/CONNECTGateway/EntityService/EntityDocRetrieveDeferredResponse</con:value></con:property><con:property><con:name>Endpoint-EntityAdminDist</con:name><con:value>http://localhost:8080/CONNECTGateway/AdministrativeDistribution_Service</con:value></con:property><con:property><con:name>Endpoint-EntityXDRRequest</con:name><con:value>http://localhost:8080/CONNECTGateway/EntityService/EntityDocSubmissionDeferredRequestUnsecured</con:value></con:property><con:property><con:name>Endpoint-Notify</con:name><con:value>http://localhost:8080/CONNECTAdapter/EntityNotificationConsumer</con:value></con:property><con:property><con:name>Endpoint-PatientDiscovery</con:name><con:value>http://localhost:8080/Gateway/PatientDiscovery/1_0/EntityPatientDiscovery</con:value></con:property><con:property><con:name>Endpoint-PatientDiscoveryAsyncReq</con:name><con:value>http://localhost:8080/CONNECTGateway/EntityService/EntityPatientDiscoveryDeferredRequestUnsecured</con:value></con:property><con:property><con:name>Endpoint-PatientDiscoveryAsyncResp</con:name><con:value>http://localhost:8080/CONNECTGateway/EntityService/EntityPatientDiscoveryDeferredResponseUnsecured</con:value></con:property><con:property><con:name>Endpoint-Reidentification</con:name><con:value>http://localhost:8080/CONNECTAdapter/EntitySubjectDiscovery</con:value></con:property><con:property><con:name>Endpoint-Subscribe</con:name><con:value>http://localhost:8080/CONNECTAdapter/EntityNotificationProducer</con:value></con:property><con:property><con:name>Endpoint-Unsubscribe</con:name><con:value>http://localhost:8080/CONNECTAdapter/EntitySubscriptionManager</con:value></con:property><con:property><con:name>Endpoint-XDREntity</con:name><con:value>http://localhost:8080/CONNECTGateway/EntityService/EntityDocSubmissionUnsecured</con:value></con:property><con:property><con:name>ExpirationDate</con:name><con:value>20100520</con:value></con:property><con:property><con:name>FamilyName</con:name><con:value>Younger</con:value></con:property><con:property><con:name>Gender</con:name><con:value>M</con:value></con:property><con:property><con:name>GivenName</con:name><con:value>Gallow</con:value></con:property><con:property><con:name>LocalAA</con:name><con:value>1.1</con:value></con:property><con:property><con:name>LocalConfigDir</con:name><con:value>C:/SelfTest/EndToEndSelfTest</con:value></con:property><con:property><con:name>LocalHCDescription</con:name><con:value>InternalTest1</con:value></con:property><con:property><con:name>LocalHCID</con:name><con:value>1.1</con:value></con:property><con:property><con:name>LocalPatientID</con:name><con:value>D123401</con:value></con:property><con:property><con:name>mockHost</con:name><con:value>localhost</con:value></con:property><con:property><con:name>MPIDir</con:name><con:value>C:/glassfish-2.1.1/domains/domain1/config</con:value></con:property><con:property><con:name>NHINGatewayConfigDir</con:name><con:value>C:/glassfish-2.1.1/domains/domain1/config/nhin</con:value></con:property><con:property><con:name>NHINGatewayHost</con:name><con:value>localhost</con:value></con:property><con:property><con:name>NotificationEndpoint</con:name><con:value>https://localhost:8181/CONNECTNhinServicesWeb/NhinService/NotificationConsumerService/HiemNotify</con:value></con:property><con:property><con:name>NotifySubscriptionID</con:name><con:value>-f7c1a5d:1204e50e42e:-79eb</con:value></con:property><con:property><con:name>NotifySubscriptionManagerEndpointAddress</con:name><con:value>https://localhost:8181/CONNECTNhinServicesWeb/NhinService/SubscriptionManagerService/HiemUnsubscribe</con:value></con:property><con:property><con:name>PatientCorrelationDB</con:name><con:value>patientcorrelationdb</con:value></con:property><con:property><con:name>PatientCorrelationTable</con:name><con:value>correlatedidentifiers</con:value></con:property><con:property><con:name>PseudonymAA</con:name><con:value>ABC</con:value></con:property><con:property><con:name>PseudonymPatientID</con:name><con:value>PSEUDO001</con:value></con:property><con:property><con:name>PurposeOfDisclosure</con:name><con:value>Mental</con:value></con:property><con:property><con:name>RealAA</con:name><con:value>1.1.1</con:value></con:property><con:property><con:name>RealPatientID</con:name><con:value>D1234010050</con:value></con:property><con:property><con:name>RemoteAA</con:name><con:value>2.2</con:value></con:property><con:property><con:name>RemoteHCDescription</con:name><con:value>Business Entity</con:value></con:property><con:property><con:name>RemoteHCID</con:name><con:value>2.2</con:value></con:property><con:property><con:name>RemotePatientID</con:name><con:value>D123401</con:value></con:property><con:property><con:name>SSN</con:name><con:value>123456789</con:value></con:property><con:property><con:name>State</con:name><con:value>FL</con:value></con:property><con:property><con:name>StreetAddress</con:name><con:value>123 Johnson Rd</con:value></con:property><con:property><con:name>SubjectID</con:name><con:value>D123401</con:value></con:property><con:property><con:name>SubscribePatientID</con:name><con:value>D123401</con:value></con:property><con:property><con:name>SubscriptionDB</con:name><con:value>subscriptionrepository</con:value></con:property><con:property><con:name>SubscriptionEndpoint</con:name><con:value>https://localhost:8181/CONNECTNhinServicesWeb/NhinService/NotificationProducerService/HiemSubscription</con:value></con:property><con:property><con:name>SubscriptionManagerEndpointAddress</con:name><con:value>https://localhost:8181/CONNECTNhinServicesWeb/NhinService/SubscriptionManagerService/HiemUnsubscribe</con:value></con:property><con:property><con:name>SubscriptionTable</con:name><con:value>subscription</con:value></con:property><con:property><con:name>UniquePatientId</con:name><con:value>1111^^^&amp;amp;1.1&amp;amp;ISO</con:value></con:property><con:property><con:name>UnSubscriptionID</con:name><con:value>3e74139f-5271-4db1-98c0-88748fa3e4e3</con:value></con:property><con:property><con:name>UnsubSubscriptionID</con:name><con:value/></con:property><con:property><con:name>ZipCode</con:name><con:value>12345</con:value></con:property></con:properties><con:afterLoadScript>def propertiesFilename = project.path[0..(project.path.size()-4)] + 'properties'
def propertiesFile = new File(propertiesFilename)
if (propertiesFile.exists()) {
	def props = new Properties()
	props.load(new FileReader(propertiesFile))
	props.each { key, value -&gt;
	    project.setPropertyValue(key, value)
	}
}


TimeZone.setDefault(TimeZone.getTimeZone("UTC"))
def testRunListener = [
  afterRun: { testRunner, runContext -&gt; },
  afterStep: { testRunner, runContext, result -&gt; },
  beforeStep: { testRunner, runContext -&gt; },
  beforeStep: { testRunner, runContext, testStep -&gt; },
  beforeRun: { testRunner, runContext -&gt; 
    use (org.codehaus.groovy.runtime.TimeCategory) {
      def startDate = 5.minutes.ago
      def endDate = 5.minutes.from.now
      def expireDate = 30.days.from.now

      def df = "yyyy-MM-dd'T'HH:mm:ss'Z'"
      def dfSig = "MM/dd/yyyy' 'HH:mm:ss"

      runContext.testCase.setPropertyValue("startDate", startDate.format(df))
      runContext.testCase.setPropertyValue("endDate", endDate.format(df))
      runContext.testCase.setPropertyValue("sigDate", startDate.format(dfSig))
      runContext.testCase.setPropertyValue("expireDate", expireDate.format(df))
    }
  }   
] as com.eviware.soapui.model.testsuite.TestRunListener

project.testSuiteList*.testCaseList.flatten()*.addTestRunListener(testRunListener)



com.eviware.soapui.impl.wsdl.testcase.WsdlTestRunContext.metaClass.findProperty = { propertyName -&gt;
    return delegate.getProperty(propertyName) ?:
                delegate.testCase.getPropertyValue(propertyName) ?:
                delegate.testCase.testSuite.getPropertyValue(propertyName) ?:
                delegate.testCase.testSuite.project.getPropertyValue(propertyName)
}

com.eviware.soapui.impl.wsdl.testcase.WsdlTestRunContext.metaClass.withSql = { dbOrPropertyName, block -&gt;
  def dbName = delegate.findProperty(dbOrPropertyName) ?: dbOrPropertyName
  def host = delegate.findProperty('DBHost')
  def port = delegate.findProperty('DBPort')
  def user = delegate.findProperty('DBUser')
  def pass = delegate.findProperty('DBPass')

  def connectString = "jdbc:mysql://${host}:${port}/${dbName}"
  def sql = groovy.sql.Sql.newInstance(connectString, user, pass, "com.mysql.jdbc.Driver");
  try {
     block(sql)
  } finally {
    sql.close()
  }
}
	</con:afterLoadScript><con:wssContainer><con:crypto><con:source>C:/glassfish-2.1.1/domains/domain1/config/cacerts.jks</con:source><con:password>changeit</con:password></con:crypto><con:crypto><con:source>C:/glassfish-2.1.1/domains/domain1/config/gateway.jks</con:source><con:password>changeit</con:password></con:crypto></con:wssContainer><con:sensitiveInformation/></con:soapui-project>